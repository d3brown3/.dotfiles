1506746977005:mean_wind_speed_mph, precipitation_in, cloud_cover,
1506746977007:num_trips)
1506746977979:weather <- weather %>%
1506746977980:mutate(weekday = as.numeric(weekday))
1506746985630:weather %>% str()
1506746997412:weather <- read_csv("data/201608_weather_data.csv")
1506746998161:# rename
1506746998162:names(weather) <-
1506746998162:names(weather) %>%
1506746998163:gsub(" ", "_", .) %>%
1506746998164:gsub("([a-z])([A-Z])", "\\1\\_\\2", .) %>%
1506746998164:tolower()
1506746998544:weather <- weather %>%
1506746998545:mutate(events = ifelse(is.na(events), "None", events)) %>%
1506746998546:mutate(events = as.factor(events)) %>%
1506746998546:mutate(pdt = mdy(pdt))
1506746998850:weather <- weather %>%
1506746998851:mutate(precipitation_in = as.numeric(precipitation_in)) %>%
1506746998853:mutate(precipitation_in = ifelse(is.na(precipitation_in),
1506746998854:0, precipitation_in))
1506746999480:# only select the weather that for the SF. zip = 94107
1506746999481:weather <- weather %>%
1506746999482:filter(zip == 94107)
1506747004040:weather <- weather %>%
1506747004041:left_join(trip_daily, by = c("pdt" = "start_date"))
1506747004479:weather <- weather %>%
1506747004480:mutate(day_of_week = pdt %>% strftime("%A"),
1506747004482:week_nr = pdt %>% strftime("%W"),
1506747004484:weekday = pdt %>% strftime("%u") %>% as.numeric) %>%
1506747004485:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506747004486:mutate(weekday = as.character(as.numeric(factor(weekday)) - 1)) %>%
1506747004487:mutate(zip = factor(zip))
1506747009256:weather %>% str()
1506747022971:weather <- weather %>%
1506747022975:select(pdt, weekday, mean_temperature_f, mean_dew_point_f, mean_humidity,
1506747022975:mean_sea_level_pressure_in, mean_visibility_miles,
1506747022976:mean_wind_speed_mph, precipitation_in, cloud_cover,
1506747022976:num_trips, events)
1506747025712:weather <- weather %>%
1506747025715:mutate(weekday = as.numeric(weekday))
1506747028982:weather %>% str
1506747044324:# variable selection
1506747044325:l <- regsubsets(data = weather,
1506747044326:num_trips ~
1506747044326:weekday +
1506747044327:mean_temperature_f +
1506747044327:precipitation_in +
1506747044328:mean_visibility_miles +
1506747044329:mean_humidity +
1506747044330:mean_wind_speed_mph +
1506747044331:cloud_cover,
1506747044333:method = "forward", nvmax = 15)
1506747044843:s <- summary(l)
1506747045240:s$outmat
1506747045531:s$cp
1506747055559:# variable selection
1506747055560:l <- regsubsets(data = weather,
1506747055560:num_trips ~
1506747055561:weekday +
1506747055561:mean_temperature_f +
1506747055561:precipitation_in +
1506747055562:mean_visibility_miles +
1506747055563:mean_humidity +
1506747055564:mean_wind_speed_mph +
1506747055565:cloud_cover +
1506747055566:enents,
1506747055567:method = "forward", nvmax = 15)
1506747056123:s <- summary(l)
1506747056388:s$outmat
1506747063565:# variable selection
1506747063568:l <- regsubsets(data = weather,
1506747063569:num_trips ~
1506747063570:weekday +
1506747063570:mean_temperature_f +
1506747063571:precipitation_in +
1506747063571:mean_visibility_miles +
1506747063572:mean_humidity +
1506747063573:mean_wind_speed_mph +
1506747063573:cloud_cover +
1506747063574:evdents,
1506747063575:method = "forward", nvmax = 15)
1506747074026:# variable selection
1506747074027:l <- regsubsets(data = weather,
1506747074028:num_trips ~
1506747074028:weekday +
1506747074029:mean_temperature_f +
1506747074031:precipitation_in +
1506747074032:mean_visibility_miles +
1506747074034:mean_humidity +
1506747074036:mean_wind_speed_mph +
1506747074037:cloud_cover +
1506747074038:events,
1506747074039:method = "forward", nvmax = 15)
1506747074812:s <- summary(l)
1506747075229:s$outmat
1506747085929:s$cp
1506747130142:s$which
1506747135206:s$cp
1506747171760:s$which[which.min(s$cp)]
1506747181599:s$which[which.min(s$cp),]
1506747258273:# fit model
1506747258276:formula <- "(num_trips) ~
1506747258280:weekday +
1506747258280:mean_temperature_f +
1506747258281:mean_visibility_miles +
1506747258282:cloud_cover +
1506747258282:evens"
1506747259736:fit <- lm(data = weather, formula = formula)
1506747260049:summary(fit)
1506747265665:# fit model
1506747265666:formula <- "(num_trips) ~
1506747265667:weekday +
1506747265668:mean_temperature_f +
1506747265668:mean_visibility_miles +
1506747265669:cloud_cover +
1506747265669:events"
1506747266146:fit <- lm(data = weather, formula = formula)
1506747266700:summary(fit)
1506747279162:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506747279554:plot(fit)
1506747314912:holidaydates <- holidays(c(2015, 2016))
1506747315269:weather1 <- weather %>%
1506747315271:mutate(weekday = ifelse(
1506747315272:pdt %in% holidaydates, "1", weekday
1506747315273:))
1506747316267:fit_holiday_adjust <- lm(data = weather1, formula = formula)
1506747316617:summary(fit_holiday_adjust)
1506747317180:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506747317897:plot(fit_holiday_adjust)
1506747328916:influencePlot(fit_holiday_adjust,id.method = "identity", main="Influence Plot",sub="Circle size is proportional to Cook's distance")
1506747354890:gvmodel <- gvlma(fit)
1506747355611:summary(gvmodel)
1506747394688:# fit model
1506747394692:formula <- "sqrt(num_trips) ~
1506747394693:weekday +
1506747394694:mean_temperature_f +
1506747394694:mean_visibility_miles +
1506747394695:cloud_cover +
1506747394696:events"
1506747395239:fit <- lm(data = weather, formula = formula)
1506747395583:summary(fit)
1506747396020:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506747397673:plot(fit)
1506747408733:weather1 <- weather %>%
1506747408735:mutate(weekday = ifelse(
1506747408736:pdt %in% holidaydates, "1", weekday
1506747408737:))
1506747409271:fit_holiday_adjust <- lm(data = weather1, formula = formula)
1506747409566:summary(fit_holiday_adjust)
1506747409897:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506747410426:plot(fit_holiday_adjust)
1506747429695:plot(x=fitted(fit_holiday_adjust), y=rstudent(fit_holiday_adjust))
1506747430171:abline(h=3,col="red",lty=2)
1506747430587:abline(h=-3,col="red",lty=2)
1506747435442:weather1 <- weather1 %>%
1506747435444:slice(-which(abs(rstudent(fit_holiday_adjust)) > 2))
1506747436540:cutoff <- 4/(nrow(weather1)-length(fit_holiday_adjust$coefficients)-2)
1506747436851:#coefficients加上了截距项，因此要多减1
1506747436852:plot(fit_holiday_adjust,which=4,cook.levels = cutoff)
1506747437282:abline(h=cutoff,lty=2,col="red")
1506747439839:influencePlot(fit_holiday_adjust,id.method = "identity", main="Influence Plot",sub="Circle size is proportional to Cook's distance")
1506747464437:fit_holiday_adjust <- lm(data = weather1, formula = formula)
1506747464782:summary(fit_holiday_adjust)
1506747465005:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506747465333:plot(fit_holiday_adjust)
1506747476428:gvmodel <- gvlma(fit)
1506747476766:summary(gvmodel)
1506747558430:# fit model
1506747558435:formula <- "(num_trips) ~
1506747558437:weekday +
1506747558438:mean_temperature_f +
1506747558438:mean_visibility_miles +
1506747558439:cloud_cover +
1506747558439:events"
1506747558943:fit <- lm(data = weather, formula = formula)
1506747563053:summary(fit)
1506747563304:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506747570236:fit_holiday_adjust <- lm(data = weather1, formula = formula)
1506747570794:summary(fit_holiday_adjust)
1506747576073:plot(fit_holiday_adjust)
1506747844229:weather %>% str()
1506747913716:?aes
1506748006601:weather %>%
1506748006603:ggplot(aes(x = pdt, y = num_trips, color = events, shape = weekday)) %>%
1506748006603:geom_point()
1506748030855:weather %>%
1506748030857:ggplot(aes(x = pdt, y = num_trips, color = events)) %>%
1506748030859:geom_point(aes(shape = weekday))
1506748039100:weather %>% str
1506748048566:weather %>%
1506748048568:ggplot(aes(x = pdt, y = num_trips, color = events)) %>%
1506748048569:geom_point(aes(shape = as.factor(weekday)))
1506748064769:weather %>%
1506748064771:ggplot(aes(x = pdt, y = num_trips, color = events)) %>%
1506748064773:geom_point(aes(shape = factor(weekday)))
1506748075721:weather %>%
1506748075722:ggplot(aes(x = pdt, y = num_trips, color = weekday)) %>%
1506748075723:geom_point(aes(shape = factor(weekday)))
1506748081006:weather %>%
1506748081007:ggplot(aes(x = pdt, y = num_trips, color = weekday))
1506748088926:weather %>%
1506748088927:ggplot(aes(x = pdt, y = num_trips, color = weekday)) %>%
1506748088928:geom_point()
1506748101732:weather %>%
1506748101738:ggplot(aes(x = pdt, y = num_trips)) %>%
1506748101740:geom_point()
1506748113296:weather %>%
1506748113298:ggplot(aes(x = pdt, y = num_trips)) %>%
1506748113298:geom_point()
1506748122455:ggplot2::aes()
1506748126773:weather %>%
1506748126774:ggplot(ggplot2::aes(x = pdt, y = num_trips)) %>%
1506748126775:geom_point()
1506748136536:weather %>%
1506748136538:ggplot(mapping = aes(x = pdt, y = num_trips)) %>%
1506748136538:geom_point()
1506748143242:library(ggplot2)
1506748144735:weather %>%
1506748144736:ggplot(mapping = aes(x = pdt, y = num_trips)) %>%
1506748144736:geom_point()
1506748215597:weather %>% str
1506748234374:weather %>%
1506748234375:ggplot(aes(x = pdt, y = num_trips, shape = weekday, color = events)) +
1506748234376:geom_point()
1506748255322:weather %>%
1506748255323:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506748255323:geom_point(aes(shape = factor(weekday)))
1506748281049:weather %>% count(events)
1506748337214:weather %>%
1506748337217:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506748337220:geom_point(aes(shape = factor(weekday))) +
1506748337223:scale_fill_brewer(palette="Set1")
1506748343498:weather %>%
1506748343499:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506748343501:geom_point(aes(shape = factor(weekday))) +
1506748343502:scale_fill_brewer(palette="Set2")
1506748367898:library(RColorBrewer)
1506748405319:weather %>%
1506748405324:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506748405325:geom_point(aes(shape = factor(weekday))) +
1506748405326:scale_color_discrete(palette="Set2")
1506748410382:weather %>%
1506748410383:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506748410384:geom_point(aes(shape = factor(weekday))) +
1506748410384:scale_color_discrete()
1506748419233:weather %>%
1506748419234:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506748419235:geom_point(aes(shape = factor(weekday))) +
1506748419235:scale_color_hue()
1506748442965:weather %>%
1506748442968:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506748442969:geom_point(aes(shape = factor(weekday))) +
1506748442970:scale_color_hue(palette = "Set1")
1506748520610:weather %>%
1506748520611:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506748520612:geom_point(aes(shape = factor(weekday))) +
1506748520613:scale_color_brewer(palette = "Set1")
1506748596900:weather %>% str
1506748605587:weather %>%
1506748605589:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506748605591:geom_point(aes(shape = factor(weekday), size = precipitation_in)) +
1506748605592:scale_color_brewer(palette = "Set1")
1506748808220:fit1$model
1506748822142:fit$call
1506748830049:formula
1506748867840:# variable selection
1506748867841:l <- regsubsets(data = weather,
1506748867843:num_trips ~
1506748867844:weekday +
1506748867846:mean_temperature_f +
1506748867847:precipitation_in +
1506748867848:mean_visibility_miles +
1506748867850:mean_humidity +
1506748867852:mean_wind_speed_mph +
1506748867855:cloud_cover +
1506748867856:events,
1506748867858:method = "forward", nvmax = 15)
1506748868281:s <- summary(l)
1506748868880:s$which
1506748869910:s$cp
1506748881200:s$which[which.min(s$cp),]
1506748891260:# fit model
1506748891261:formula <- "(num_trips) ~
1506748891262:weekday +
1506748891263:mean_temperature_f +
1506748891264:mean_visibility_miles +
1506748891264:cloud_cover +
1506748891265:events"
1506748891504:fit <- lm(data = weather, formula = formula)
1506748891937:summary(fit)
1506748895147:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506748895627:plot(fit)
1506748910508:weather1 %>%
1506748910511:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506748910513:geom_point(aes(shape = factor(weekday), size = precipitation_in)) +
1506748910514:scale_color_brewer(palette = "Set1")
1506749019531:# variable selection
1506749019532:l <- regsubsets(data = weather1,
1506749019534:num_trips ~
1506749019534:weekday +
1506749019535:mean_temperature_f +
1506749019535:precipitation_in +
1506749019536:mean_visibility_miles +
1506749019537:mean_humidity +
1506749019539:mean_wind_speed_mph +
1506749019540:cloud_cover +
1506749019542:events,
1506749019542:method = "forward", nvmax = 15)
1506749020445:s <- summary(l)
1506749020977:s$which
1506749021681:s$cp
1506749023721:s$which[which.min(s$cp),]
1506749053241:which.min(s$cp)
1506749129002:# fit model
1506749129004:formula <- "(num_trips) ~
1506749129006:weekday1 +
1506749129006:mean_temperature_f +
1506749129007:mean_visibility_miles +
1506749129007:`eventsFog-Rain` +
1506749129008:eventsRain +`enentsRain-Thunderstorm`"
1506749130014:fit <- lm(data = weather, formula = formula)
1506749137247:# fit model
1506749137248:formula <- "(num_trips) ~
1506749137249:weekday +
1506749137249:mean_temperature_f +
1506749137250:mean_visibility_miles +
1506749137250:`eventsFog-Rain` +
1506749137250:eventsRain +`enentsRain-Thunderstorm`"
1506749138048:fit <- lm(data = weather, formula = formula)
1506749150552:# fit model
1506749150553:formula <- "(num_trips) ~
1506749150554:weekday +
1506749150554:mean_temperature_f +
1506749150555:mean_visibility_miles +
1506749150556:events"
1506749151015:fit <- lm(data = weather, formula = formula)
1506749152084:summary(fit)
1506749366859:model.matrix(formula, weather1)
1506749376036:?model.matrix
1506749388229:model.matrix(formula, data = weather1)
1506749403723:model.matrix((num_trips) ~
1506749403725:weekday +
1506749403728:mean_temperature_f +
1506749403729:mean_visibility_miles +
1506749403730:events, data = weather1)
1506749420127:model.matrix((num_trips) ~
1506749420128:weekday +
1506749420129:mean_temperature_f +
1506749420130:mean_visibility_miles +
1506749420131:events, data = weather1) %>% class
1506749480896:# fit model
1506749480897:formula <- as.formula("(num_trips) ~
1506749480899:weekday +
1506749480901:mean_temperature_f +
1506749480902:mean_visibility_miles +
1506749480903:events")
1506749484402:formula
1506749493939:weather1frame <- model.frame(formula, weather1)
1506749499107:fit <- lm(data = weather1frame, formula = formula)
1506749512017:weather1frame
1506749526263:weather1frame <- model.matrix(formula, weather1)
1506749526959:fit <- lm(data = weather1frame, formula = formula)
1506749527513:summary(fit)
1506749541990:?model.frame.lm
1506749555608:# fit model
1506749555608:formula <- as.formula("(num_trips) ~
1506749555609:weekday +
1506749555611:mean_temperature_f +
1506749555611:mean_visibility_miles +
1506749555612:events")
1506749556779:weather1frame <- model.frame(formula, weather1)
1506749566632:weather1frame %>% str
1506749578813:weather1frame <- model.matrix(formula, weather1)
1506749582729:weather1frame %>% str
1506749592980:weather1frame <- model.matrix(formula, weather1)
1506749596562:weather1frame
1506749608200:weather1frame %>% class
1506749616291:weather1frame <- model.matrix(formula, weather1) %>% as.tibble()
1506749621121:weather1frame
1506749666718:s$which[which.min(s$cp),]
1506749718515:formula1 <- as.formula(y~x)
1506749722058:formula1
1506749774034:formula1 <- as.formula(num_trips ~
1506749774035:weekday1 + mean_temperture_f +
1506749774037:mean_visibility_mean + eventsRain +
1506749774039:`eventsRain-Thunderstorm`)
1506749778032:fit <- lm(data = weather1frame, formula = formula1)
1506749805055:weather1frame <- model.matrix(formula, weather1) %>% as.tibble()
1506749809321:# fit model
1506749809322:formula <- as.formula("num_trips ~
1506749809323:weekday +
1506749809323:mean_temperature_f +
1506749809324:mean_visibility_miles +
1506749809324:events")
1506749810086:weather1frame <- model.matrix(formula, weather1) %>% as.tibble()
1506749813830:weather1frame
1506749843095:model.frame(formula, weather1) %>% as.tibble()
1506749850341:weather1frame <- model.frame(formula, weather1) %>% as.tibble()
1506749851210:formula1 <- as.formula(num_trips ~
1506749851211:weekday1 + mean_temperture_f +
1506749851213:mean_visibility_mean + eventsRain +
1506749851214:`eventsRain-Thunderstorm`)
1506749851926:fit <- lm(data = weather1frame, formula = formula1)
1506749858587:fit <- lm(data = weather1frame, formula = formula)
1506749859171:summary(fit)
1506749902794:get_all_vars(formula1, weather1)
1506749907444:get_all_vars(formula1, weather)
1506749939903:model <- lm(log(Volume) ~ log(Girth) + log(Height), data = trees)
1506749941241:model
1506749953406:expand.model.frame(model, ~ Girth) # prints data.frame like
1506749992076:fit <- lm(data = cbind(weather1frame, weather1$num_trips), formula = formula1)
1506750002638:weather1frame <- model.matrix(formula, weather1) %>% as.tibble()
1506750003136:formula1 <- as.formula(num_trips ~
1506750003137:weekday1 + mean_temperture_f +
1506750003138:mean_visibility_mean + eventsRain +
1506750003139:`eventsRain-Thunderstorm`)
1506750003485:fit <- lm(data = cbind(weather1frame, weather1$num_trips), formula = formula1)
1506750011447:cbind(weather1frame, weather1$num_trips)
1506750048816:fit <- lm(data = weather1frame %>%
1506750048819:mutate(num_trips = weather1$num_trips), formula = formula1)
1506750053849:weather1frame <- model.matrix(formula, weather1) %>% as.tibble()
1506750054312:formula1 <- as.formula(num_trips ~
1506750054312:weekday1 + mean_temperture_f +
1506750054313:mean_visibility_mean + eventsRain +
1506750054313:`eventsRain-Thunderstorm`)
1506750059897:weather1frame %>%
1506750059898:mutate(num_trips = weather1$num_trips)
1506750066279:formula1 <- as.formula(num_trips ~
1506750066282:weekday1 + mean_temperture_f +
1506750066284:mean_visibility_mean + eventsRain +
1506750066285:`eventsRain-Thunderstorm`)
1506750066985:fit <- lm(data = weather1frame %>%
1506750066986:mutate(num_trips = weather1$num_trips), formula = formula1)
1506750077592:formula1 <- as.formula(num_trips ~
1506750077594:weekday1 + mean_temperature_f +
1506750077594:mean_visibility_mean + eventsRain +
1506750077595:`eventsRain-Thunderstorm`)
1506750077948:fit <- lm(data = weather1frame %>%
1506750077949:mutate(num_trips = weather1$num_trips), formula = formula1)
1506750088361:formula1 <- as.formula(num_trips ~
1506750088363:weekday1 + mean_temperature_f +
1506750088365:mean_visibility_miles + eventsRain +
1506750088366:`eventsRain-Thunderstorm`)
1506750088841:fit <- lm(data = weather1frame %>%
1506750088843:mutate(num_trips = weather1$num_trips), formula = formula1)
1506750089460:summary(fit)
1506750094275:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506750094669:plot(fit)
1506750121284:gvmodel <- gvlma(fit)
1506750121539:summary(gvmodel)
1506750193512:weather %>% View()
1506750198677:weather %>% str
1506750257487:# variable selection
1506750257489:l <- regsubsets(data = weather,
1506750257492:num_trips ~
1506750257493:weekday +
1506750257493:mean_temperature_f +
1506750257494:precipitation_in +
1506750257495:mean_visibility_miles +
1506750257496:mean_humidity +
1506750257497:mean_wind_speed_mph +
1506750257498:cloud_cover +
1506750257499:events,
1506750257499:method = "forward", nvmax = 15)
1506750264244:s <- summary(l)
1506750264843:s$which
1506750266700:s$cp
1506750272419:s$which[which.min(s$cp),]
1506750316105:f1 <- formula(num_trips ~
1506750316107:weekday +
1506750316109:mean_temperature_f +
1506750316109:precipitation_in +
1506750316110:mean_visibility_miles +
1506750316110:mean_humidity +
1506750316111:mean_wind_speed_mph +
1506750316111:cloud_cover +
1506750316112:events)
1506750317802:f
1506750318810:f1
1506750328082:f1 *s$which[which.min(s$cp),]
1506750332393:class(f1)
1506750349083:s$which[which.min(s$cp),]
1506750378400:s$which[which.min(s$cp),] %>% class
1506750387568:s$which[which.min(s$cp),][T]
1506750419418:s$cp
1506750424529:s$which
1506750499921:# variable selection
1506750499922:l <- regsubsets(data = weather1,
1506750499924:num_trips ~
1506750499924:weekday +
1506750499925:mean_temperature_f +
1506750499926:precipitation_in +
1506750499927:mean_visibility_miles +
1506750499928:mean_humidity +
1506750499930:mean_wind_speed_mph +
1506750499933:cloud_cover +
1506750499933:events,
1506750499934:method = "forward", nvmax = 15)
1506750500674:s <- summary(l)
1506750501176:s$which
1506750501788:s$cp
1506750541420:# variable selection
1506750541422:l <- regsubsets(data = weather,
1506750541423:num_trips ~
1506750541423:weekday +
1506750541424:mean_temperature_f +
1506750541424:precipitation_in +
1506750541425:mean_visibility_miles +
1506750541425:mean_humidity +
1506750541426:mean_wind_speed_mph +
1506750541427:cloud_cover +
1506750541428:events,
1506750541429:method = "forward", nvmax = 15)
1506750569126:# variable selection
1506750569128:formula1 <- formula(num_trips ~
1506750569130:weekday +
1506750569132:mean_temperature_f +
1506750569133:precipitation_in +
1506750569134:mean_visibility_miles +
1506750569135:mean_humidity +
1506750569135:mean_wind_speed_mph +
1506750569136:cloud_cover +
1506750569136:events)
1506750569538:l <- regsubsets(data = weather,
1506750569539:formula1,
1506750569540:method = "forward", nvmax = 15)
1506750581302:# variable selection
1506750581304:formula1 <- formula(
1506750581305:num_trips ~
1506750581307:weekday +
1506750581308:mean_temperature_f +
1506750581308:precipitation_in +
1506750581309:mean_visibility_miles +
1506750581309:mean_humidity +
1506750581310:mean_wind_speed_mph +
1506750581310:cloud_cover +
1506750581311:events
1506750581312:)
1506750599544:l <- regsubsets(data = weather, formula1, method = "forward", nvmax = 15)
1506750600709:s <- summary(l)
1506750601612:s$which
1506750601881:s$cp
1506750609156:s$which[which.min(s$cp),]
1506750635454:# variable selection
1506750635455:formula1 <- formula(
1506750635456:num_trips ~
1506750635456:(Intercept)
1506750635457:weekday +
1506750635457:mean_temperature_f +
1506750635458:precipitation_in +
1506750635458:mean_visibility_miles +
1506750635459:mean_humidity +
1506750635460:mean_wind_speed_mph +
1506750635461:cloud_cover +
1506750635462:events
1506750635463:)
1506750639779:# variable selection
1506750639781:formula1 <- formula(
1506750639783:num_trips ~
1506750639785:(Intercept) +
1506750639786:weekday +
1506750639786:mean_temperature_f +
1506750639787:precipitation_in +
1506750639788:mean_visibility_miles +
1506750639789:mean_humidity +
1506750639789:mean_wind_speed_mph +
1506750639790:cloud_cover +
1506750639791:events
1506750639792:)
1506750640026:l <- regsubsets(data = weather, formula1, method = "forward", nvmax = 15)
1506750652292:?formula
1506750682618:# variable selection
1506750682626:formula1 <- formula(
1506750682628:num_trips ~
1506750682628:1+ weekday +
1506750682629:mean_temperature_f +
1506750682630:precipitation_in +
1506750682630:mean_visibility_miles +
1506750682631:mean_humidity +
1506750682631:mean_wind_speed_mph +
1506750682632:cloud_cover +
1506750682633:events
1506750682633:)
1506750683370:l <- regsubsets(data = weather, formula1, method = "forward", nvmax = 15)
1506750683973:s <- summary(l)
1506750684612:s$which
1506750693430:s$cp
1506750694006:s$which[which.min(s$cp),]
1506751076368:cor(weather1)
1506751153942:weather %>% str()
1506751237010:cor(weather1 %>% filter(weekday = 0)) %>% select(-pdt, -events)
1506751241168:cor(weather1 %>% filter(weekday == 0)) %>% select(-pdt, -events)
1506751251947:cor(weather1 %>% filter(weekday == 0) %>% select(-pdt, -events))
1506751269107:weather1 %>% filter(weekday == 0) %>% select(-pdt, -events)
1506751301897:weather1 %>% filter(weekday == 0) %>% select(-pdt, -events, -weekday) %>% cor
1506751345736:weather1 %>% filter(weekday == 0) %>% select(-pdt, -events, -weekday) %>% cor %>% plot
1506751377834:weather1 %>% filter(weekday == 0) %>% select(-pdt, -events, -weekday) %>% cor %>% corPlot()
1506751664038:summary(fit)
1506751677380:summary(fit)$r.sq
1506751690053:summary(fit)$r.sq %>% sqrt
1506751781106:data.frame(s$outmat, RSS = s$rss, R2 = s$rsq)
1506751860536:data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506752196868:fit
1506752766536:summary(fit)
1506752833929:# variable selection
1506752833931:formula1 <- formula(
1506752833932:sqrt(num_trips) ~
1506752833932:1 + weekday +
1506752833933:mean_temperature_f +
1506752833934:precipitation_in +
1506752833935:mean_visibility_miles +
1506752833936:mean_humidity +
1506752833937:mean_wind_speed_mph +
1506752833938:cloud_cover +
1506752833939:events
1506752833939:)
1506752862084:fit <- lm(formula = formula1, data = weather1frame %>% mutate(num_trips = weather1$num_trips))
1506752867768:formula1
1506752876039:# variable selection
1506752876041:formula1 <- formula(
1506752876043:sqrt(num_trips) ~
1506752876044:1 + weekday +
1506752876044:mean_temperature_f +
1506752876045:precipitation_in +
1506752876046:mean_visibility_miles +
1506752876046:mean_humidity +
1506752876047:mean_wind_speed_mph +
1506752876048:cloud_cover +
1506752876048:events
1506752876049:)
1506752876533:l <- regsubsets(data = weather, formula1, method = "forward", nvmax = 15)
1506752879452:l <- regsubsets(data = weather, formula1, method = "forward")
1506752880140:s <- summary(l)
1506752881162:data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506752900758:s$which
1506752901090:s$cp
1506752901627:s$which[which.min(s$cp),]
1506752930046:# variable selection
1506752930048:formula1 <- formula(
1506752930050:sqrt(num_trips) ~
1506752930050:1 + weekday +
1506752930051:mean_temperature_f +
1506752930052:precipitation_in +
1506752930052:mean_visibility_miles +
1506752930053:mean_humidity +
1506752930054:mean_wind_speed_mph +
1506752930055:cloud_cover +
1506752930056:events
1506752930056:)
1506752991238:# variable selection
1506752991240:# 1. basic formula
1506752991241:formula1 <- formula(
1506752991241:sqrt(num_trips) ~
1506752991242:1 + weekday +
1506752991244:mean_temperature_f +
1506752991245:precipitation_in +
1506752991247:mean_visibility_miles +
1506752991248:mean_humidity +
1506752991249:mean_wind_speed_mph +
1506752991250:cloud_cover +
1506752991251:events
1506752991252:)
1506752991493:l <- regsubsets(data = weather, formula1, method = "forward")
1506752991638:s <- summary(l)
1506752991810:data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506752991978:s$which
1506752992404:s$cp
1506752992869:s$which[which.min(s$cp),]
1506753084622:weather <- weather %>%
1506753084624:mutate(weekday = factor(weekday))
1506753086941:# variable selection
1506753086942:# 1. basic formula
1506753086943:formula1 <- formula(
1506753086945:sqrt(num_trips) ~
1506753086946:1 + weekday +
1506753086948:mean_temperature_f +
1506753086950:precipitation_in +
1506753086950:mean_visibility_miles +
1506753086951:mean_humidity +
1506753086953:mean_wind_speed_mph +
1506753086954:cloud_cover +
1506753086954:events
1506753086955:)
1506753087589:l <- regsubsets(data = weather, formula1, method = "forward")
1506753088106:s <- summary(l)
1506753088532:data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506753088942:s$which
1506753089576:s$cp
1506753100202:weather %>% str
1506753155443:# variable selection
1506753155446:# 1. basic formula
1506753155447:formula1 <- formula(
1506753155449:sqrt(num_trips) ~
1506753155451:1 + weekday +
1506753155453:mean_temperature_f +
1506753155453:precipitation_in +
1506753155454:mean_visibility_miles +
1506753155455:mean_humidity +
1506753155456:mean_wind_speed_mph +
1506753155457:cloud_cover +
1506753155463:events
1506753155464:)
1506753161527:l <- regsubsets(data = weather, formula1)
1506753162012:s <- summary(l)
1506753162441:data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506753198432:# variable selection
1506753198434:# 1. basic formula
1506753198434:formula1 <- formula(
1506753198436:num_trips ~
1506753198437:1 + weekday +
1506753198439:mean_temperature_f +
1506753198439:precipitation_in +
1506753198440:mean_visibility_miles +
1506753198440:mean_humidity +
1506753198441:mean_wind_speed_mph +
1506753198442:cloud_cover +
1506753198442:events
1506753198443:)
1506753198825:l <- regsubsets(data = weather, formula1)
1506753199477:s <- summary(l)
1506753199944:data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506753201555:s$which
1506753207257:s$cp
1506753208333:s$which[which.min(s$cp),]
1506753248502:s$which
1506753250328:s$cp
1506753259697:s$which[which.min(s$cp),]
1506753375644:# after variable selection, fit the linear model on weather data
1506753375645:# fit model
1506753375646:formula2 <- formula(
1506753375647:num_trips ~ 1 +
1506753375648:weekday1 +
1506753375648:mean_temperature_f +
1506753375648:mean_visibility_miles +
1506753375649:cloud_cover +
1506753375649:eventsFog-Rain +
1506753375650:eventsNone +
1506753375651:eventsRain +
1506753375652:eventsRain-Thunderstorm)
1506753378663:formula
1506753380148:formula2
1506753401632:# after variable selection, fit the linear model on weather data
1506753401633:# fit model
1506753401633:formula2 <- formula(
1506753401634:num_trips ~ 1 +
1506753401635:weekday1 +
1506753401635:mean_temperature_f +
1506753401636:mean_visibility_miles +
1506753401637:cloud_cover +
1506753401638:`eventsFog-Rain` +
1506753401640:eventsNone +
1506753401641:eventsRain +
1506753401641:`eventsRain-Thunderstorm`)
1506753403966:formula2
1506753410522:weather1frame <- model.matrix(formula, weather1) %>% as.tibble()
1506753431272:weather1frame <- model.matrix(formula2, weather1) %>% as.tibble()
1506753441221:weather1frame <- model.matrix(formula1, weather1) %>% as.tibble()
1506753458580:weather1frame
1506753480567:fit <- lm(data = weather1frame %>%
1506753480568:mutate(num_trips = weather1$num_trips), formula2)
1506753481252:summary(fit)
1506753504913:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506753505184:plot(fit)
1506753523883:weather1frame <- model.matrix(formula1, weather) %>% as.tibble()
1506753525086:formula1 <- as.formula(num_trips ~
1506753525088:weekday1 + mean_temperature_f +
1506753525089:mean_visibility_miles + eventsRain +
1506753525091:`eventsRain-Thunderstorm`)
1506753533983:weather1frame <- model.matrix(formula1, weather) %>% as.tibble()
1506753540322:weather_frame <- model.matrix(formula1, weather) %>% as.tibble()
1506753558482:formula1
1506753562513:# variable selection
1506753562514:# 1. basic formula
1506753562514:formula1 <- formula(
1506753562515:num_trips ~
1506753562516:1 + weekday +
1506753562517:mean_temperature_f +
1506753562518:precipitation_in +
1506753562519:mean_visibility_miles +
1506753562519:mean_humidity +
1506753562520:mean_wind_speed_mph +
1506753562520:cloud_cover +
1506753562521:events
1506753562521:)
1506753564657:# after variable selection, fit the linear model on weather data
1506753564659:# fit model
1506753564661:formula2 <- formula(
1506753564662:num_trips ~ 1 +
1506753564662:weekday1 +
1506753564663:mean_temperature_f +
1506753564664:mean_visibility_miles +
1506753564664:cloud_cover +
1506753564665:`eventsFog-Rain` +
1506753564665:eventsNone +
1506753564666:eventsRain +
1506753564666:`eventsRain-Thunderstorm`)
1506753565674:weather_frame <- model.matrix(formula1, weather) %>% as.tibble()
1506753568507:formula1 <- as.formula(num_trips ~
1506753568509:weekday1 + mean_temperature_f +
1506753568510:mean_visibility_miles + eventsRain +
1506753568511:`eventsRain-Thunderstorm`)
1506753571472:# variable selection
1506753571473:# 1. basic formula
1506753571474:formula1 <- formula(
1506753571475:num_trips ~
1506753571476:1 + weekday +
1506753571477:mean_temperature_f +
1506753571479:precipitation_in +
1506753571481:mean_visibility_miles +
1506753571482:mean_humidity +
1506753571483:mean_wind_speed_mph +
1506753571484:cloud_cover +
1506753571485:events
1506753571486:)
1506753572028:l <- regsubsets(data = weather, formula1)
1506753572227:s <- summary(l)
1506753572420:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506753572421:# s$which
1506753572422:s$cp
1506753572554:s$which[which.min(s$cp),]
1506753572725:# after variable selection, fit the linear model on weather data
1506753572726:# fit model
1506753572727:formula2 <- formula(
1506753572729:num_trips ~ 1 +
1506753572731:weekday1 +
1506753572732:mean_temperature_f +
1506753572733:mean_visibility_miles +
1506753572733:cloud_cover +
1506753572734:`eventsFog-Rain` +
1506753572735:eventsNone +
1506753572736:eventsRain +
1506753572736:`eventsRain-Thunderstorm`)
1506753575486:weather_frame <- model.matrix(formula1, weather) %>% as.tibble()
1506753579528:fit <- lm(data = weather1frame %>%
1506753579531:mutate(num_trips = weather1$num_trips), formula2)
1506753596836:fit <- lm(data = weather1frame %>%
1506753596839:mutate(num_trips = weather$num_trips), formula2)
1506753598159:summary(fit)
1506753607001:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506753607220:plot(fit)
1506753643618:fit <- lm(data = weather_frame %>%
1506753643620:mutate(num_trips = weather$num_trips), formula2)
1506753644293:summary(fit)
1506753672175:holidaydates <- holidays(c(2015, 2016))
1506753672783:weather1 <- weather %>%
1506753672784:mutate(weekday = ifelse(
1506753672785:pdt %in% holidaydates, "1", weekday
1506753672785:))
1506753708790:weather_frame <- model.matrix(formula1, weather1) %>% as.tibble()
1506753710436:fit <- lm(data = weather_frame %>%
1506753710438:mutate(num_trips = weather$num_trips), formula2)
1506753717870:# variable selection
1506753717871:# 1. basic formula
1506753717871:formula1 <- formula(
1506753717872:num_trips ~
1506753717872:1 + weekday +
1506753717873:mean_temperature_f +
1506753717873:precipitation_in +
1506753717874:mean_visibility_miles +
1506753717874:mean_humidity +
1506753717874:mean_wind_speed_mph +
1506753717875:cloud_cover +
1506753717875:events
1506753717876:)
1506753722544:l <- regsubsets(data = weather1, formula1)
1506753723070:s <- summary(l)
1506753724157:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506753724157:# s$which
1506753724158:s$cp
1506753728002:s$which[which.min(s$cp),]
1506753738560:l <- regsubsets(data = weather, formula1)
1506753739129:s <- summary(l)
1506753739460:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506753739461:# s$which
1506753739461:s$cp
1506753740098:s$which[which.min(s$cp),]
1506753791357:weather %>% str
1506753810198:weather <- read_csv("data/201608_weather_data.csv")
1506753810432:# rename
1506753810434:names(weather) <-
1506753810436:names(weather) %>%
1506753810438:gsub(" ", "_", .) %>%
1506753810439:gsub("([a-z])([A-Z])", "\\1\\_\\2", .) %>%
1506753810440:tolower()
1506753810725:weather <- weather %>%
1506753810726:mutate(events = ifelse(is.na(events), "None", events)) %>%
1506753810727:mutate(events = as.factor(events)) %>%
1506753810727:mutate(pdt = mdy(pdt))
1506753811176:weather <- weather %>%
1506753811177:mutate(precipitation_in = as.numeric(precipitation_in)) %>%
1506753811178:mutate(precipitation_in = ifelse(is.na(precipitation_in),
1506753811178:0, precipitation_in))
1506753812184:# only select the weather that for the SF. zip = 94107
1506753812185:weather <- weather %>%
1506753812186:filter(zip == 94107)
1506753817055:weather <- weather %>%
1506753817058:mutate(day_of_week = pdt %>% strftime("%A"),
1506753817060:week_nr = pdt %>% strftime("%W"),
1506753817061:weekday = pdt %>% strftime("%u") %>% as.numeric) %>%
1506753817061:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506753817062:mutate(weekday = as.character(as.numeric(factor(weekday)) - 1)) %>%
1506753817063:mutate(zip = factor(zip))
1506753817811:weather <- weather %>%
1506753817813:select(pdt, weekday, mean_temperature_f, mean_dew_point_f, mean_humidity,
1506753817814:mean_sea_level_pressure_in, mean_visibility_miles,
1506753817815:mean_wind_speed_mph, precipitation_in, cloud_cover,
1506753817817:num_trips, events)
1506753833713:weather <- read_csv("data/201608_weather_data.csv")
1506753833905:# rename
1506753833906:names(weather) <-
1506753833907:names(weather) %>%
1506753833907:gsub(" ", "_", .) %>%
1506753833908:gsub("([a-z])([A-Z])", "\\1\\_\\2", .) %>%
1506753833908:tolower()
1506753834158:weather <- weather %>%
1506753834159:mutate(events = ifelse(is.na(events), "None", events)) %>%
1506753834160:mutate(events = as.factor(events)) %>%
1506753834160:mutate(pdt = mdy(pdt))
1506753834646:weather <- weather %>%
1506753834648:mutate(precipitation_in = as.numeric(precipitation_in)) %>%
1506753834650:mutate(precipitation_in = ifelse(is.na(precipitation_in),
1506753834652:0, precipitation_in))
1506753835093:# only select the weather that for the SF. zip = 94107
1506753835094:weather <- weather %>%
1506753835095:filter(zip == 94107)
1506753844430:weather <- weather %>%
1506753844433:left_join(trip_daily, by = c("pdt" = "start_date"))
1506753844889:weather <- weather %>%
1506753844890:mutate(day_of_week = pdt %>% strftime("%A"),
1506753844891:week_nr = pdt %>% strftime("%W"),
1506753844891:weekday = pdt %>% strftime("%u") %>% as.numeric) %>%
1506753844892:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506753844892:mutate(weekday = as.character(as.numeric(factor(weekday)) - 1)) %>%
1506753844893:mutate(zip = factor(zip))
1506753846022:weather <- weather %>%
1506753846023:select(pdt, weekday, mean_temperature_f, mean_dew_point_f, mean_humidity,
1506753846024:mean_sea_level_pressure_in, mean_visibility_miles,
1506753846025:mean_wind_speed_mph, precipitation_in, cloud_cover,
1506753846025:num_trips, events)
1506753849959:weather %>% str
1506753856660:weather <- weather %>%
1506753856661:mutate(weekday = factor(weekday))
1506753863240:weather %>% str
1506753870081:weather %>% glimpse
1506753885234:# variable selection
1506753885237:# 1. basic formula
1506753885238:formula1 <- formula(
1506753885239:num_trips ~
1506753885240:1 + weekday +
1506753885240:mean_temperature_f +
1506753885241:precipitation_in +
1506753885242:mean_visibility_miles +
1506753885243:mean_humidity +
1506753885243:mean_wind_speed_mph +
1506753885244:cloud_cover +
1506753885245:events
1506753885245:)
1506753885741:l <- regsubsets(data = weather, formula1)
1506753886761:s <- summary(l)
1506753889648:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506753889649:# s$which
1506753889650:s$cp
1506753890329:s$which[which.min(s$cp),]
1506753902656:which.min(s$cp)
1506753921364:?regsubsets
1506753936581:l <- regsubsets(data = weather, formula1, nvmax = 15)
1506753937213:s <- summary(l)
1506753937947:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506753937948:# s$which
1506753937948:s$cp
1506753941422:s$which[which.min(s$cp),]
1506753955632:# after variable selection, fit the linear model on weather data
1506753955634:# fit model
1506753955634:formula2 <- formula(
1506753955637:num_trips ~ 1 +
1506753955638:weekday1 +
1506753955640:mean_temperature_f +
1506753955641:mean_visibility_miles +
1506753955642:cloud_cover +
1506753955643:`eventsFog-Rain` +
1506753955644:eventsNone +
1506753955645:eventsRain +
1506753955646:`eventsRain-Thunderstorm`)
1506753956787:weather_frame <- model.matrix(formula1, weather) %>% as.tibble()
1506753957479:fit <- lm(data = weather_frame %>%
1506753957480:mutate(num_trips = weather$num_trips), formula2)
1506753958064:summary(fit)
1506753960736:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506753960979:plot(fit)
1506753967154:# holiday may affect
1506753967157:weather %>%
1506753967159:filter(weekday == "1", num_trips < 1000) %>%
1506753967160:select(pdt, num_trips)
1506754003660:weather1 %>%
1506754003661:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506754003662:geom_point(aes(shape = factor(weekday), size = precipitation_in)) +
1506754003662:scale_color_brewer(palette = "Set1")
1506754049220:weather %>%
1506754049223:filter(weekday == "0", num_trips < 1500) %>%
1506754049225:select(pdt, num_trips)
1506754055952:weather %>%
1506754055953:filter(weekday == "0", num_trips < 1000) %>%
1506754055954:select(pdt, num_trips)
1506754098202:holidaydates <- holidays(c(2015, 2016))
1506754109319:weather1 <- weather %>%
1506754109320:mutate(weekday = ifelse(
1506754109321:pdt %in% holidaydates, "1", weekday
1506754109321:))
1506754111945:# holiday may affect
1506754111947:weather1 %>%
1506754111948:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506754111949:geom_point(aes(shape = factor(weekday), size = precipitation_in)) +
1506754111951:scale_color_brewer(palette = "Set1")
1506754117220:# holiday may affect
1506754117222:weather %>%
1506754117223:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506754117224:geom_point(aes(shape = factor(weekday), size = precipitation_in)) +
1506754117226:scale_color_brewer(palette = "Set1")
1506754146864:# holidays in a year
1506754146865:holidays <- function(year) {
1506754146867:allholidays <- c(USNewYearsDay, USMLKingsBirthday, USMemorialDay, USIndependenceDay, USLaborDay, USThanksgivingDay, USChristmasDay, USPresidentsDay)
1506754146868:holidaydates <- c()
1506754146869:for (i in 1:length(allholidays)) {
1506754146869:x <- allholidays[[i]](year)
1506754146870:holidaydates <- append(holidaydates, x)
1506754146870:}
1506754146871:holidaydates <- holidaydates %>%
1506754146872:as.Date() %>% append(as.Date(c("2015-11-27", "2015-12-24", "2015-12-31")))
1506754146873:return(sort(holidaydates))
1506754146875:}
1506754155888:weather1 <- weather %>%
1506754155889:mutate(weekday = ifelse(
1506754155890:pdt %in% holidaydates, "1", weekday
1506754155891:))
1506754162824:# holiday may affect
1506754162827:weather1 %>%
1506754162828:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506754162829:geom_point(aes(shape = factor(weekday), size = precipitation_in)) +
1506754162829:scale_color_brewer(palette = "Set1")
1506754174936:weather %>%
1506754174938:filter(weekday == "0", num_trips < 1000) %>%
1506754174939:select(pdt, num_trips)
1506754185085:weather1 %>%
1506754185087:filter(weekday == "0", num_trips < 1000) %>%
1506754185087:select(pdt, num_trips)
1506754206712:# holiday may affect
1506754206714:weather %>%
1506754206716:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506754206717:geom_point(aes(shape = factor(weekday), size = precipitation_in)) +
1506754206718:scale_color_brewer(palette = "Set1")
1506754213434:# holiday may affect
1506754213436:weather1 %>%
1506754213437:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506754213438:geom_point(aes(shape = factor(weekday), size = precipitation_in)) +
1506754213440:scale_color_brewer(palette = "Set1")
1506754224302:holidaydates
1506754257984:plot(fit)
1506754275089:# holiday may affect
1506754275091:weather %>%
1506754275091:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506754275092:geom_point(aes(shape = factor(weekday), size = precipitation_in)) +
1506754275093:scale_color_brewer(palette = "Set1")
1506754309687:# holiday may affect
1506754309689:weather1 %>%
1506754309691:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506754309692:geom_point(aes(shape = factor(weekday), size = precipitation_in)) +
1506754309693:scale_color_brewer(palette = "Set1")
1506754323087:# holiday may affect
1506754323088:weather %>%
1506754323090:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506754323091:geom_point(aes(shape = factor(weekday), size = precipitation_in)) +
1506754323093:scale_color_brewer(palette = "Set1")
1506754333259:holidaydates <- holidays(c(2015, 2016))
1506754338251:weather1 <- weather %>%
1506754338253:mutate(weekday = ifelse(
1506754338254:pdt %in% holidaydates, "1", weekday
1506754338254:))
1506754341667:weather1
1506754369879:cbind(weather1$pdt, weather$weekday, weather1$weekday)
1506754378243:cbind(weather1$pdt, weather$weekday, weather1$weekday) %>% View
1506754429262:weather1 %>%
1506754429263:filter(weekday == "0", num_trips < 1000) %>%
1506754429264:select(pdt, num_trips)
1506754493711:weather %>%
1506754493715:filter(weekday == "0", num_trips < 1000) %>%
1506754493716:select(pdt, num_trips)
1506754505077:weather1 <- weather %>%
1506754505079:mutate(weekday = ifelse(
1506754505079:pdt %in% holidaydates, "1", weekday
1506754505080:))
1506754521558:cbind(weather1$pdt, weather$weekday, weather1$weekday) %>% View
1506754538626:cbind.data.frame(weather1$pdt, weather$weekday, weather1$weekday) %>% View
1506754566919:weather1 %>% glimpse
1506754676380:weather
1506754682879:weather %>% str()
1506754688761:weather1 <- weather %>%
1506754688762:mutate(weekday = ifelse(
1506754688763:pdt %in% holidaydates, 1, weekday
1506754688764:))
1506754693333:weather1 %>% str()
1506754713082:levels(weather1$weekday)
1506754725399:levels(weather$weekday)
1506754758690:weather1 <- weather %>%
1506754758691:mutate(weekday = ifelse(
1506754758692:pdt %in% holidaydates, levels(weather$weekday)[1], weekday
1506754758694:))
1506754762032:weather1 %>% str()
1506754774718:weather1 <- weather %>%
1506754774720:mutate(weekday = ifelse(
1506754774720:pdt %in% holidaydates, factor("0"), weekday
1506754774722:))
1506754778482:weather1 %>% str()
1506754783805:factor(0)
1506754790057:factor("0")
1506754803769:summary(weather$weekday)
1506754825075:weather1 <- weather %>%
1506754825076:mutate(weekday = ifelse(
1506754825076:pdt %in% holidaydates, 0, weekday
1506754825077:))
1506754830157:weather1 %>% str()
1506754842350:weather1 <- weather %>%
1506754842352:mutate(weekday = ifelse(
1506754842352:pdt %in% holidaydates, "0", weekday
1506754842353:))
1506754844596:weather1 %>% str()
1506754852850:weather %>% str()
1506754876660:levels(weather$weekday)
1506754878957:levels(weather$weekday)[1]
1506754895152:levels(weather$weekday)[1] %>% class
1506754910663:weather$weekday[1]
1506754923140:?factor
1506754960327:weather1 <- weather %>%
1506754960329:mutate(weekday = ifelse(
1506754960329:pdt %in% holidaydates, factor("0", levels = levels(weather$weekday)), weekday
1506754960330:))
1506754966054:weather1 %>% str()
1506754995322:weather1
1506755001947:weather
1506755014732:weather <- weather %>%
1506755014734:mutate(weekday = character(weekday))
1506755018393:weather <- weather %>%
1506755018394:mutate(weekday = as.character(weekday))
1506755025981:# variable selection
1506755025982:# 1. basic formula
1506755025983:formula1 <- formula(
1506755025984:num_trips ~
1506755025985:1 + weekday +
1506755025987:mean_temperature_f +
1506755025988:precipitation_in +
1506755025990:mean_visibility_miles +
1506755025991:mean_humidity +
1506755025992:mean_wind_speed_mph +
1506755025993:cloud_cover +
1506755025993:events
1506755025994:)
1506755026413:l <- regsubsets(data = weather, formula1, nvmax = 15)
1506755026865:s <- summary(l)
1506755027278:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506755027279:# s$which
1506755027279:s$cp
1506755027678:s$which[which.min(s$cp),]
1506755032398:# after variable selection, fit the linear model on weather data
1506755032399:# fit model
1506755032399:formula2 <- formula(
1506755032401:num_trips ~ 1 +
1506755032402:weekday1 +
1506755032403:mean_temperature_f +
1506755032405:mean_visibility_miles +
1506755032406:cloud_cover +
1506755032407:`eventsFog-Rain` +
1506755032408:eventsNone +
1506755032408:eventsRain +
1506755032409:`eventsRain-Thunderstorm`)
1506755035674:weather_frame <- model.matrix(formula1, weather) %>% as.tibble()
1506755036873:fit <- lm(data = weather_frame %>%
1506755036874:mutate(num_trips = weather$num_trips), formula2)
1506755037592:summary(fit)
1506755044645:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506755044993:plot(fit)
1506755045669:# holiday may affect
1506755045670:weather %>%
1506755045671:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506755045671:geom_point(aes(shape = factor(weekday), size = precipitation_in)) +
1506755045672:scale_color_brewer(palette = "Set1")
1506755049636:# holiday may affect
1506755049639:weather %>%
1506755049640:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506755049641:geom_point(aes(shape = (weekday), size = precipitation_in)) +
1506755049642:scale_color_brewer(palette = "Set1")
1506755055643:# holiday may affect
1506755055644:weather %>%
1506755055645:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506755055645:geom_point(aes(shape = weekday, size = precipitation_in)) +
1506755055647:scale_color_brewer(palette = "Set1")
1506755056965:weather %>%
1506755056966:filter(weekday == "0", num_trips < 1000) %>%
1506755056966:select(pdt, num_trips)
1506755061434:holidaydates <- holidays(c(2015, 2016))
1506755061846:weather1 <- weather %>%
1506755061848:mutate(weekday = ifelse(
1506755061849:pdt %in% holidaydates, factor("0", levels = levels(weather$weekday)), weekday
1506755061851:))
1506755068318:weather1
1506755077397:weather
1506755093657:weather1 <- weather %>%
1506755093658:mutate(weekday = ifelse(
1506755093659:pdt %in% holidaydates, "0", weekday
1506755093659:))
1506755095774:weather
1506755097802:weather1
1506755114182:# holiday may affect
1506755114183:weather1 %>%
1506755114184:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506755114186:geom_point(aes(shape = weekday, size = precipitation_in)) +
1506755114187:scale_color_brewer(palette = "Set1")
1506755127780:weather1 %>%
1506755127781:filter(weekday == "0", num_trips < 1000) %>%
1506755127786:select(pdt, num_trips)
1506755132018:weather %>%
1506755132019:filter(weekday == "0", num_trips < 1000) %>%
1506755132020:select(pdt, num_trips)
1506755137764:# holiday may affect
1506755137765:weather %>%
1506755137765:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506755137766:geom_point(aes(shape = weekday, size = precipitation_in)) +
1506755137766:scale_color_brewer(palette = "Set1")
1506755139173:weather %>%
1506755139175:filter(weekday == "0", num_trips < 1000) %>%
1506755139175:select(pdt, num_trips)
1506755139977:holidaydates <- holidays(c(2015, 2016))
1506755166563:weather[pdt %in% holidaydates,]
1506755168484:weather[pdt %in% holidaydates]
1506755177661:weather[weather$pdt %in% holidaydates,]
1506755198122:weather1 <- weather %>%
1506755198134:mutate(weekday = ifelse(
1506755198136:pdt %in% holidaydates, "1", weekday
1506755198139:))
1506755201279:# holiday may affect
1506755201299:weather1 %>%
1506755201300:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506755201301:geom_point(aes(shape = weekday, size = precipitation_in)) +
1506755201302:scale_color_brewer(palette = "Set1")
1506755241022:weather1 %>%
1506755241024:filter(weekday == "0", num_trips < 1000) %>%
1506755241025:select(pdt, num_trips)
1506755263912:fit_holiday_adjust <- lm(data = weather1, formula = formula2)
1506755264580:summary(fit_holiday_adjust)
1506755266506:fit_holiday_adjust <- lm(data = weather1, formula = formula2)
1506755284687:weather_adjusted <- weather %>%
1506755284688:mutate(weekday = ifelse(
1506755284688:pdt %in% holidaydates, "1", weekday
1506755284689:))
1506755311521:weather_adjusted_frame <- model.matrix(formula1, weather_adjusted) %>%
1506755311522:as.tibble()
1506755327307:fit_holiday_adjust <- lm(data = weather_adjusted_frame, formula = formula2)
1506755347584:fit_holiday_adjust <- lm(data = weather_adjusted_frame %>%
1506755347586:mutate(num_trips = weather$num_trips),
1506755347586:formula = formula2)
1506755349259:summary(fit_holiday_adjust)
1506755357423:summary(fit)
1506755363147:summary(fit_holiday_adjust)
1506755374515:plot(fit_holiday_adjust)
1506755380076:plot(fit)
1506755383685:plot(fit_holiday_adjust)
1506755397320:# after variable selection, fit the linear model on weather data
1506755397322:# fit model
1506755397322:formula2 <- formula(
1506755397323:sqrt(num_trips) ~ 1 +
1506755397323:weekday1 +
1506755397324:mean_temperature_f +
1506755397324:mean_visibility_miles +
1506755397325:cloud_cover +
1506755397325:`eventsFog-Rain` +
1506755397326:eventsNone +
1506755397328:eventsRain +
1506755397329:`eventsRain-Thunderstorm`)
1506755399893:fit_holiday_adjust <- lm(data = weather_adjusted_frame %>%
1506755399894:mutate(num_trips = weather$num_trips),
1506755399896:formula = formula2)
1506755401012:summary(fit_holiday_adjust)
1506755440343:weather_holiday_adjust <- weather %>%
1506755440345:mutate(weekday = ifelse(
1506755440346:pdt %in% holidaydates, "1", weekday
1506755440347:))
1506755466925:weather_holiday_adjust <- weather %>%
1506755466926:mutate(weekday = ifelse(
1506755466927:pdt %in% holidaydates, "1", weekday
1506755466928:))
1506755467332:weather_holiday_adjust_frame <-
1506755467334:model.matrix(formula1, weather_holiday_adjust) %>%
1506755467335:as.tibble()
1506755467778:fit_holiday_adjust <- lm(data = weather_holiday_adjust_frame %>%
1506755467786:mutate(num_trips = weather$num_trips),
1506755467787:formula = formula2)
1506755468238:summary(fit_holiday_adjust)
1506755470590:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506755470749:plot(fit_holiday_adjust)
1506755507510:l <- regsubsets(data = weather_holiday_adjust, formula1, nvmax = 15)
1506755507992:s <- summary(l)
1506755508688:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506755508689:# s$which
1506755508690:s$cp
1506755513135:s$which[which.min(s$cp),]
1506755585527:formula3 <- formula(
1506755585530:num_trips ~ 1 +
1506755585532:weekday1 +
1506755585533:mean_temperature_f +
1506755585534:mean_visibility_miles +
1506755585535:eventsRain +
1506755585536:`eventsRain-Thunderstorm`
1506755585536:)
1506755593288:weather_holiday_adjust_frame <-
1506755593289:model.matrix(formula1, weather_holiday_adjust) %>%
1506755593290:as.tibble()
1506755597662:fit_holiday_adjust <- lm(data = weather_holiday_adjust_frame %>%
1506755597663:mutate(num_trips = weather$num_trips),
1506755597663:formula = formula3)
1506755598401:summary(fit_holiday_adjust)
1506755598769:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506755603154:plot(fit_holiday_adjust)
1506755648564:formula3 <- formula(
1506755648566:sqrt(num_trips) ~ 1 +
1506755648568:weekday1 +
1506755648569:mean_temperature_f +
1506755648570:mean_visibility_miles +
1506755648571:eventsRain +
1506755648572:`eventsRain-Thunderstorm`
1506755648572:)
1506755651882:fit_holiday_adjust <- lm(data = weather_holiday_adjust_frame %>%
1506755651883:mutate(num_trips = weather$num_trips),
1506755651885:formula = formula3)
1506755652591:summary(fit_holiday_adjust)
1506755654166:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506755654627:plot(fit_holiday_adjust)
1506755697232:formula3 <- formula(
1506755697235:num_trips ~ 1 +
1506755697236:weekday1 +
1506755697237:mean_temperature_f +
1506755697239:mean_visibility_miles +
1506755697241:eventsRain +
1506755697242:`eventsRain-Thunderstorm`
1506755697243:)
1506755701132:fit_holiday_adjust <- lm(data = weather_holiday_adjust_frame %>%
1506755701132:mutate(num_trips = weather$num_trips),
1506755701133:formula = formula3)
1506755701926:summary(fit_holiday_adjust)
1506755703109:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506755703625:plot(fit_holiday_adjust)
1506755788121:formula3 <- formula(
1506755788123:sqrt(num_trips) ~ 1 +
1506755788123:weekday1 +
1506755788125:mean_temperature_f +
1506755788126:mean_visibility_miles +
1506755788127:eventsRain +
1506755788128:`eventsRain-Thunderstorm`
1506755788128:)
1506755810213:formula
1506755821034:formula3 <- formula(
1506755821036:sqrt(num_trips) ~ 1 +
1506755821036:weekday1 +
1506755821037:mean_temperature_f +
1506755821037:mean_visibility_miles +
1506755821037:eventsRain +
1506755821038:`eventsRain-Thunderstorm`
1506755821039:)
1506755824030:fit_holiday_adjust <- lm(data = weather_holiday_adjust_frame %>%
1506755824031:mutate(num_trips = weather$num_trips),
1506755824031:formula = formula3)
1506755824691:summary(fit_holiday_adjust)
1506755825111:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506755825633:plot(fit_holiday_adjust)
1506755843913:# variable selection
1506755843914:# 1. basic formula
1506755843914:formula1 <- formula(
1506755843915:sqrt(num_trips) ~
1506755843916:1 + weekday +
1506755843916:mean_temperature_f +
1506755843917:precipitation_in +
1506755843918:mean_visibility_miles +
1506755843919:mean_humidity +
1506755843920:mean_wind_speed_mph +
1506755843922:cloud_cover +
1506755843925:events
1506755843925:)
1506755848131:l <- regsubsets(data = weather_holiday_adjust, formula1, nvmax = 15)
1506755849672:s <- summary(l)
1506755850245:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506755850247:# s$which
1506755850248:s$cp
1506755856728:s$which[which.min(s$cp),]
1506755863780:# variable selection
1506755863782:# 1. basic formula
1506755863782:formula1 <- formula(
1506755863783:(num_trips) ~
1506755863783:1 + weekday +
1506755863784:mean_temperature_f +
1506755863784:precipitation_in +
1506755863785:mean_visibility_miles +
1506755863787:mean_humidity +
1506755863788:mean_wind_speed_mph +
1506755863791:cloud_cover +
1506755863792:events
1506755863793:)
1506755871973:l <- regsubsets(data = weather_holiday_adjust, formula1, nvmax = 15)
1506755872440:s <- summary(l)
1506755872914:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506755872916:# s$which
1506755872917:s$cp
1506755895224:summary(fit_holiday_adjust)
1506755907418:l <- regsubsets(data = weather_holiday_adjust, formula1, nvmax = 15)
1506755907935:s <- summary(l)
1506755908792:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506755908793:# s$which
1506755908794:s$cp
1506755911784:s$which[which.min(s$cp),]
1506755940209:formula3 <- formula(
1506755940210:sqrt(num_trips) ~ 1 +
1506755940210:weekday1 +
1506755940211:mean_temperature_f +
1506755940212:mean_visibility_miles +
1506755940212:eventsRain
1506755940212:)
1506755944756:fit_holiday_adjust <- lm(data = weather_holiday_adjust_frame %>%
1506755944758:mutate(num_trips = weather$num_trips),
1506755944760:formula = formula3)
1506755945452:summary(fit_holiday_adjust)
1506755958504:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506755959195:plot(fit_holiday_adjust)
1506756010490:?formula
1506756054276:formula3 <- formula(
1506756054279:sqrt(num_trips) ~ 1 +
1506756054281:weekday1 +
1506756054282:mean_temperature_f +
1506756054283:mean_visibility_miles +
1506756054283:eventsRain +
1506756054284:`eventsRain-Thunderstorm`
1506756054285:)
1506756058243:fit_holiday_adjust <- lm(data = weather_holiday_adjust_frame %>%
1506756058244:mutate(num_trips = weather$num_trips),
1506756058245:formula = formula3)
1506756059179:summary(fit_holiday_adjust)
1506756060263:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506756061715:plot(fit_holiday_adjust)
1506756090401:gvmodel <- gvlma(fit_holiday_adjust)
1506756091151:summary(gvmodel)
1506756099696:formula3 <- formula(
1506756099699:sqrt(num_trips) ~ 1 +
1506756099702:weekday1 +
1506756099703:mean_temperature_f +
1506756099704:mean_visibility_miles +
1506756099704:eventsRain)
1506756102602:fit_holiday_adjust <- lm(data = weather_holiday_adjust_frame %>%
1506756102604:mutate(num_trips = weather$num_trips),
1506756102605:formula = formula3)
1506756106757:gvmodel <- gvlma(fit_holiday_adjust)
1506756107192:summary(gvmodel)
1506756132742:vif(fit_holiday_adjust)
1506756143240:plot(x=fitted(fit_holiday_adjust), y=rstudent(fit_holiday_adjust))
1506756143824:abline(h=3,col="red",lty=2)
1506756144535:abline(h=-3,col="red",lty=2)
1506756155339:plot(fit_holiday_adjust)
1506756159928:dev.off()
1506756161343:plot(fit_holiday_adjust)
1506756274361:set.seed(1)
1506756312971:weather %>% sample_n(100)
1506756358399:sample(49)
1506756365047:sample(49, 1000)
1506756370286:sample(49,  1:1000)
1506756374165:?sample
1506756414103:weather_test <- weather %>% sample_n(300)
1506756474515:weather_train <- weather %>% sample_n(300)
1506756486016:weather_test <- weahter %>% filter(!(pdt %in% weather_train$pdt))
1506756499261:weather_test <- weather %>% filter(!(pdt %in% weather_train$pdt))
1506756523322:weather <- weather_train
1506756537955:# variable selection
1506756537957:# 1. basic formula
1506756537957:formula1 <- formula(
1506756537957:num_trips ~
1506756537958:1 + weekday +
1506756537958:mean_temperature_f +
1506756537960:precipitation_in +
1506756537962:mean_visibility_miles +
1506756537962:mean_humidity +
1506756537963:mean_wind_speed_mph +
1506756537963:cloud_cover +
1506756537964:events
1506756537964:)
1506756538543:l <- regsubsets(data = weather, formula1, nvmax = 15)
1506756539072:s <- summary(l)
1506756539406:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506756539406:# s$which
1506756539407:s$cp
1506756543828:s$which[which.min(s$cp),]
1506756547759:# after variable selection, fit the linear model on weather data
1506756547761:# fit model
1506756547763:formula2 <- formula(
1506756547765:num_trips ~ 1 +
1506756547766:weekday1 +
1506756547767:mean_temperature_f +
1506756547767:mean_visibility_miles +
1506756547768:cloud_cover +
1506756547769:`eventsFog-Rain` +
1506756547770:eventsNone +
1506756547771:eventsRain +
1506756547772:`eventsRain-Thunderstorm`)
1506756557555:weather_frame <- model.matrix(formula1, weather) %>% as.tibble()
1506756558120:fit <- lm(data = weather_frame %>%
1506756558121:mutate(num_trips = weather$num_trips), formula2)
1506756558702:summary(fit)
1506756560722:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506756561171:plot(fit)
1506756563346:# holiday may affect
1506756563349:weather %>%
1506756563350:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506756563351:geom_point(aes(shape = weekday, size = precipitation_in)) +
1506756563352:scale_color_brewer(palette = "Set1")
1506756564285:weather %>%
1506756564286:filter(weekday == "0", num_trips < 1000) %>%
1506756564286:select(pdt, num_trips)
1506756568107:holidaydates <- holidays(c(2015, 2016))
1506756568904:weather_holiday_adjust <- weather %>%
1506756568905:mutate(weekday = ifelse(
1506756568905:pdt %in% holidaydates, "1", weekday
1506756568906:))
1506756569617:l <- regsubsets(data = weather_holiday_adjust, formula1, nvmax = 15)
1506756570041:s <- summary(l)
1506756570490:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506756570491:# s$which
1506756570491:s$cp
1506756570984:s$which[which.min(s$cp),]
1506756572600:formula3 <- formula(
1506756572602:sqrt(num_trips) ~ 1 +
1506756572604:weekday1 +
1506756572605:mean_temperature_f +
1506756572607:mean_visibility_miles +
1506756572608:eventsRain +
1506756572609:`eventsRain-Thunderstorm`
1506756572609:)
1506756576232:weather_holiday_adjust_frame <-
1506756576233:model.matrix(formula1, weather_holiday_adjust) %>%
1506756576234:as.tibble()
1506756576684:fit_holiday_adjust <- lm(data = weather_holiday_adjust_frame %>%
1506756576685:mutate(num_trips = weather$num_trips),
1506756576686:formula = formula3)
1506756577338:summary(fit_holiday_adjust)
1506756577623:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506756578243:plot(fit_holiday_adjust)
1506756798282:# holiday may affect
1506756798283:weather %>%
1506756798285:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506756798287:geom_point(aes(shape = weekday, size = precipitation_in)) +
1506756798290:scale_color_brewer(palette = "Set1")
1506758680053:?ktable
1506758870500:library(DT)
1506759256851:station
1506759304854:xaringan::moon_reader("report/presentation/presentation.Rmd")
1506759360017:xaringan::moon_reader("report/presentation/presentation.html")
1506759380608:xaringan::inf_mr("report/presentation/presentation.Rmd")
1506759540935:?datatable
1506759690780:library(rmarkdown)
1506759705659:render("report/presentation/presentation.Rmd")
1506759719368:xaringan::inf_mr("report/presentation/presentation.Rmd")
1506761509031:s
1506761513211:1
1506761514036:s
1506761516606:1+1
1506761523231:hello
1506761638185:xaringan::inf_mr("report/presentation/presentation.Rmd")
1506790370754:head(str(weather))
1506790385727:str(weather)[1:4]
1506790388400:str(weather)
1506790401520:head(glimpse(weather))
1506790414322:weather %>% glimpse %>% class
1506790468650:ktable
1506790471254:?ktable
1506790520394:source('~/Documents/Harrisburg/500_52/Project/bay_area_bike_share/src/Regression.R')
1506790536901:source('~/Documents/Harrisburg/500_52/Project/bay_area_bike_share/src/EDA.R')
1506790572126:source('~/Documents/Harrisburg/500_52/Project/bay_area_bike_share/src/Regression.R')
1506790593189:fit
1506790660341:summary(fit_holiday_adjust)
1506790666024:formula3 <- formula(
1506790666025:sqrt(num_trips) ~ 1 +
1506790666025:weekday1 +
1506790666026:mean_temperature_f +
1506790666026:mean_visibility_miles +
1506790666027:eventsRain +
1506790666027:`eventsRain-Thunderstorm`
1506790666028:)
1506790667190:weather_holiday_adjust_frame <-
1506790667191:model.matrix(formula1, weather_holiday_adjust) %>%
1506790667191:as.tibble()
1506790674086:weather_holiday_adjust <- weather %>%
1506790674087:mutate(weekday = ifelse(
1506790674088:pdt %in% holidaydates, "1", weekday
1506790674089:))
1506790677285:holidaydates <- holidays(c(2015, 2016))
1506790712684:source('~/Documents/Harrisburg/500_52/Project/bay_area_bike_share/src/Regression.R')
1506790727104:fit_holiday_adjust
1506790740957:summary(fit_holiday_adjust)
1506790745784:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506790746521:plot(fit_holiday_adjust)
1506790857716:install.packages("ktable")
1506790861586:library(ktable)
1506790888923:install.packages("Kmisc")
1506790897007:library(Kmisc)
1506791014942:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1506791052023:he
1506791053862:ls
1506791056104:arrow
1506791068217:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1506791112049:library(knitr)
1506791167138:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1506793284595:?xaringan::moon_reader
1506793415269:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1506793420105:ls
1506794291833:.libPaths()
1506794315247:dir(.libPaths())
1506794364895:.libPaths()
1506794685920:xaringan:::inf_mr()
1506794704485:quit
1506794762210:source("src/Regression.R")
1506794794797:xaringan::inf_mr("report/presentation/presentation.Rmd")
1506795530199:quit
1506795608758:xaringan::inf_mr("report/presentation/presentation.Rmd")
1506795713675:xaringan::moon_reader("report/presentation/presentation.Rmd")
1506795720847:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1506795919387:source("src/Regression.R")
1506796111572:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1506805472132:install.packages("ggmap")
1506805491560:library(ggmap)
1506805570562:mapImageData2 <- get_map(location = c(lon = -0.016179, lat = 51.538525),
1506805570586:color = "color",
1506805570587:source = "google",
1506805570588:maptype = "terrain",
1506805570589:zoom = 16)
1506805573615:ggmap(mapImageData2,
1506805573616:extent = "device",
1506805573617:ylab = "Latitude",
1506805573617:xlab = "Longitude")
1506805717519:qmap("New York")
1506805756031:qmap("San Francisco")
1506805856080:mapImageData2 <- get_map(location = c(lon = -0.016179, lat = 51.538525),
1506805856083:color = "color",
1506805856084:source = "google",
1506805856085:maptype = "terrain",
1506805856085:zoom = 16)
1506805857981:ggmap(mapImageData2,
1506805857981:extent = "device",
1506805857982:ylab = "Latitude",
1506805857983:xlab = "Longitude")
1506805865392:mapImageData2 <- get_map(location = c(lon = -0.016179, lat = 51.538525),
1506805865393:color = "color",
1506805865394:source = "google",
1506805865395:maptype = "terrain",
1506805865396:zoom = 16)
1506805867136:ggmap(mapImageData2,
1506805867137:extent = "device",
1506805867137:ylab = "Latitude",
1506805867138:xlab = "Longitude") ggplot(trip_san_jose) +
1506805867138:geom_segment(aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506805867139:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506805867139:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506805867139:geom_text_repel(data=station_san_jose,
1506805867140:aes(x=long, y=lat, label=name), size=4) +
1506805867140:theme_light(base_size=10) +
1506805867141:xlab("") +
1506805867141:ylab("") +
1506805867142:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506805867142:limits=c(0, max(trip_san_jose$num_trip)),
1506805867143:name="Number of Trips") +
1506805867143:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506805867144:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506805867144:coord_fixed()
1506805945941:MapBayArea <- get_map(location = c(mean(stations$long),mean(stations$lat)), zoom = 10, color = "bw")
1506805957790:MapBayArea <- get_map(location = c(mean(station$long),mean(station$lat)), zoom = 10, color = "bw")
1506805989130:?get_map
1506806017948:station$long
1506806029167:#   ____________________________________________________________________________
1506806029169:#   Read data                                                               ####
1506806029171:station <- read_csv("data/201608_station_data.csv")
1506806030490:station <- station %>%
1506806030490:mutate(installation = mdy(installation)) %>%
1506806030491:arrange(station_id)
1506806031450:colnames(station) <- c("id","name","lat","long","dock_count","city","installation_date")
1506806034248:station
1506806046623:#   ____________________________________________________________________________
1506806046624:#   Read data                                                               ####
1506806046624:station <- read_csv("data/201608_station_data.csv")
1506806046878:station <- station %>%
1506806046878:mutate(installation = mdy(installation)) %>%
1506806046879:arrange(station_id) %>%
1506806046880:na.omit
1506806047212:colnames(station) <- c("id","name","lat","long","dock_count","city","installation_date")
1506806052076:MapBayArea <- get_map(location = c(mean(station$long),mean(station$lat)), zoom = 10, color = "bw")
1506806095304:gmap(MapBayArea, extent = "device", ylab = "Latitude", xlab = "Longitude",darken = 0.75) +
1506806095306:geom_segment(aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806095306:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806095307:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806095308:geom_text_repel(data=station_san_jose,
1506806095309:aes(x=long, y=lat, label=name), size=4) +
1506806095311:theme_light(base_size=10) +
1506806095311:xlab("") +
1506806095312:ylab("") +
1506806095313:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806095315:limits=c(0, max(trip_san_jose$num_trip)),
1506806095317:name="Number of Trips") +
1506806095320:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806095321:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806095322:coord_fixed()
1506806102121:ggmap(MapBayArea, extent = "device", ylab = "Latitude", xlab = "Longitude",darken = 0.75) +
1506806102122:geom_segment(aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806102122:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806102123:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806102123:geom_text_repel(data=station_san_jose,
1506806102124:aes(x=long, y=lat, label=name), size=4) +
1506806102124:theme_light(base_size=10) +
1506806102126:xlab("") +
1506806102127:ylab("") +
1506806102128:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806102129:limits=c(0, max(trip_san_jose$num_trip)),
1506806102129:name="Number of Trips") +
1506806102130:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806102131:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806102132:coord_fixed()
1506806120288:ggmap(MapBayArea, extent = "device", ylab = "Latitude", xlab = "Longitude",darken = 0.75)
1506806156800:ggmap(MapBayArea, extent = "device", ylab = "Latitude", xlab = "Longitude",darken = 0.75) +
1506806156802:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806156803:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806156805:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806156807:geom_text_repel(data=station_san_jose,
1506806156808:aes(x=long, y=lat, label=name), size=4) +
1506806156809:theme_light(base_size=10) +
1506806156810:xlab("") +
1506806156811:ylab("") +
1506806156811:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806156812:limits=c(0, max(trip_san_jose$num_trip)),
1506806156813:name="Number of Trips") +
1506806156815:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806156816:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806156817:coord_fixed()
1506806201784:station_san_jose
1506806210055:MapBayArea <- get_map(location = c(mean(station_san_jose$long),mean(station_san_jose$lat)), zoom = 10, color = "bw")
1506806214019:ggmap(MapBayArea, extent = "device", ylab = "Latitude", xlab = "Longitude",darken = 0.75) +
1506806214020:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806214022:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806214023:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806214023:geom_text_repel(data=station_san_jose,
1506806214024:aes(x=long, y=lat, label=name), size=4) +
1506806214025:theme_light(base_size=10) +
1506806214025:xlab("") +
1506806214026:ylab("") +
1506806214026:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806214027:limits=c(0, max(trip_san_jose$num_trip)),
1506806214027:name="Number of Trips") +
1506806214028:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806214028:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806214029:coord_fixed()
1506806231803:ggmap(MapBayArea, extent = "device", ylab = "Latitude", xlab = "Longitude",darken = 0.25) +
1506806231804:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806231805:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806231805:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806231806:geom_text_repel(data=station_san_jose,
1506806231807:aes(x=long, y=lat, label=name), size=4) +
1506806231808:theme_light(base_size=10) +
1506806231809:xlab("") +
1506806231810:ylab("") +
1506806231812:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806231814:limits=c(0, max(trip_san_jose$num_trip)),
1506806231816:name="Number of Trips") +
1506806231817:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806231818:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806231819:coord_fixed()
1506806284935:ggmap(MapBayArea, extent = "device", ylab = "Latitude", xlab = "Longitude",darken = 0.25, zoom = 13) +
1506806284938:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806284940:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806284944:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806284947:geom_text_repel(data=station_san_jose,
1506806284948:aes(x=long, y=lat, label=name), size=4) +
1506806284949:theme_light(base_size=10) +
1506806284950:xlab("") +
1506806284951:ylab("") +
1506806284952:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806284953:limits=c(0, max(trip_san_jose$num_trip)),
1506806284954:name="Number of Trips") +
1506806284955:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806284956:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806284958:coord_fixed()
1506806293255:ggmap(MapBayArea, extent = "device", ylab = "Latitude", xlab = "Longitude",darken = 0.25, zoom = 19) +
1506806293256:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806293257:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806293257:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806293258:geom_text_repel(data=station_san_jose,
1506806293258:aes(x=long, y=lat, label=name), size=4) +
1506806293260:theme_light(base_size=10) +
1506806293261:xlab("") +
1506806293263:ylab("") +
1506806293264:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806293266:limits=c(0, max(trip_san_jose$num_trip)),
1506806293267:name="Number of Trips") +
1506806293268:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806293269:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806293270:coord_fixed()
1506806304429:ggmap(MapBayArea, extent = "device", ylab = "Latitude", xlab = "Longitude",darken = 0.25, zoom = 149) +
1506806304430:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806304431:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806304432:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806304432:geom_text_repel(data=station_san_jose,
1506806304433:aes(x=long, y=lat, label=name), size=4) +
1506806304434:theme_light(base_size=10) +
1506806304435:xlab("") +
1506806304436:ylab("") +
1506806304436:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806304437:limits=c(0, max(trip_san_jose$num_trip)),
1506806304438:name="Number of Trips") +
1506806304439:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806304441:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806304442:coord_fixed()
1506806374192:?ggmap
1506806394631:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0.25, zoom = 149) +
1506806394633:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806394635:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806394636:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806394637:geom_text_repel(data=station_san_jose,
1506806394637:aes(x=long, y=lat, label=name), size=4) +
1506806394638:theme_light(base_size=10) +
1506806394639:xlab("") +
1506806394640:ylab("") +
1506806394641:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806394641:limits=c(0, max(trip_san_jose$num_trip)),
1506806394644:name="Number of Trips") +
1506806394646:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806394647:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806394648:coord_fixed()
1506806440693:MapBayArea <- get_map(location = c(mean(station_san_jose$long),mean(station_san_jose$lat)), zoom = 21, color = "bw")
1506806443703:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0.25) +
1506806443704:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806443705:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806443706:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806443708:geom_text_repel(data=station_san_jose,
1506806443710:aes(x=long, y=lat, label=name), size=4) +
1506806443712:theme_light(base_size=10) +
1506806443712:xlab("") +
1506806443713:ylab("") +
1506806443714:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806443715:limits=c(0, max(trip_san_jose$num_trip)),
1506806443716:name="Number of Trips") +
1506806443717:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806443717:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806443718:coord_fixed()
1506806451912:MapBayArea <- get_map(location = c(mean(station_san_jose$long),mean(station_san_jose$lat)), zoom = 15, color = "bw")
1506806454398:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0.25) +
1506806454399:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806454399:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806454400:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806454400:geom_text_repel(data=station_san_jose,
1506806454401:aes(x=long, y=lat, label=name), size=4) +
1506806454401:theme_light(base_size=10) +
1506806454402:xlab("") +
1506806454402:ylab("") +
1506806454403:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806454403:limits=c(0, max(trip_san_jose$num_trip)),
1506806454404:name="Number of Trips") +
1506806454405:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806454405:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806454406:coord_fixed()
1506806505179:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0) +
1506806505180:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806505182:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806505184:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806505185:geom_text_repel(data=station_san_jose,
1506806505187:aes(x=long, y=lat, label=name), size=4) +
1506806505188:theme_light(base_size=10) +
1506806505189:xlab("") +
1506806505189:ylab("") +
1506806505190:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806505192:limits=c(0, max(trip_san_jose$num_trip)),
1506806505193:name="Number of Trips") +
1506806505194:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806505196:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806505198:coord_fixed()
1506806508708:station_san_jose
1506806605590:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0) +
1506806605592:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806605593:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806605594:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806605595:geom_text_repel(data=station_san_jose,
1506806605595:aes(x=long, y=lat, label=name), size=4) +
1506806605596:theme_light(base_size=10) +
1506806605598:theme(legend.position = "bottom") +
1506806605599:xlab("") +
1506806605600:ylab("") +
1506806605601:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806605602:limits=c(0, max(trip_san_jose$num_trip)),
1506806605614:name="Number of Trips") +
1506806605616:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806605617:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806605619:coord_fixed()
1506806652686:MapBayArea <- get_map(location = c(mean(station_san_jose$long)+ 0.005,mean(station_san_jose$lat)), zoom = 15, color = "bw")
1506806655404:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0) +
1506806655405:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806655406:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806655406:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806655407:geom_text_repel(data=station_san_jose,
1506806655408:aes(x=long, y=lat, label=name), size=4) +
1506806655409:theme_light(base_size=10) +
1506806655410:theme(legend.position = "bottom") +
1506806655411:xlab("") +
1506806655412:ylab("") +
1506806655413:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806655414:limits=c(0, max(trip_san_jose$num_trip)),
1506806655416:name="Number of Trips") +
1506806655419:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806655420:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806655421:coord_fixed()
1506806673856:MapBayArea <- get_map(location = c(mean(station_san_jose$long),mean(station_san_jose$lat)), zoom = 15, color = "bw")
1506806676131:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0) +
1506806676132:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806676133:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806676133:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806676134:geom_text_repel(data=station_san_jose,
1506806676135:aes(x=long, y=lat, label=name), size=4) +
1506806676135:theme_light(base_size=10) +
1506806676136:theme(legend.position = "bottom") +
1506806676136:xlab("") +
1506806676137:ylab("") +
1506806676137:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806676138:limits=c(0, max(trip_san_jose$num_trip)),
1506806676138:name="Number of Trips") +
1506806676139:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806676139:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806676140:coord_fixed()
1506806685915:MapBayArea <- get_map(location = c(mean(station_san_jose$long),mean(station_san_jose$lat)), zoom = 14, color = "bw")
1506806688104:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0) +
1506806688104:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806688106:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806688107:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806688108:geom_text_repel(data=station_san_jose,
1506806688109:aes(x=long, y=lat, label=name), size=4) +
1506806688110:theme_light(base_size=10) +
1506806688110:theme(legend.position = "bottom") +
1506806688111:xlab("") +
1506806688111:ylab("") +
1506806688112:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806688113:limits=c(0, max(trip_san_jose$num_trip)),
1506806688113:name="Number of Trips") +
1506806688114:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806688115:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806688116:coord_fixed()
1506806743929:MapBayArea <- get_map(location = c(mean(station_san_jose$long) ,mean(station_san_jose$lat)), zoom = 14.5, color = "bw")
1506806753369:MapBayArea <- get_map(location = c(mean(station_san_jose$long) ,mean(station_san_jose$lat)), zoom = "auto", color = "bw")
1506806755905:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0) +
1506806755907:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806755909:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806755910:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806755912:geom_text_repel(data=station_san_jose,
1506806755913:aes(x=long, y=lat, label=name), size=4) +
1506806755913:theme_light(base_size=10) +
1506806755914:theme(legend.position = "bottom") +
1506806755915:xlab("") +
1506806755915:ylab("") +
1506806755916:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806755917:limits=c(0, max(trip_san_jose$num_trip)),
1506806755918:name="Number of Trips") +
1506806755919:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806755919:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806755920:coord_fixed()
1506806769811:MapBayArea <- get_map(location = c(mean(station_san_jose$long) ,mean(station_san_jose$lat)), zoom = 14, color = "bw")
1506806777038:MapBayArea <- get_map(location = c(mean(station_san_jose$long)+0.01 ,mean(station_san_jose$lat)), zoom = 14, color = "bw")
1506806778815:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0) +
1506806778816:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806778816:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806778817:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806778818:geom_text_repel(data=station_san_jose,
1506806778818:aes(x=long, y=lat, label=name), size=4) +
1506806778819:theme_light(base_size=10) +
1506806778819:theme(legend.position = "bottom") +
1506806778820:xlab("") +
1506806778820:ylab("") +
1506806778821:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806778821:limits=c(0, max(trip_san_jose$num_trip)),
1506806778822:name="Number of Trips") +
1506806778823:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806778823:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806778824:coord_fixed()
1506806851025:MapBayArea <- get_map(location = c(mean(station_san_jose$long)+0.01 ,mean(station_san_jose$lat)), zoom = 15)
1506806854120:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0) +
1506806854120:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806854121:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806854121:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806854122:geom_text_repel(data=station_san_jose,
1506806854122:aes(x=long, y=lat, label=name), size=4) +
1506806854123:theme_light(base_size=10) +
1506806854123:theme(legend.position = "bottom") +
1506806854124:xlab("") +
1506806854124:ylab("") +
1506806854125:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806854125:limits=c(0, max(trip_san_jose$num_trip)),
1506806854126:name="Number of Trips") +
1506806854126:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806854127:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806854127:coord_fixed()
1506806865958:MapBayArea <- get_map(location = c(mean(station_san_jose$long) ,mean(station_san_jose$lat)), zoom = 15)
1506806868149:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0) +
1506806868150:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506806868151:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506806868151:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506806868152:geom_text_repel(data=station_san_jose,
1506806868152:aes(x=long, y=lat, label=name), size=4) +
1506806868153:theme_light(base_size=10) +
1506806868153:theme(legend.position = "bottom") +
1506806868154:xlab("") +
1506806868154:ylab("") +
1506806868155:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506806868155:limits=c(0, max(trip_san_jose$num_trip)),
1506806868156:name="Number of Trips") +
1506806868157:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806868158:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506806868159:coord_fixed()
1506807002522:MapBayArea <- get_map(location = c(mean(station_san_jose$long) ,mean(station_san_jose$lat)), zoom = 14)
1506807026763:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0) +
1506807026773:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506807026776:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506807026780:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506807026786:geom_text_repel(data=station_san_jose,
1506807026787:aes(x=long, y=lat, label=name), size=4) +
1506807026788:theme_light(base_size=10) +
1506807026789:theme(legend.position = "bottom") +
1506807026790:xlab("") +
1506807026791:ylab("") +
1506807026792:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506807026793:limits=c(0, max(trip_san_jose$num_trip)),
1506807026794:name="Number of Trips") +
1506807026795:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506807026796:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506807026796:coord_fixed()
1506807161321:?geom_text_repel
1506807216709:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0) +
1506807216712:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506807216713:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506807216714:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506807216715:geom_text_repel(data=station_san_jose, segment.color = "red",
1506807216715:aes(x=long, y=lat, label=name), size=4) +
1506807216716:theme_light(base_size=10) +
1506807216717:theme(legend.position = "bottom") +
1506807216718:xlab("") +
1506807216719:ylab("") +
1506807216719:scale_colour_gradientn(colors=c("#dddddd", "#00b4ff"),
1506807216720:limits=c(0, max(trip_san_jose$num_trip)),
1506807216722:name="Number of Trips") +
1506807216724:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506807216725:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506807216726:coord_fixed()
1506807336453:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0) +
1506807336458:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506807336460:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506807336461:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506807336464:geom_text_repel(data=station_san_jose,
1506807336468:aes(x=long, y=lat, label=name), size=4) +
1506807336472:theme_light(base_size=10) +
1506807336474:theme(legend.position = "bottom") +
1506807336475:xlab("") +
1506807336476:ylab("") +
1506807336478:scale_colour_gradientn(colors=c("#dddddd", "#002ba3"),
1506807336480:limits=c(0, max(trip_san_jose$num_trip)),
1506807336482:name="Number of Trips") +
1506807336483:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506807336484:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506807336485:coord_fixed()
1506807356823:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0.1) +
1506807356825:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506807356826:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506807356827:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506807356828:geom_text_repel(data=station_san_jose,
1506807356829:aes(x=long, y=lat, label=name), size=4) +
1506807356829:theme_light(base_size=10) +
1506807356830:theme(legend.position = "bottom") +
1506807356831:xlab("") +
1506807356832:ylab("") +
1506807356832:scale_colour_gradientn(colors=c("#dddddd", "#002ba3"),
1506807356833:limits=c(0, max(trip_san_jose$num_trip)),
1506807356834:name="Number of Trips") +
1506807356835:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506807356836:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506807356838:coord_fixed()
1506819875772:g
1506819885109:ggmap(MapBayArea, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0.1) +
1506819885110:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506819885111:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506819885112:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506819885112:geom_text_repel(data=station_san_jose,
1506819885112:aes(x=long, y=lat, label=name), size=4) +
1506819885113:theme_light(base_size=10) +
1506819885114:theme(legend.position = "bottom") +
1506819885115:xlab("") +
1506819885115:ylab("") +
1506819885116:scale_colour_gradientn(colors=c("#dddddd", "#002ba3"),
1506819885117:limits=c(0, max(trip_san_jose$num_trip)),
1506819885117:name="Number of Trips") +
1506819885118:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506819885119:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506819885120:coord_fixed()
1506819907123:MapSanJose <- get_map(location = c(mean(station_san_jose$long) ,mean(station_san_jose$lat)), zoom = 14)
1506819919790:ggmap(MapSanJose, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0.1) +
1506819919792:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506819919793:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506819919795:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506819919796:geom_text_repel(data=station_san_jose,
1506819919798:aes(x=long, y=lat, label=name), size=4) +
1506819919801:theme_light(base_size=10) +
1506819919802:theme(legend.position = "bottom") +
1506819919804:xlab("") +
1506819919805:ylab("") +
1506819919806:scale_colour_gradientn(colors=c("#dddddd", "#002ba3"),
1506819919807:limits=c(0, max(trip_san_jose$num_trip)),
1506819919807:name="Number of Trips") +
1506819919808:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506819919809:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506819919809:coord_fixed()
1506820033790:station %>% count(city)
1506820064668:station_id_mountain_view <- station_in_city("Mountain View")
1506820091090:station_in_palo_alto <- station_in_city("Palo Alto")
1506820104919:station_id_san_francisco <- station_in_city("San Francisco")
1506820181307:MapSanFrancisco <- get_map(location = c(mean(station_id_san_francisco$long) ,mean(station_id_san_francisco$lat)), zoom = 14)
1506820234044:station_in_city("San Jose")
1506820243366:station_san_jose
1506821434908:# trip duration - in general
1506821434921:trip %>%
1506821434922:mutate(duration_minutes = duration/60) %>%
1506821434923:ggplot(aes(duration_minutes)) +
1506821434924:geom_histogram(bins = 60, fill = "white", color = "black") +
1506821434925:xlim(0,60) +
1506821434925:labs(x = "Minutes",
1506821434926:y = "Number of Trips",
1506821434927:title = "Trip Duration")
1506821441248:# trip duration - in general
1506821441248:trip %>%
1506821441250:mutate(duration_minutes = duration/60) %>%
1506821441252:ggplot(aes(duration_minutes)) +
1506821441253:geom_histogram(bins = 60, fill = "white", color = "black") +
1506821441256:xlim(0,60) +
1506821441257:labs(x = "Minutes",
1506821441259:y = "Number of Trips",
1506821441260:title = "Trip Duration")
1506821444625:# trip duration - facet: weekday
1506821444626:trip %>%
1506821444626:mutate(duration_minutes = duration/60,
1506821444627:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506821444627:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506821444628:ggplot(aes(duration_minutes)) +
1506821444628:geom_histogram(bins = 100, fill = "white", color = "black") +
1506821444629:xlim(0,100) +
1506821444629:labs(x = "Minutes",
1506821444630:y = "Number of Trips",
1506821444632:title = "Trip Duration by weekday") +
1506821444633:facet_wrap(~weekday, scales = "free", nrow = 2)
1506821445824:# mean trips duration ~ weekday
1506821445826:trip %>%
1506821445827:mutate(duration_minutes = duration/60,
1506821445827:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506821445828:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506821445828:group_by(day_of_week) %>%
1506821445829:summarise(mean_duration_minutes = mean(duration)/60) %>%
1506821445830:ggplot(aes(factor(day_of_week, weekdays(as.Date('1970-01-03') + 1:7)),
1506821445832:mean_duration_minutes)) +
1506821445833:geom_bar(stat = "identity", width = 0.5, fill = "white", color = "black") +
1506821445833:coord_flip() +
1506821445834:labs(x = "",
1506821445834:y = "Mean Trip Duration",
1506821445835:title = "Mean Trip Duration ~ Weekdays")
1506821446545:# stations in each city
1506821446545:station_id_san_jose <- station_in_city("San Jose")
1506821506349:station_san_jose <- station %>%
1506821506350:filter(city == "San Jose") %>%
1506821506352:left_join(trip_san_jose %>%
1506821506352:summarise(num_trip = sum(num_trip)),
1506821506353:by = c("id" = "start_station_id"))
1506821509574:# mean trips duration ~ weekday
1506821509575:trip %>%
1506821509576:mutate(duration_minutes = duration/60,
1506821509576:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506821509577:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506821509577:group_by(day_of_week) %>%
1506821509578:summarise(mean_duration_minutes = mean(duration)/60) %>%
1506821509579:ggplot(aes(factor(day_of_week, weekdays(as.Date('1970-01-03') + 1:7)),
1506821509579:mean_duration_minutes)) +
1506821509580:geom_bar(stat = "identity", width = 0.5, fill = "white", color = "black") +
1506821509580:coord_flip() +
1506821509581:labs(x = "",
1506821509581:y = "Mean Trip Duration",
1506821509582:title = "Mean Trip Duration ~ Weekdays")
1506821530304:source("src/Regression.R")
1506821616676:mapImageData2 <- get_map(location = c(lon = -0.016179, lat = 51.538525),
1506821616677:color = "color",
1506821616677:source = "google",
1506821616678:maptype = "terrain",
1506821616678:zoom = 16)
1506821616680:ggmap(mapImageData2,
1506821616680:extent = "device",
1506821616681:ylab = "Latitude",
1506821616681:xlab = "Longitude")
1506821621287:source("src/Regression.R")
1506821653738:# add trip stat_long and end_long
1506821653740:trip_san_jose <- trip %>%
1506821653741:filter(start_station_id %in% station_id_san_jose) %>%
1506821653741:filter(end_station_id %in% station_id_san_jose) %>%
1506821653742:group_by(start_station_id, end_station_id) %>%
1506821653742:summarise(num_trip = n()) %>%
1506821653743:left_join(station %>% select(id, lat, long),
1506821653743:by = c("start_station_id" = "id")) %>%
1506821653744:rename(start_long = long, start_lat = lat) %>%
1506821653744:left_join(station %>% select(id, lat, long),
1506821653745:by = c("end_station_id" = "id")) %>%
1506821653745:rename(end_long = long, end_lat = lat)
1506821658909:# theme(axis.line=element_blank(),
1506821658910:#       axis.text.x=element_blank(),
1506821658911:#       axis.text.y=element_blank(),
1506821658912:#       axis.ticks=element_blank(),
1506821658913:#       axis.title.x=element_blank(),
1506821658914:#       axis.title.y=element_blank(),
1506821658915:#       panel.grid=element_blank(),
1506821658916:#       panel.border=element_blank())
1506821658917:g
1506821663183:#   radius = ~ num_trip*0.02,
1506821663184:#   stroke = FALSE,
1506821663185:#   fillOpacity = 0.5,
1506821663185:#   label = ~ name
1506821663186:# ) %>%
1506821663187:# addPolylines(data = trip_san_jose,
1506821663189:#              lng = ~ as.vector(rbind(start_long, end_long)),
1506821663190:#              lat = ~ as.vector(rbind(start_lat, end_lat)),
1506821663191:#              color = "grey"
1506821663192:#                )
1506821663192:l
1506821941499:# using leaflet
1506821941500:l <-
1506821941501:leaflet(station) %>%
1506821941501:addTiles() %>%  # Add default OpenStreetMap map tiles
1506821941502:addMarkers(lng = ~ long, lat = ~ lat, label = ~ name,
1506821941503:weight = 3, radius=40,
1506821941504:color="#ffa500", stroke = TRUE, fillOpacity = 0.8)
1506821942099:#   radius = ~ num_trip*0.02,
1506821942100:#   stroke = FALSE,
1506821942101:#   fillOpacity = 0.5,
1506821942102:#   label = ~ name
1506821942102:# ) %>%
1506821942103:# addPolylines(data = trip_san_jose,
1506821942104:#              lng = ~ as.vector(rbind(start_long, end_long)),
1506821942105:#              lat = ~ as.vector(rbind(start_lat, end_lat)),
1506821942106:#              color = "grey"
1506821942107:#                )
1506821942108:l
1506821960812:# using leaflet
1506821960815:l <-
1506821960816:leaflet(station) %>%
1506821960816:addTiles() %>%  # Add default OpenStreetMap map tiles
1506821960817:addMarkers(lng = ~ long, lat = ~ lat, label = ~ name,
1506821960819:weight = 3, radius=40,
1506821960819:color="#ffa500", stroke = TRUE, fillOpacity = 0.8)
1506821974778:# using leaflet
1506821974779:l <-
1506821974780:leaflet(station) %>%
1506821974780:addTiles() %>%  # Add default OpenStreetMap map tiles
1506821974781:addMarkers(lng = ~ long, lat = ~ lat, label = ~ name,
1506821974781:weight = 3, radius=40)
1506821981714:# using leaflet
1506821981715:l <-
1506821981716:leaflet(station) %>%
1506821981717:addTiles() %>%  # Add default OpenStreetMap map tiles
1506821981717:addMarkers(lng = ~ long, lat = ~ lat, label = ~ name,
1506821981718:color="#ffa500", stroke = TRUE, fillOpacity = 0.8)
1506821995570:?addMarkers
1506822082861:# using leaflet
1506822082864:l <-
1506822082865:leaflet(station) %>%
1506822082867:addTiles('http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png', attribution='Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>') %>%
1506822082868:# addTiles() %>%  # Add default OpenStreetMap map tiles
1506822082868:addMarkers(lng = ~ long, lat = ~ lat, label = ~ name,
1506822082870:weight = 3, radius=40,
1506822082870:color="#ffa500", stroke = TRUE, fillOpacity = 0.8)
1506822103947:# using leaflet
1506822103948:l <-
1506822103949:leaflet(station) %>%
1506822103949:addTiles() %>%  # Add default OpenStreetMap map tiles
1506822103949:addCircles(lng = ~ long, lat = ~ lat, label = ~ name,
1506822103950:weight = 3, radius=40,
1506822103950:color="#ffa500", stroke = TRUE, fillOpacity = 0.8)
1506822105249:#   radius = ~ num_trip*0.02,
1506822105250:#   stroke = FALSE,
1506822105251:#   fillOpacity = 0.5,
1506822105251:#   label = ~ name
1506822105252:# ) %>%
1506822105252:# addPolylines(data = trip_san_jose,
1506822105252:#              lng = ~ as.vector(rbind(start_long, end_long)),
1506822105253:#              lat = ~ as.vector(rbind(start_lat, end_lat)),
1506822105253:#              color = "grey"
1506822105254:#                )
1506822105254:l
1506822117179:# using leaflet
1506822117180:l <-
1506822117181:leaflet(station) %>%
1506822117181:addTiles() %>%  # Add default OpenStreetMap map tiles
1506822117182:addCircles(lng = ~ long, lat = ~ lat, label = ~ name,
1506822117182:weight = 3, radius=40,
1506822117183:color="red", stroke = TRUE, fillOpacity = 0.8)
1506822117832:#   radius = ~ num_trip*0.02,
1506822117833:#   stroke = FALSE,
1506822117834:#   fillOpacity = 0.5,
1506822117834:#   label = ~ name
1506822117835:# ) %>%
1506822117835:# addPolylines(data = trip_san_jose,
1506822117835:#              lng = ~ as.vector(rbind(start_long, end_long)),
1506822117836:#              lat = ~ as.vector(rbind(start_lat, end_lat)),
1506822117837:#              color = "grey"
1506822117837:#                )
1506822117838:l
1506822136186:# using leaflet
1506822136187:l <-
1506822136188:leaflet(station) %>%
1506822136188:addTiles() %>%  # Add default OpenStreetMap map tiles
1506822136189:addCircles(lng = ~ long, lat = ~ lat, label = ~ name,
1506822136190:weight = 3, radius=100,
1506822136191:color="black", stroke = TRUE, fillOpacity = 0.8)
1506822138971:#   radius = ~ num_trip*0.02,
1506822138972:#   stroke = FALSE,
1506822138972:#   fillOpacity = 0.5,
1506822138972:#   label = ~ name
1506822138973:# ) %>%
1506822138973:# addPolylines(data = trip_san_jose,
1506822138974:#              lng = ~ as.vector(rbind(start_long, end_long)),
1506822138974:#              lat = ~ as.vector(rbind(start_lat, end_lat)),
1506822138975:#              color = "grey"
1506822138975:#                )
1506822138975:l
1506822193984:# using leaflet
1506822193986:l <-
1506822193986:leaflet(station) %>%
1506822193987:addTiles() %>%  # Add default OpenStreetMap map tiles
1506822193987:addCircles(lng = ~ long, lat = ~ lat, label = ~ name,
1506822193987:weight = 3, radius=150,
1506822193988:color="black", stroke = F, fillOpacity = 0.8)
1506822194174:#   radius = ~ num_trip*0.02,
1506822194175:#   stroke = FALSE,
1506822194176:#   fillOpacity = 0.5,
1506822194177:#   label = ~ name
1506822194179:# ) %>%
1506822194180:# addPolylines(data = trip_san_jose,
1506822194181:#              lng = ~ as.vector(rbind(start_long, end_long)),
1506822194182:#              lat = ~ as.vector(rbind(start_lat, end_lat)),
1506822194182:#              color = "grey"
1506822194183:#                )
1506822194183:l
1506822230373:# using leaflet
1506822230374:l <-
1506822230375:leaflet(station) %>%
1506822230376:addTiles() %>%  # Add default OpenStreetMap map tiles
1506822230376:addCircles(lng = ~ long, lat = ~ lat, label = ~ name,
1506822230377:weight = 10, radius=150,
1506822230378:color="black", stroke = F, fillOpacity = 0.8)
1506822230603:#   radius = ~ num_trip*0.02,
1506822230604:#   stroke = FALSE,
1506822230605:#   fillOpacity = 0.5,
1506822230606:#   label = ~ name
1506822230607:# ) %>%
1506822230608:# addPolylines(data = trip_san_jose,
1506822230609:#              lng = ~ as.vector(rbind(start_long, end_long)),
1506822230609:#              lat = ~ as.vector(rbind(start_lat, end_lat)),
1506822230610:#              color = "grey"
1506822230611:#                )
1506822230611:l
1506822262187:# using leaflet
1506822262188:l <-
1506822262189:leaflet(station) %>%
1506822262190:addTiles() %>%  # Add default OpenStreetMap map tiles
1506822262192:addCircles(lng = ~ long, lat = ~ lat, label = ~ name,
1506822262193:weight = 10, radius=150,
1506822262194:color="black", stroke = F, fillOpacity = 1)
1506822262504:#   radius = ~ num_trip*0.02,
1506822262505:#   stroke = FALSE,
1506822262506:#   fillOpacity = 0.5,
1506822262508:#   label = ~ name
1506822262509:# ) %>%
1506822262510:# addPolylines(data = trip_san_jose,
1506822262510:#              lng = ~ as.vector(rbind(start_long, end_long)),
1506822262511:#              lat = ~ as.vector(rbind(start_lat, end_lat)),
1506822262511:#              color = "grey"
1506822262512:#                )
1506822262512:l
1506822291855:# addCircles(lng = ~ long, lat = ~ lat, label = ~ name,
1506822291857:#            weight = 10, radius=150,
1506822291858:#            color="black", stroke = F, fillOpacity = 1)
1506822293521:# using leaflet
1506822293522:l <-
1506822293523:leaflet(station) %>%
1506822293523:addTiles() %>%  # Add default OpenStreetMap map tiles
1506822293525:# addCircles(lng = ~ long, lat = ~ lat, label = ~ name,
1506822293526:#            weight = 10, radius=150,
1506822293527:#            color="black", stroke = F, fillOpacity = 1)
1506822293528:addCircleMarkers(
1506822293530:radius = ~ num_trip*0.02,
1506822293531:stroke = FALSE,
1506822293532:fillOpacity = 0.5,
1506822293533:label = ~ name
1506822293533:) %>%
1506822293534:addPolylines(data = trip_san_jose,
1506822293535:lng = ~ as.vector(rbind(start_long, end_long)),
1506822293536:lat = ~ as.vector(rbind(start_lat, end_lat)),
1506822293537:color = "grey"
1506822293537:)
1506822306570:# using leaflet
1506822306570:l <-
1506822306571:leaflet(station) %>%
1506822306571:addTiles() %>%  # Add default OpenStreetMap map tiles
1506822306572:# addCircles(lng = ~ long, lat = ~ lat, label = ~ name,
1506822306572:#            weight = 10, radius=150,
1506822306572:#            color="black", stroke = F, fillOpacity = 1)
1506822306573:addCircleMarkers(
1506822306573:radius = ~ num_trip*0.02,
1506822306573:stroke = FALSE,
1506822306574:fillOpacity = 0.5,
1506822306574:label = ~ name)
1506822315570:# using leaflet
1506822315571:l <-
1506822315573:leaflet(station) %>%
1506822315574:addTiles() %>%  # Add default OpenStreetMap map tiles
1506822315575:addCircles(lng = ~ long, lat = ~ lat, label = ~ name,
1506822315575:weight = 10, radius=1500,
1506822315576:color="black", stroke = F, fillOpacity = 1)
1506822317493:#   radius = ~ num_trip*0.02,
1506822317494:#   stroke = FALSE,
1506822317494:#   fillOpacity = 0.5,
1506822317495:#   label = ~ name
1506822317495:# ) %>%
1506822317496:# addPolylines(data = trip_san_jose,
1506822317496:#              lng = ~ as.vector(rbind(start_long, end_long)),
1506822317496:#              lat = ~ as.vector(rbind(start_lat, end_lat)),
1506822317497:#              color = "grey"
1506822317497:#                )
1506822317498:l
1506822325507:# using leaflet
1506822325507:l <-
1506822325508:leaflet(station) %>%
1506822325508:addTiles() %>%  # Add default OpenStreetMap map tiles
1506822325509:addCircles(lng = ~ long, lat = ~ lat, label = ~ name,
1506822325510:weight = 10, radius=300,
1506822325510:color="black", stroke = F, fillOpacity = 1)
1506822326147:#   radius = ~ num_trip*0.02,
1506822326149:#   stroke = FALSE,
1506822326150:#   fillOpacity = 0.5,
1506822326151:#   label = ~ name
1506822326152:# ) %>%
1506822326153:# addPolylines(data = trip_san_jose,
1506822326154:#              lng = ~ as.vector(rbind(start_long, end_long)),
1506822326155:#              lat = ~ as.vector(rbind(start_lat, end_lat)),
1506822326155:#              color = "grey"
1506822326156:#                )
1506822326156:l
1506822359584:# using leaflet
1506822359586:l <-
1506822359587:leaflet(station) %>%
1506822359588:addTiles() %>%  # Add default OpenStreetMap map tiles
1506822359590:addMarkers(lng = ~ long, lat = ~ lat, label = ~ name)
1506822359872:#   radius = ~ num_trip*0.02,
1506822359874:#   stroke = FALSE,
1506822359875:#   fillOpacity = 0.5,
1506822359876:#   label = ~ name
1506822359877:# ) %>%
1506822359877:# addPolylines(data = trip_san_jose,
1506822359878:#              lng = ~ as.vector(rbind(start_long, end_long)),
1506822359878:#              lat = ~ as.vector(rbind(start_lat, end_lat)),
1506822359878:#              color = "grey"
1506822359879:#                )
1506822359879:l
1506822383457:# theme(axis.line=element_blank(),
1506822383458:#       axis.text.x=element_blank(),
1506822383458:#       axis.text.y=element_blank(),
1506822383459:#       axis.ticks=element_blank(),
1506822383460:#       axis.title.x=element_blank(),
1506822383461:#       axis.title.y=element_blank(),
1506822383462:#       panel.grid=element_blank(),
1506822383464:#       panel.border=element_blank())
1506822383465:g
1506822391640:ggmap(MapSanJose, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0.1) +
1506822391641:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506822391642:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506822391642:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506822391644:geom_text_repel(data=station_san_jose,
1506822391645:aes(x=long, y=lat, label=name), size=4) +
1506822391647:theme_light(base_size=10) +
1506822391649:theme(legend.position = "bottom") +
1506822391650:xlab("") +
1506822391650:ylab("") +
1506822391651:scale_colour_gradientn(colors=c("#dddddd", "#002ba3"),
1506822391653:limits=c(0, max(trip_san_jose$num_trip)),
1506822391654:name="Number of Trips") +
1506822391655:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506822391655:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506822391656:coord_fixed()
1506822395813:MapSanJose <- get_map(location = c(mean(station_san_jose$long) ,mean(station_san_jose$lat)), zoom = 14)
1506822398889:MapSanFrancisco <- get_map(location = c(mean(station_id_san_francisco$long) ,mean(station_id_san_francisco$lat)), zoom = 14)
1506822398992:ggmap(MapSanJose, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0.1) +
1506822398992:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506822398993:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506822398994:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506822398994:geom_text_repel(data=station_san_jose,
1506822398995:aes(x=long, y=lat, label=name), size=4) +
1506822398996:theme_light(base_size=10) +
1506822398996:theme(legend.position = "bottom") +
1506822398997:xlab("") +
1506822398997:ylab("") +
1506822398998:scale_colour_gradientn(colors=c("#dddddd", "#002ba3"),
1506822398998:limits=c(0, max(trip_san_jose$num_trip)),
1506822398999:name="Number of Trips") +
1506822398999:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506822399000:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506822399000:coord_fixed()
1506822557904:mapImageData2 <- get_map(location = c(lon = -0.016179, lat = 51.538525),
1506822557907:color = "color",
1506822557908:source = "google",
1506822557908:maptype = "terrain",
1506822557909:zoom = 16)
1506822560844:ggmap(mapImageData2,
1506822560845:extent = "device",
1506822560855:ylab = "Latitude",
1506822560855:xlab = "Longitude")
1506823256915:# number of trips by day
1506823256916:trip %>%
1506823256917:as_tbl_time(index = start_date) %>%
1506823256918:time_summarise(period = "daily",
1506823256919:num_trips = n()) %>%
1506823256920:mutate(day_of_week = start_date %>% strftime("%A"),
1506823256921:week_nr = start_date %>% strftime("%W"),
1506823256921:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506823256922:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506823256923:ggplot(aes(start_date, num_trips, color = weekday)) +
1506823256924:geom_point() +
1506823256924:geom_smooth()+
1506823256926:labs(x = "Date",
1506823256930:y = "Total Number of Bicycle Trips",
1506823256939:title = "Trips Each Day")
1506823275043:# number of trips by day
1506823275044:trip %>%
1506823275045:as_tbl_time(index = start_date) %>%
1506823275045:time_summarise(period = "daily",
1506823275046:num_trips = n()) %>%
1506823275046:mutate(day_of_week = start_date %>% strftime("%A"),
1506823275047:week_nr = start_date %>% strftime("%W"),
1506823275047:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506823275048:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506823275048:ggplot(aes(start_date, num_trips, color = weekday)) +
1506823275049:geom_point() +
1506823275050:# geom_smooth()+
1506823275051:labs(x = "Date",
1506823275051:y = "Total Number of Bicycle Trips",
1506823275052:title = "Trips Each Day")
1506823293696:# number of trips by day
1506823293698:p1 <- trip %>%
1506823293699:as_tbl_time(index = start_date) %>%
1506823293700:time_summarise(period = "daily",
1506823293702:num_trips = n()) %>%
1506823293702:mutate(day_of_week = start_date %>% strftime("%A"),
1506823293703:week_nr = start_date %>% strftime("%W"),
1506823293704:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506823293705:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506823293705:ggplot(aes(start_date, num_trips, color = weekday)) +
1506823293706:geom_point() +
1506823293706:# geom_smooth()+
1506823293707:labs(x = "Date",
1506823293708:y = "Total Number of Bicycle Trips",
1506823293709:title = "Trips Each Day")
1506823545442:# number of trips by week days
1506823545444:p2 <- trip %>%
1506823545446:mutate(day = wday(start_date, label = T, abbr = F)) %>%
1506823545447:count(day) %>%
1506823545448:ggplot(aes(day, n)) +
1506823545449:geom_bar(stat = "identity") +
1506823545450:labs(x = "Week Day",
1506823545450:y = "Number of Trips",
1506823545451:title = "Number of Trips across a Week")
1506823599847:# number of trips in a day
1506823599848:trip %>%
1506823599849:mutate(time = hour(start_date) + minute(start_date)/60) %>%
1506823599851:ggplot(aes(time)) +
1506823599852:geom_histogram(bins = 12*60) +
1506823599853:geom_vline(xintercept = 9, color = 'orange')+
1506823599854:geom_vline(xintercept = 17, color = 'red', alpha = 0.7) +
1506823599855:annotate("text", x = 9, y = 0, label = "9:00 AM", color = "orange",
1506823599856:size = 7) +
1506823599857:annotate("text", x = 17, y = 0, label = "5:00 PM", color = "red",
1506823599859:size = 7) +
1506823599860:labs(x = "Daytime 24 Hour Clock",
1506823599862:y = "Number of Trips",
1506823599863:title = "Number of Trips in a day")
1506823604879:# number of trips by week days
1506823604880:p2 <- trip %>%
1506823604880:mutate(day = wday(start_date, label = T, abbr = F)) %>%
1506823604881:count(day) %>%
1506823604882:ggplot(aes(day, n)) +
1506823604883:geom_bar(stat = "identity") +
1506823604883:labs(x = "Week Day",
1506823604884:y = "Number of Trips",
1506823604886:title = "Number of Trips across a Week")
1506823608096:p2
1506823715793:# number of trips in a day
1506823715796:p3 <- trip %>%
1506823715797:mutate(time = hour(start_date) + minute(start_date)/60) %>%
1506823715798:ggplot(aes(time)) +
1506823715799:geom_histogram(bins = 12*60) +
1506823715800:geom_vline(xintercept = 9, color = 'orange')+
1506823715807:geom_vline(xintercept = 17, color = 'red', alpha = 0.7) +
1506823715808:annotate("text", x = 9, y = 0, label = "9:00 AM", color = "orange",
1506823715809:size = 7) +
1506823715810:annotate("text", x = 17, y = 0, label = "5:00 PM", color = "red",
1506823715811:size = 7) +
1506823715811:labs(x = "Daytime 24 Hour Clock",
1506823715812:y = "Number of Trips",
1506823715813:title = "Number of Trips in a day")
1506823716805:# number of trip in a day - facet: weekday
1506823716806:trip %>%
1506823716806:mutate(time = hour(start_date) + minute(start_date)/60,
1506823716807:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506823716808:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506823716808:ggplot(aes(time)) +
1506823716809:geom_histogram(bins = 12*60) +
1506823716809:labs(x = "Daytime 24 Hour Clock",
1506823716810:y = "Number of Trips",
1506823716812:title = "Number of Trips in a day") +
1506823716813:facet_wrap(~weekday, scales = "free")
1506823779440:# number of trip in a day - facet: weekday
1506823779441:p4 <- trip %>%
1506823779442:mutate(time = hour(start_date) + minute(start_date)/60,
1506823779444:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506823779444:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506823779445:ggplot(aes(time)) +
1506823779445:geom_histogram(bins = 12*60) +
1506823779446:labs(x = "Daytime 24 Hour Clock",
1506823779447:y = "Number of Trips",
1506823779448:title = "Number of Trips in a day") +
1506823779451:facet_wrap(~weekday, scales = "free")
1506823821492:# trip duration - in general
1506823821493:trip %>%
1506823821494:mutate(duration_minutes = duration/60) %>%
1506823821494:ggplot(aes(duration_minutes)) +
1506823821495:geom_histogram(bins = 60, fill = "white", color = "black") +
1506823821495:xlim(0,60) +
1506823821496:labs(x = "Minutes",
1506823821496:y = "Number of Trips",
1506823821496:title = "Trip Duration")
1506823829259:# number of trip in a day - facet: weekday
1506823829260:p4 <- trip %>%
1506823829260:mutate(time = hour(start_date) + minute(start_date)/60,
1506823829261:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506823829261:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506823829262:ggplot(aes(time)) +
1506823829262:geom_histogram(bins = 12*60) +
1506823829263:labs(x = "Daytime 24 Hour Clock",
1506823829263:y = "Number of Trips",
1506823829264:title = "Number of Trips in a day") +
1506823829264:facet_wrap(~weekday, scales = "free")
1506823832563:p4
1506823836483:# trip duration - in general
1506823836484:trip %>%
1506823836485:mutate(duration_minutes = duration/60) %>%
1506823836486:ggplot(aes(duration_minutes)) +
1506823836487:geom_histogram(bins = 60, fill = "white", color = "black") +
1506823836487:xlim(0,60) +
1506823836488:labs(x = "Minutes",
1506823836488:y = "Number of Trips",
1506823836489:title = "Trip Duration")
1506823838611:# trip duration - facet: weekday
1506823838611:trip %>%
1506823838612:mutate(duration_minutes = duration/60,
1506823838612:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506823838613:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506823838614:ggplot(aes(duration_minutes)) +
1506823838615:geom_histogram(bins = 100, fill = "white", color = "black") +
1506823838616:xlim(0,100) +
1506823838617:labs(x = "Minutes",
1506823838618:y = "Number of Trips",
1506823838620:title = "Trip Duration by weekday") +
1506823838622:facet_wrap(~weekday, scales = "free", nrow = 2)
1506823843647:# mean trips duration ~ weekday
1506823843648:trip %>%
1506823843648:mutate(duration_minutes = duration/60,
1506823843649:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506823843649:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506823843650:group_by(day_of_week) %>%
1506823843650:summarise(mean_duration_minutes = mean(duration)/60) %>%
1506823843652:ggplot(aes(factor(day_of_week, weekdays(as.Date('1970-01-03') + 1:7)),
1506823843653:mean_duration_minutes)) +
1506823843655:geom_bar(stat = "identity", width = 0.5, fill = "white", color = "black") +
1506823843656:coord_flip() +
1506823843658:labs(x = "",
1506823843659:y = "Mean Trip Duration",
1506823843660:title = "Mean Trip Duration ~ Weekdays")
1506823851036:# trip duration - facet: weekday
1506823851037:trip %>%
1506823851039:mutate(duration_minutes = duration/60,
1506823851040:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506823851042:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506823851043:ggplot(aes(duration_minutes)) +
1506823851044:geom_histogram(bins = 100, fill = "white", color = "black") +
1506823851044:xlim(0,100) +
1506823851045:labs(x = "Minutes",
1506823851045:y = "Number of Trips",
1506823851046:title = "Trip Duration by weekday") +
1506823851047:facet_wrap(~weekday, scales = "free", nrow = 2)
1506823875288:# trip duration - in general
1506823875289:trip %>%
1506823875290:mutate(duration_minutes = duration/60) %>%
1506823875290:ggplot(aes(duration_minutes)) +
1506823875290:geom_histogram(bins = 60, fill = "white", color = "black") +
1506823875291:xlim(0,60) +
1506823875291:labs(x = "Minutes",
1506823875292:y = "Number of Trips",
1506823875292:title = "Trip Duration")
1506823880629:# trip duration - facet: weekday
1506823880630:trip %>%
1506823880631:mutate(duration_minutes = duration/60,
1506823880631:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506823880632:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506823880632:ggplot(aes(duration_minutes)) +
1506823880633:geom_histogram(bins = 100, fill = "white", color = "black") +
1506823880633:xlim(0,100) +
1506823880634:labs(x = "Minutes",
1506823880635:y = "Number of Trips",
1506823880636:title = "Trip Duration by weekday") +
1506823880638:facet_wrap(~weekday, scales = "free", nrow = 2)
1506823884500:# mean trips duration ~ weekday
1506823884502:trip %>%
1506823884503:mutate(duration_minutes = duration/60,
1506823884505:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506823884507:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506823884508:group_by(day_of_week) %>%
1506823884508:summarise(mean_duration_minutes = mean(duration)/60) %>%
1506823884509:ggplot(aes(factor(day_of_week, weekdays(as.Date('1970-01-03') + 1:7)),
1506823884510:mean_duration_minutes)) +
1506823884511:geom_bar(stat = "identity", width = 0.5, fill = "white", color = "black") +
1506823884512:coord_flip() +
1506823884514:labs(x = "",
1506823884515:y = "Mean Trip Duration",
1506823884516:title = "Mean Trip Duration ~ Weekdays")
1506823906439:# trip duration - facet: weekday
1506823906441:p5 <- trip %>%
1506823906442:mutate(duration_minutes = duration/60,
1506823906443:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506823906443:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506823906444:ggplot(aes(duration_minutes)) +
1506823906444:geom_histogram(bins = 100, fill = "white", color = "black") +
1506823906445:xlim(0,100) +
1506823906445:labs(x = "Minutes",
1506823906446:y = "Number of Trips",
1506823906447:title = "Trip Duration by weekday") +
1506823906447:facet_wrap(~weekday, scales = "free", nrow = 2)
1506823906903:# mean trips duration ~ weekday
1506823906906:p6 <- trip %>%
1506823906906:mutate(duration_minutes = duration/60,
1506823906907:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506823906907:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506823906908:group_by(day_of_week) %>%
1506823906908:summarise(mean_duration_minutes = mean(duration)/60) %>%
1506823906909:ggplot(aes(factor(day_of_week, weekdays(as.Date('1970-01-03') + 1:7)),
1506823906909:mean_duration_minutes)) +
1506823906910:geom_bar(stat = "identity", width = 0.5, fill = "white", color = "black") +
1506823906910:coord_flip() +
1506823906911:labs(x = "",
1506823906912:y = "Mean Trip Duration",
1506823906912:title = "Mean Trip Duration ~ Weekdays")
1506824035068:install.packages("gridExtra")
1506824040580:library(gridExtra)
1506824054362:# trip duration - facet: weekday
1506824054363:p5 <- trip %>%
1506824054363:mutate(duration_minutes = duration/60,
1506824054364:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506824054364:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506824054365:ggplot(aes(duration_minutes)) +
1506824054365:geom_histogram(bins = 100, fill = "white", color = "black") +
1506824054366:xlim(0,100) +
1506824054366:labs(x = "Minutes",
1506824054367:y = "Number of Trips",
1506824054369:title = "Trip Duration by weekday") +
1506824054370:facet_wrap(~weekday, scales = "free", nrow = 2)
1506824054874:# mean trips duration ~ weekday
1506824054875:p6 <- trip %>%
1506824054875:mutate(duration_minutes = duration/60,
1506824054876:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506824054876:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506824054877:group_by(day_of_week) %>%
1506824054877:summarise(mean_duration_minutes = mean(duration)/60) %>%
1506824054878:ggplot(aes(factor(day_of_week, weekdays(as.Date('1970-01-03') + 1:7)),
1506824054878:mean_duration_minutes)) +
1506824054879:geom_bar(stat = "identity", width = 0.5, fill = "white", color = "black") +
1506824054879:coord_flip() +
1506824054880:labs(x = "",
1506824054880:y = "Mean Trip Duration",
1506824054881:title = "Mean Trip Duration ~ Weekdays")
1506824067329:grid.arrange(p5, p6, ncol = 2)
1506824076815:grid.arrange(p5, p6, ncol = 1)
1506824191315:# mean trips duration ~ weekday
1506824191317:p6 <- trip %>%
1506824191319:mutate(duration_minutes = duration/60,
1506824191321:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506824191322:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506824191323:group_by(day_of_week) %>%
1506824191324:summarise(mean_duration_minutes = mean(duration)/60) %>%
1506824191326:ggplot(aes(factor(day_of_week, weekdays(as.Date('1970-01-03') + 1:7)),
1506824191328:mean_duration_minutes)) +
1506824191329:geom_bar(stat = "identity", width = 0.5) +
1506824191329:coord_flip() +
1506824191330:labs(x = "",
1506824191331:y = "Mean Trip Duration",
1506824191332:title = "Mean Trip Duration ~ Weekdays")
1506824193852:p6
1506824207743:# trip duration - facet: weekday
1506824207744:p5 <- trip %>%
1506824207745:mutate(duration_minutes = duration/60,
1506824207746:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506824207747:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506824207748:ggplot(aes(duration_minutes)) +
1506824207749:geom_histogram(bins = 100) +
1506824207751:xlim(0,100) +
1506824207753:labs(x = "Minutes",
1506824207754:y = "Number of Trips",
1506824207754:title = "Trip Duration by weekday") +
1506824207755:facet_wrap(~weekday, scales = "free", nrow = 2)
1506824217690:grid.arrange(p5, p6, ncol = 1)
1506824266779:# add trip stat_long and end_long
1506824266784:trip_san_jose <- trip %>%
1506824266787:filter(start_station_id %in% station_id_san_jose) %>%
1506824266788:filter(end_station_id %in% station_id_san_jose) %>%
1506824266789:group_by(start_station_id, end_station_id) %>%
1506824266790:summarise(num_trip = n()) %>%
1506824266792:left_join(station %>% select(id, lat, long),
1506824266793:by = c("start_station_id" = "id")) %>%
1506824266794:rename(start_long = long, start_lat = lat) %>%
1506824266796:left_join(station %>% select(id, lat, long),
1506824266797:by = c("end_station_id" = "id")) %>%
1506824266798:rename(end_long = long, end_lat = lat)
1506824293364:# number of trips between stations in San Jose
1506824293365:p7 <-
1506824293366:ggplot(trip_san_jose) +
1506824293367:geom_segment(aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506824293368:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506824293370:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506824293372:geom_text_repel(data=station_san_jose,
1506824293374:aes(x=long, y=lat, label=name), size=4) +
1506824293377:theme_light(base_size=10) +
1506824293379:xlab("") +
1506824293380:ylab("") +
1506824293381:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506824293382:limits=c(0, max(trip_san_jose$num_trip)),
1506824293383:name="Number of Trips") +
1506824293384:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506824293385:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506824293385:coord_fixed() +
1506824293386:theme_void()
1506824296042:p7
1506824554130:# number of trips between stations in San Jose
1506824554132:p7 <-
1506824554133:ggplot(trip_san_jose) +
1506824554134:geom_segment(aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506824554136:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506824554137:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506824554138:geom_text_repel(data=station_san_jose,
1506824554138:aes(x=long, y=lat, label=name), size=4) +
1506824554140:theme_light(base_size=10) +
1506824554141:xlab("") +
1506824554143:ylab("") +
1506824554144:scale_colour_gradientn(colors=c("#dddddd", "#20beff"),
1506824554145:limits=c(0, max(trip_san_jose$num_trip)),
1506824554147:name="Number of Trips") +
1506824554148:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506824554150:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506824554152:coord_fixed() +
1506824554154:theme_void()
1506824561335:p7
1506824567596:ggmap(MapSanJose, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0.1) +
1506824567598:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506824567599:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506824567600:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506824567601:geom_text_repel(data=station_san_jose,
1506824567602:aes(x=long, y=lat, label=name), size=4) +
1506824567605:theme_light(base_size=10) +
1506824567606:theme(legend.position = "bottom") +
1506824567607:xlab("") +
1506824567608:ylab("") +
1506824567609:scale_colour_gradientn(colors=c("#dddddd", "#002ba3"),
1506824567610:limits=c(0, max(trip_san_jose$num_trip)),
1506824567611:name="Number of Trips") +
1506824567612:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506824567612:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506824567613:coord_fixed()
1506824578857:p9 <- ggmap(MapSanJose, extent = "panel", ylab = "Latitude", xlab = "Longitude",darken = 0.1) +
1506824578858:geom_segment(data = trip_san_jose, aes(x=start_long, xend=end_long, y=start_lat, yend=end_lat,
1506824578859:size=num_trip, colour=num_trip, alpha=num_trip)) +
1506824578860:geom_point(data=station_san_jose, aes(x=long, y=lat), size=4) +
1506824578861:geom_text_repel(data=station_san_jose,
1506824578863:aes(x=long, y=lat, label=name), size=4) +
1506824578865:theme_light(base_size=10) +
1506824578866:theme(legend.position = "bottom") +
1506824578867:xlab("") +
1506824578869:ylab("") +
1506824578870:scale_colour_gradientn(colors=c("#dddddd", "#002ba3"),
1506824578871:limits=c(0, max(trip_san_jose$num_trip)),
1506824578873:name="Number of Trips") +
1506824578873:scale_alpha(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506824578874:scale_size(limits=c(0, max(trip_san_jose$num_trip)), guide=FALSE) +
1506824578875:coord_fixed()
1506825377709:l <- regsubsets(data = weather, formula1, nvmax = 15)
1506825378008:s <- summary(l)
1506825378443:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506825378444:# s$which
1506825378445:s$cp
1506825385851:# daily trip numbers in SF
1506825385853:trip_daily_san_francisco <- trip %>%
1506825385857:filter(start_station_id %in% station_id_san_francisco) %>%
1506825385858:as_tbl_time(index = start_date) %>%
1506825385859:time_summarise(period = "daily",
1506825385860:num_trips = n()) %>%
1506825385861:mutate(start_date = as.Date(start_date))
1506825388469:weather <- weather %>%
1506825388470:left_join(trip_daily_san_francisco, by = c("pdt" = "start_date"))
1506825388473:weather <- weather %>%
1506825388473:mutate(day_of_week = pdt %>% strftime("%A"),
1506825388474:week_nr = pdt %>% strftime("%W"),
1506825388474:weekday = pdt %>% strftime("%u") %>% as.numeric) %>%
1506825388475:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506825388476:mutate(weekday = as.character(as.numeric(factor(weekday)) - 1)) %>%
1506825388476:mutate(zip = factor(zip))
1506825388521:weather <- weather %>%
1506825388522:select(pdt, weekday, mean_temperature_f, mean_dew_point_f, mean_humidity,
1506825388523:mean_sea_level_pressure_in, mean_visibility_miles,
1506825388523:mean_wind_speed_mph, precipitation_in, cloud_cover,
1506825388524:num_trips, events)
1506825388579:weather <- weather %>%
1506825388580:mutate(weekday = as.character(weekday))
1506825389264:# variable selection
1506825389265:# 1. basic formula
1506825389265:formula1 <- formula(
1506825389266:num_trips ~
1506825389266:1 + weekday +
1506825389267:mean_temperature_f +
1506825389268:precipitation_in +
1506825389269:mean_visibility_miles +
1506825389269:mean_humidity +
1506825389270:mean_wind_speed_mph +
1506825389272:cloud_cover +
1506825389273:events
1506825389274:)
1506825390469:l <- regsubsets(data = weather, formula1, nvmax = 15)
1506825390941:s <- summary(l)
1506825391981:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506825391982:# s$which
1506825391983:s$cp
1506825392571:s$which[which.min(s$cp),]
1506825431073:weather_frame <- model.matrix(formula1, weather) %>% as.tibble()
1506825431411:fit <- lm(data = weather_frame %>%
1506825431413:mutate(num_trips = weather$num_trips), formula2)
1506825431841:summary(fit)
1506825436679:# after variable selection, fit the linear model on weather data
1506825436680:# fit model
1506825436681:formula2 <- formula(
1506825436681:num_trips ~ 1 +
1506825436682:weekday1 +
1506825436682:mean_temperature_f +
1506825436683:mean_visibility_miles +
1506825436683:cloud_cover +
1506825436684:`eventsFog-Rain` +
1506825436684:eventsNone +
1506825436686:eventsRain +
1506825436687:`eventsRain-Thunderstorm`)
1506825437253:weather_frame <- model.matrix(formula1, weather) %>% as.tibble()
1506825437729:fit <- lm(data = weather_frame %>%
1506825437730:mutate(num_trips = weather$num_trips), formula2)
1506825438158:summary(fit)
1506825574545:fit$call
1506825605306:s1 <- summary(fit)
1506825610935:s1$terms
1506825617380:s1$aliased
1506825623906:s1
1506825630792:s1$sigma
1506825777322:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506825777578:plot(fit)
1506825939369:# holiday may affect
1506825939370:p10 <- weather %>%
1506825939371:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506825939372:geom_point(aes(shape = weekday, size = precipitation_in)) +
1506825939373:scale_color_brewer(palette = "Set1")
1506825978284:p10
1506826145680:xaringan::("report/presentation/presentation.Rmd")
1506826164888:xaringan::moon_reader("report/presentation/presentation.Rmd")
1506826171692:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1506826258854:# using leaflet
1506826258856:l8 <-
1506826258856:leaflet(station) %>%
1506826258857:addTiles() %>%  # Add default OpenStreetMap map tiles
1506826258857:addMarkers(lng = ~ long, lat = ~ lat, label = ~ name)
1506826260953:# using leaflet
1506826260954:l8 <-
1506826260955:leaflet(station) %>%
1506826260955:addTiles() %>%  # Add default OpenStreetMap map tiles
1506826260956:addMarkers(lng = ~ long, lat = ~ lat, label = ~ name)
1506826301328:# using leaflet
1506826301329:l8 <-
1506826301330:leaflet(station) %>%
1506826301331:addTiles() %>%  # Add default OpenStreetMap map tiles
1506826301331:addMarkers(lng = ~ long, lat = ~ lat, label = ~ name)
1506826305875:station
1506826335800:station <- station %>%
1506826335808:mutate(installation = mdy(installation)) %>%
1506826335810:arrange(station_id) %>%
1506826335813:na.omit
1506826340502:# using leaflet
1506826340503:l8 <-
1506826340503:leaflet(station) %>%
1506826340504:addTiles() %>%  # Add default OpenStreetMap map tiles
1506826340505:addMarkers(lng = ~ long, lat = ~ lat, label = ~ name)
1506826346957:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1506826438706:# using leaflet
1506826438707:l8 <-
1506826438711:leaflet(station) %>%
1506826438713:addTiles() %>%  # Add default OpenStreetMap map tiles
1506826438714:addMarkers(lng = ~ long, lat = ~ lat, label = ~ name)
1506826441417:l8
1506826699640:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1506827271927:p9
1506828062191:# days near holidays have a lower num_trips
1506828062193:weather %>%
1506828062194:filter(weekday == "0", num_trips < 1000) %>%
1506828062196:select(pdt, num_trips)
1506828072971:weather
1506828112797:source('~/Documents/Harrisburg/500_52/Project/bay_area_bike_share/src/Regression.R')
1506828123163:w1
1506828129691:# days near holidays have a lower num_trips
1506828129692:w1 <- weather %>%
1506828129692:filter(weekday == "0", num_trips < 1000) %>%
1506828129693:select(pdt, num_trips)
1506828138419:p10
1506828143543:weather
1506828151293:weather %>% glimpse()
1506828178725:weather <- weather %>%
1506828178726:mutate(weekday = as.character(weekday))
1506828187158:weather <- weather %>%
1506828187159:mutate(day_of_week = pdt %>% strftime("%A"),
1506828187159:week_nr = pdt %>% strftime("%W"),
1506828187160:weekday = pdt %>% strftime("%u") %>% as.numeric) %>%
1506828187160:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506828187162:mutate(weekday = as.character(as.numeric(factor(weekday)) - 1)) %>%
1506828187163:mutate(zip = factor(zip))
1506828188600:weather <- weather %>%
1506828188601:select(pdt, weekday, mean_temperature_f, mean_dew_point_f, mean_humidity,
1506828188603:mean_sea_level_pressure_in, mean_visibility_miles,
1506828188603:mean_wind_speed_mph, precipitation_in, cloud_cover,
1506828188604:num_trips, events)
1506828193500:# daily trip numbers in SF
1506828193501:trip_daily_san_francisco <- trip %>%
1506828193502:filter(start_station_id %in% station_id_san_francisco) %>%
1506828193504:as_tbl_time(index = start_date) %>%
1506828193506:time_summarise(period = "daily",
1506828193507:num_trips = n()) %>%
1506828193507:mutate(start_date = as.Date(start_date))
1506828196257:weather <- weather %>%
1506828196258:left_join(trip_daily_san_francisco, by = c("pdt" = "start_date"))
1506828196262:weather <- weather %>%
1506828196262:mutate(day_of_week = pdt %>% strftime("%A"),
1506828196262:week_nr = pdt %>% strftime("%W"),
1506828196263:weekday = pdt %>% strftime("%u") %>% as.numeric) %>%
1506828196263:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506828196263:mutate(weekday = as.character(as.numeric(factor(weekday)) - 1)) %>%
1506828196264:mutate(zip = factor(zip))
1506828196289:weather <- weather %>%
1506828196289:select(pdt, weekday, mean_temperature_f, mean_dew_point_f, mean_humidity,
1506828196290:mean_sea_level_pressure_in, mean_visibility_miles,
1506828196291:mean_wind_speed_mph, precipitation_in, cloud_cover,
1506828196292:num_trips, events)
1506828196342:weather <- weather %>%
1506828196343:mutate(weekday = as.character(weekday))
1506828209161:source("src/EDA.R")
1506828217576:# daily trip numbers in SF
1506828217578:trip_daily_san_francisco <- trip %>%
1506828217578:filter(start_station_id %in% station_id_san_francisco) %>%
1506828217578:as_tbl_time(index = start_date) %>%
1506828217579:time_summarise(period = "daily",
1506828217579:num_trips = n()) %>%
1506828217580:mutate(start_date = as.Date(start_date))
1506828219625:weather <- weather %>%
1506828219626:left_join(trip_daily_san_francisco, by = c("pdt" = "start_date"))
1506828219629:weather <- weather %>%
1506828219629:mutate(day_of_week = pdt %>% strftime("%A"),
1506828219630:week_nr = pdt %>% strftime("%W"),
1506828219630:weekday = pdt %>% strftime("%u") %>% as.numeric) %>%
1506828219630:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1506828219631:mutate(weekday = as.character(as.numeric(factor(weekday)) - 1)) %>%
1506828219631:mutate(zip = factor(zip))
1506828219807:weather <- weather %>%
1506828219808:select(pdt, weekday, mean_temperature_f, mean_dew_point_f, mean_humidity,
1506828219808:mean_sea_level_pressure_in, mean_visibility_miles,
1506828219808:mean_wind_speed_mph, precipitation_in, cloud_cover,
1506828219809:num_trips, events)
1506828221560:weather <- weather %>%
1506828221561:mutate(weekday = as.character(weekday))
1506828223851:# variable selection
1506828223852:# 1. basic formula
1506828223852:formula1 <- formula(
1506828223852:num_trips ~
1506828223853:1 + weekday +
1506828223853:mean_temperature_f +
1506828223853:precipitation_in +
1506828223853:mean_visibility_miles +
1506828223854:mean_humidity +
1506828223854:mean_wind_speed_mph +
1506828223854:cloud_cover +
1506828223855:events
1506828223855:)
1506828224227:l <- regsubsets(data = weather, formula1, nvmax = 15)
1506828224925:s <- summary(l)
1506828225612:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506828225613:# s$which
1506828225614:s$cp
1506828226189:s$which[which.min(s$cp),]
1506828226751:# after variable selection, fit the linear model on weather data
1506828226752:# fit model
1506828226753:formula2 <- formula(
1506828226753:num_trips ~ 1 +
1506828226755:weekday1 +
1506828226755:mean_temperature_f +
1506828226756:mean_visibility_miles +
1506828226756:cloud_cover +
1506828226757:`eventsFog-Rain` +
1506828226757:eventsNone +
1506828226757:eventsRain +
1506828226758:`eventsRain-Thunderstorm`)
1506828227525:weather_frame <- model.matrix(formula1, weather) %>% as.tibble()
1506828227986:fit <- lm(data = weather_frame %>%
1506828227986:mutate(num_trips = weather$num_trips), formula2)
1506828228528:summary(fit)
1506828229010:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1506828229747:plot(fit)
1506828230545:# holiday may affect
1506828230546:p10 <- weather %>%
1506828230546:ggplot(aes(x = pdt, y = num_trips, color = events)) +
1506828230546:geom_point(aes(shape = weekday, size = precipitation_in)) +
1506828230547:scale_color_brewer(palette = "Set1")
1506828231801:# days near holidays have a lower num_trips
1506828231802:w1 <- weather %>%
1506828231802:filter(weekday == "0", num_trips < 1000) %>%
1506828231804:select(pdt, num_trips)
1506828232690:holidaydates <- holidays(c(2015, 2016))
1506828233964:weather_holiday_adjust <- weather %>%
1506828233964:mutate(weekday = ifelse(
1506828233964:pdt %in% holidaydates, "1", weekday
1506828233965:))
1506828234658:l <- regsubsets(data = weather_holiday_adjust, formula1, nvmax = 15)
1506828235193:s <- summary(l)
1506828235862:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1506828235864:# s$which
1506828235865:s$cp
1506828240654:w1
1506828665553:fit_holiday_adjust <- lm(data = weather_holiday_adjust_frame %>%
1506828665555:mutate(num_trips = weather$num_trips),
1506828665555:formula = formula3)
1506828669343:fit_holiday_adjust <- lm(data = weather_holiday_adjust_frame %>%
1506828669344:mutate(num_trips = weather$num_trips),
1506828669345:formula = formula3)
1506828674133:formula3 <- formula(
1506828674135:sqrt(num_trips) ~ 1 +
1506828674135:weekday1 +
1506828674136:mean_temperature_f +
1506828674136:mean_visibility_miles +
1506828674137:eventsRain +
1506828674138:`eventsRain-Thunderstorm`
1506828674138:)
1506828675770:fit_holiday_adjust <- lm(data = weather_holiday_adjust_frame %>%
1506828675771:mutate(num_trips = weather$num_trips),
1506828675772:formula = formula3)
1506828748713:source('~/Documents/Harrisburg/500_52/Project/bay_area_bike_share/src/Regression.R')
1506828893293:source("src/Regression.R")
1506828925564:station_id_san_francisco
1506828978787:source('~/Documents/Harrisburg/500_52/Project/bay_area_bike_share/src/Regression.R')
1506829134252:summary_fit_holiday_adjust
1506829369481:fit_holiday_adjust
1506829734026:source("src/Regression.R")
1506829767068:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1506829789099:library(ggExtra)
1506829853250:source("src/Regression.R")
1506829872418:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1506829929495:?grid
1506829935915:library(ggExtra)
1506829990789:library(gridExtra)
1506830012265:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1506830510105:git status
1506831402182:source("src/Regression.R")
1506831426449:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1506831955320:l8
1506831983035:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1506832021874:servr::daemon_stop("4325276032")
1506868477608:> install.packages("lpSolveAPI")
1506868493604:install.packages("lpSolveAPI")
1506868501827:library(lpSolveAPI)
1506868503427:lprec <- make.lp(6, 2)
1506868505305:lprec
1506868513827:set_column(lprec,1,c(0.03,0.09,0.15,0.04,0.02,1.2))
1506868518736:set.column(lprec,1,c(0.03,0.09,0.15,0.04,0.02,1.2))
1506868521717:set.column(lprec,2,c(0.07,0.06,0.1,0.06,0.04,1.8))
1506868529345:lprec
1506868540898:set.objfn(lprec,c(1,1))
1506868544949:lprec
1506868554089:set.constr.type(lprec,c("<=","<=","<=","<=","<=","<="))
1506868556728:lprec
1506868565607:set.rhs(lprec,c(200,300,300,220,100,2500))
1506868568890:lprec
1506868580799:lp.control(lprec,sense="max")
1506868598868:lprec
1506868613722:dimnames(lprec)<-list(c("Stamping","Drilling","Assembly","Painting","Packaging","Sheet Metal"),c("MH","TH"))
1506868616878:lprec
1506868629694:solve(lprec)
1506868633984:get.variables(lprec)
1506868638627:get.objective(lprec)
1506868643090:get.constraints(lprec)
1506907402745:?make.lp
1506907412984:lprec <- make.lp(6, 2)
1506907413571:lprec
1506908966777:set.column(lprec,1,c(0.03,0.09,0.15,0.04,0.02,1.2))
1506908969628:set.column(lprec,2,c(0.07,0.06,0.1,0.06,0.04,1.8))
1506908970685:lprec
1506908987156:set.objfn(lprec,c(1,1))
1506908987679:lprec
1506909002345:set.constr.type(lprec,c("<=","<=","<=","<=","<=","<="))
1506909003830:lprec
1506909008962:set.rhs(lprec,c(200,300,300,220,100,2500))
1506909009411:lprec
1506909026587:lp.control(lprec,sense="max")
1506909034245:lprec
1506909058971:?lp.control
1506909105487:dimnames(lprec)<-list(c("Stamping","Drilling","Assembly","Painting","Packaging","Sheet Metal"),c("MH","TH"))
1506909106163:lprec
1506909118667:list(c("Stamping","Drilling","Assembly","Painting","Packaging","Sheet Metal"),c("MH","TH"))
1506909134856:solve(lprec)
1506909144763:get.variables(lprec)
1506909148487:get.objective(lprec)
1506909149964:get.constraints(lprec)
1506909365276:PLE_path <- file.path("Performance_Lawn_Equipment_Database.xlsx")
1506909706369:library(readxl)
1506909706700:library(tidyverse)
1506909712869:excel_sheets(PLE_path)
1506909792942:# Load R packages
1506909792946:knitr::opts_chunk$set(echo = TRUE, comment = NA)
1506909792949:library(lpSolveAPI)
1506909792966:lprec <- make.lp(6, 2)
1506909795654:lprec
1506909796628:set.column(lprec,1,c(0.03,0.09,0.15,0.04,0.02,1.2))
1506909797135:set.column(lprec,2,c(0.07,0.06,0.1,0.06,0.04,1.8))
1506909797538:lprec
1506909797758:set.objfn(lprec,c(1,1))
1506909798154:lprec
1506909798289:set.constr.type(lprec,c("<=","<=","<=","<=","<=","<="))
1506909798550:lprec
1506909798953:set.rhs(lprec,c(200,300,300,220,100,2500))
1506909799265:lprec
1506909799670:lp.control(lprec,sense="max")
1506909800029:lprec
1506909800451:dimnames(lprec)<-list(c("Stamping","Drilling","Assembly","Painting","Packaging","Sheet Metal"),c("MH","TH"))
1506909800890:lprec
1506909801379:solve(lprec)
1506909801894:get.variables(lprec)
1506909802359:get.objective(lprec)
1506910018042:# look at the problem
1506910018044:lprec
1506910231254:round(get.variables(lprec)[1])
1506910390322:# Get the values of the constraints that were using get.constraints
1506910390326:get.constraints(lprec)
1506910402956:get.objective(lprec)
1506910439513:1933*0.03 + 100*0.07
1506923157155:seq(0, 1, 0.1)
1506923161383:seq(0, 1, 0.1) == c(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1)
1506923174280:0.3 - 0.7 + 0.4 == 0
1506924687003:ls -a
1506924689932:ls
1506924693521:dir()
1506924829957:file.edit('~/.Rprofile')
1506924845412:dir('~')
1506924924311:file.edit("~/.Rprofile")
1506924942452:?interactive
1506925001046:file.edit('~/.Rprofile')
1506925051576:?supressMessage
1506925066320:?options
1506925185286:environment()
1506925191188:environmentName()
1506925197503:env.profile()
1506925217979:file.edit("~/.Rprofile")
1506925247946:1+1
1506925253619:file.edit("~/.Rprofile")
1506925386494:?mutate
1506925403931:file.edit("~/.Rprofile")
1506926061275:mtcars %>%
1506926061277:(df ~ lm(mpg ~ ., data = df))
1506926078989:mtcars %>% (df ~ lm(mpg ~ ., data = df))
1506997457167:mtcars %>>%
1506997457177:subset(mpg >= quantile(mpg, 0.05) & mpg <= quantile(mpg, 0.95)) %>>%
1506997457178:(~ cat("rows:",nrow(.),"\n")) %>>%   # cat() returns NULL
1506997457179:summary
1506997470268:installdevtools::install_github("renkun-ken/pipeR")
1506997471314:devtools::install_github("renkun-ken/pipeR")
1506997476937:library(pipeR)
1506997483412:mtcars %>>%
1506997483415:subset(mpg >= quantile(mpg, 0.05) & mpg <= quantile(mpg, 0.95)) %>>%
1506997483416:(~ cat("rows:",nrow(.),"\n")) %>>%   # cat() returns NULL
1506997483417:summary
1506997495270:mtcars %>>%
1506997495271:subset(select = c(mpg, wt, cyl)) %>>%
1506997495271:(x ~ plot(mpg ~ ., data = x))
1506997743916:mtcars %>>%
1506997743918:subset(mpg >= quantile(mpg, 0.05) & mpg <= quantile(mpg, 0.95)) %>>%
1506997743921:(~ cat("rows:",nrow(.),"\n"))
1506997752774:mtcars %>>%
1506997752776:subset(mpg >= quantile(mpg, 0.05) & mpg <= quantile(mpg, 0.95))
1506997770121:mtcars %>>%
1506997770122:subset(mpg >= quantile(mpg, 0.05) & mpg <= quantile(mpg, 0.95)) %>>%
1506997770123:(~ plot(mpg ~ wt, data = .)) %>>%    # plot() returns NULL
1506997770123:(lm(mpg ~ wt, data = .)) %>>%
1506997770124:summary()
1506998080241:rnorm(100) %>%
1506998080243:matrix(ncol = 2) %>%
1506998080245:plot() %>%
1506998080246:str()
1506998086197:rnorm(100) %>%
1506998086198:matrix(ncol = 2) %T>%
1506998086199:plot() %>%
1506998086199:str()
1506998236532:rnorm(100) %>>% {
1506998236534:z <- head(.,60)
1506998236535:list(sample5=sample(.,5,replace=F),
1506998236536:sample10=sample(.,10,replace=F))
1506998236536:}
1506998241416:rnorm(100) %>% {
1506998241417:z <- head(.,60)
1506998241417:list(sample5=sample(.,5,replace=F),
1506998241418:sample10=sample(.,10,replace=F))
1506998241418:}
1506998397518:mtcars %>% lm(mpg ~ ., data = .)
1506998407275:mtcars %>>% lm(mpg ~ ., data = .)
1506998415015:mtcars %>>% (lm(mpg ~ ., data = .))
1506998437383:1:10 %>% f(mean(.), median(.))
1506998644571:rnorm(100) %>%
1506998644573:matrix(ncol = 2) %T>%
1506998644577:plot() %>%
1506998644579:sqrt()
1506998668480:rnorm(100) %>%
1506998668481:matrix(ncol = 2) %T>%
1506998668482:plot()
1506998677947:rnorm(100) %>%
1506998677948:matrix(ncol = 2) %T>%
1506998677949:plot() %>%
1506998680028:str()
1506998792009:#   ____________________________________________________________________________
1506998792011:#   Read data                                                               ####
1506998792012:station <- read_csv("data/201608_station_data.csv")
1506998793520:station <- station %>%
1506998793522:mutate(installation = mdy(installation)) %>%
1506998793524:arrange(station_id) %>%
1506998793525:na.omit
1506998800307:colnames(station) <- c("id","name","lat","long","dock_count","city","installation_date")
1506998801425:trip <- read_csv("data/201608_trip_data.csv")
1506998803354:colnames(trip) <- c("id","duration","start_date","start_station_name","start_station_id","end_date","end_station_nanme","end_station_id","bike_id","subscription_type","zip_code")
1506998846758:trip <- trip %>%
1506998846760:mutate(start_date = mdy_hm(start_date),
1506998846761:end_date = mdy_hm(end_date))
1506998847360:trip<- trip %>%
1506998847361:mutate(day_of_week = start_date %>% strftime("%A"),
1506998847362:week_nr = start_date %>% strftime("%W"),
1506998847363:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1506998847364:mutate(weekday = if_else(weekday < 6, "weekday", "weekend"))
1506998848225:weather <- read_csv("data/201608_weather_data.csv")
1506998849526:# rename
1506998849528:names(weather) <-
1506998849529:names(weather) %>%
1506998849530:gsub(" ", "_", .) %>%
1506998849530:gsub("([a-z])([A-Z])", "\\1\\_\\2", .) %>%
1506998849532:tolower()
1506998850193:weather <- weather %>%
1506998850194:mutate(events = ifelse(is.na(events), "None", events)) %>%
1506998850197:mutate(events = as.factor(events)) %>%
1506998850198:mutate(pdt = mdy(pdt))
1506998850810:weather <- weather %>%
1506998850810:mutate(precipitation_in = as.numeric(precipitation_in)) %>%
1506998850811:mutate(precipitation_in = ifelse(is.na(precipitation_in),
1506998850812:0, precipitation_in))
1506998874262:weather %<>% filter(zip == 94107)
1506998901190:library(magrittr)
1506998907173:weather %<>% filter(zip == 94107)
1506998918945:weather
1506998927708:?transform
1506998943599:weather %<>% filter(zip == 94107)
1506998947900:weather %<>% filter(zip = 94107)
1506998953313:weather %<>% filter(zip == 94107)
1506998985071:weather %<>% transform(zip = zip *2)
1506999668084:mtcars %>>% (x ~ lm(mpg ~ . , data = x))
1506999681512:mtcars %>% (x ~ lm(mpg ~ . , data = x))
1506999819465:f <- function(x, y, z = "nothing") {
1506999819468:cat("x =", x, "\n")
1506999819468:cat("y =", y, "\n")
1506999819469:cat("z =", z, "\n")
1506999819469:}
1506999823207:1:10 %>% f(mean(.), median(.))
1506999861326:1:10 %>% f(1, .)
1506999886563:1:10 %>% f(1, .-1)
1506999931357:1:10 %>% f(mean(.), median(.))
1506999948858:median(1:10)
1506999955602:1:11 %>% f(mean(.), median(.))
1506999970848:1:10 %>% f(mean(.), median(.), .)
1507000009887:1:10 %>% f(1, .-1)
1507000423678:system.time({
1507000423681:lapply(1:100000, function(i) {
1507000423682:sample(letters,6,replace = T) %>%
1507000423685:paste(collapse = "") %>%
1507000423686:"=="("rstats")
1507000423687:})
1507000441303:system.time({
1507000441304:lapply(1:100000, function(i) {
1507000441305:sample(letters,6,replace = T) %>>%
1507000441306:paste(collapse = "") %>>%
1507000441307:"=="("rstats")
1507000441307:})
1507000453110:system.time({
1507000453111:lapply(1:100000, function(i) {
1507000453113:sample(letters,6,replace = T) %>%
1507000453114:paste(collapse = "") %>%
1507000453115:"=="("rstats")
1507000453116:})
1507000563909:sample(letters,6,replace = T) %>%
1507000563918:paste(collapse = "") %>%
1507000563919:"=="("rstats")
1507000566154:sample(letters,6,replace = T) %>%
1507000566155:paste(collapse = "") %>%
1507000566156:"=="("rstats")
1507000566869:sample(letters,6,replace = T) %>%
1507000566870:paste(collapse = "") %>%
1507000566871:"=="("rstats")
1507000567471:sample(letters,6,replace = T) %>%
1507000567472:paste(collapse = "") %>%
1507000567473:"=="("rstats")
1507000572884:ample(letters,6,replace = T)
1507000577629:sample(letters,6,replace = T)
1507000700265:1:10 %>% f(1, .-1, .)
1507000707510:1:10 %>% f(1, .-1)
1507000724702:1:10 %>>% f(1, .-1)
1507000730832:1:10 %>>% f(1, .-1, .)
1507000737490:1:10 %>>% f(., 1, .-1)
1507000742250:1:10 %>>% f(1, .-1)
1507001606803:mtcars %>% {
1507001606814:par(mfrow=c(1,2))
1507001606815:.$mpg %>% plot(col = "red", main=sprintf("mtcars (mpg: %d)",length(.)))
1507001606816:.$mpg %>% hist(main = "distribution")
1507001606818:}
1507001675785:mtcars %>% lm(mpg ~ cyl + wt, data = .)
1507001703224:mtcars %>% {
1507001703225:model <- lm(mpg ~ wt + cyl, data = .)
1507001703226:summ <- summary(model)
1507001703226:summ[c("r.squared","adj.r.squared")]
1507001703227:}
1507001715804:summ
1507001908676:density_plot <- mtcars$mpg %>%
1507001908680:sample(size = 10000, replace = TRUE) %>%
1507001908682:(function(kernel) {
1507001908683:. %>%
1507001908684:density(kernel = kernel) %>%
1507001908685:plot(main = sprintf("%s kernel", kernel))
1507001908686:})
1507001914918:par(mfrow=c(1,3))
1507001914921:density_plot("gaussian")
1507001914927:density_plot("rectangular")
1507001914932:density_plot("triangular")
1507001954134:density_plot <- mtcars$mpg %>>%
1507001954139:sample(size = 10000, replace = TRUE) %>>%
1507001954140:(function(kernel) {
1507001954141:. %>>%
1507001954142:density(kernel = kernel) %>>%
1507001954143:plot(main = sprintf("%s kernel", kernel))
1507001954144:})
1507001959253:par(mfrow=c(1,3))
1507001959255:density_plot("gaussian")
1507001959316:density_plot("rectangular")
1507001959338:density_plot("triangular")
1507001976339:1:10 %>>% (function(x,pow) x^pow)(2)
1507001980711:1:10 %>% (function(x,pow) x^pow)(2)
1507002031969:density_plot <- mtcars$mpg %>%
1507002031970:sample(size = 10000, replace = TRUE) %>%
1507002031970:(function(kernel) {
1507002031971:. %>%
1507002031971:density(kernel = kernel) %>%
1507002031972:plot(main = sprintf("%s kernel", kernel))
1507002031972:})
1507002034472:density_plot()
1507002039758:density_plot
1507002090874:mtcars$mpg %>>%
1507002090876:sample(size = 10000, replace = TRUE) %>>%
1507002090877:(function(kernel) {
1507002090879:. %>>%
1507002090880:density(kernel = kernel) %>>%
1507002090880:plot(main = sprintf("%s kernel", kernel))
1507002090881:})
1507002110323:mtcars$mpg %>%
1507002110324:sample(size = 10000, replace = TRUE) %>%
1507002110325:(function(kernel) {
1507002110326:. %>%
1507002110327:density(kernel = kernel) %>%
1507002110328:plot(main = sprintf("%s kernel", kernel))
1507002110330:})
1507002193130:f <- . %>%
1507002193133:sample(size = 10000, replace = TRUE) %>%
1507002193134:(function(kernel) {
1507002193134:. %>%
1507002193135:density(kernel = kernel) %>%
1507002193136:plot(main = sprintf("%s kernel", kernel))
1507002193137:})
1507002194013:f
1507002206936:f(mtcars$mpg, "gaussian")
1507002220116:f(mtcars$mpg, kernel = "gaussian")
1507002238018:density_plot <- mtcars$mpg %>%
1507002238020:sample(size = 10000, replace = TRUE) %>>%
1507002238020:(function(kernel) {
1507002238021:. %>>%
1507002238021:density(kernel = kernel) %>>%
1507002238022:plot(main = sprintf("%s kernel", kernel))
1507002238022:})
1507002241156:density_plot()
1507002253452:density_plot
1507002280546:density_plot <- mtcars$mpg %>%
1507002280548:sample(size = 10000, replace = TRUE) %>>%
1507002280548:(function(kernel) {
1507002280549:. %>%
1507002280550:density(kernel = kernel) %>>%
1507002280550:plot(main = sprintf("%s kernel", kernel))
1507002280551:})
1507002282577:density_plot
1507002293725:density_plot <- mtcars$mpg %>%
1507002293727:sample(size = 10000, replace = TRUE) %>>%
1507002293727:(function(kernel) {
1507002293728:. %>%
1507002293729:density(kernel = kernel) %>%
1507002293729:plot(main = sprintf("%s kernel", kernel))
1507002293730:})
1507002298761:density_plot("gaussian")
1507002303711:density_plot()
1507002310584:density_plot <- mtcars$mpg %>%
1507002310586:sample(size = 10000, replace = TRUE) %>>%
1507002310587:(function(kernel) {
1507002310589:. %>%
1507002310590:density(kernel = kernel) %>>%
1507002310591:plot(main = sprintf("%s kernel", kernel))
1507002310592:})
1507002314793:density_plot()
1507002322149:density_plot
1507002334961:density_plot("gaussian")
1507002347176:density_plot <- mtcars$mpg %>%
1507002347177:sample(size = 10000, replace = TRUE) %>>%
1507002347177:(function(kernel) {
1507002347178:. %>>%
1507002347178:density(kernel = kernel) %>>%
1507002347179:plot(main = sprintf("%s kernel", kernel))
1507002347182:})
1507002348323:density_plot("gaussian")
1507002357609:density_plot <- mtcars$mpg %>%
1507002357609:sample(size = 10000, replace = TRUE) %>%
1507002357610:(function(kernel) {
1507002357610:. %>>%
1507002357611:density(kernel = kernel) %>>%
1507002357611:plot(main = sprintf("%s kernel", kernel))
1507002357612:})
1507002372949:density_plot <- mtcars$mpg %>%
1507002372950:sample(size = 10000, replace = TRUE) %>%
1507002372951:function(kernel) {
1507002372953:. %>>%
1507002372954:density(kernel = kernel) %>>%
1507002372955:plot(main = sprintf("%s kernel", kernel))
1507002372956:}
1507002427854:density_plot <- mtcars$mpg %>%
1507002427858:sample(size = 10000, replace = TRUE) %>>%
1507002427860:(function(kernel) {
1507002427861:. %>%
1507002427862:density(kernel = kernel) %>%
1507002427863:plot(main = sprintf("%s kernel", kernel))
1507002427863:})
1507002435488:density_plot
1507002442857:density_plot("gaussian")
1507002448619:density_plot()
1507002494423:density_plot <- mtcars$mpg %>%
1507002494425:sample(size = 10000, replace = TRUE) %>%
1507002494427:(function(x, kernel) {
1507002494428:x %>%
1507002494429:density(kernel = kernel) %>%
1507002494430:plot(main = sprintf("%s kernel", kernel))
1507002494430:})
1507002614748:density_plot <- mtcars$mpg %>%
1507002614750:sample(size = 10000, replace = TRUE) %>>%
1507002614751:(function(kernel) {
1507002614752:. %>%
1507002614754:density(kernel = kernel) %>%
1507002614755:plot(main = sprintf("%s kernel", kernel))
1507002614758:})
1507002626575:density_plot
1507002632869:density_plot("gaussian")
1507002644731:density_plot <- mtcars$mpg %>%
1507002644733:sample(size = 10000, replace = TRUE) %>>%
1507002644733:(function(kernel) {
1507002644734:. %>%
1507002644734:density(kernel = kernel) %>>%
1507002644734:plot(main = sprintf("%s kernel", kernel))
1507002644735:})
1507002646066:density_plot("gaussian")
1507002648853:quit
1507002651832:exit
1507002659915:stop
1507002697624:density_plot <- mtcars$mpg %>>%
1507002697626:sample(size = 10000, replace = TRUE) %>>%
1507002697628:(function(kernel) {
1507002697630:. %>%
1507002697631:density(kernel = kernel) %>>%
1507002697632:plot(main = sprintf("%s kernel", kernel))
1507002697632:})
1507002699146:density_plot("gaussian")
1507002706035:density_plot <- mtcars$mpg %>>%
1507002706036:sample(size = 10000, replace = TRUE) %>>%
1507002706037:(function(kernel) {
1507002706037:. %>>%
1507002706041:density(kernel = kernel) %>>%
1507002706042:plot(main = sprintf("%s kernel", kernel))
1507002706044:})
1507002706992:density_plot("gaussian")
1507002711791:density_plot <- mtcars$mpg %>%
1507002711792:sample(size = 10000, replace = TRUE) %>>%
1507002711793:(function(kernel) {
1507002711793:. %>>%
1507002711794:density(kernel = kernel) %>>%
1507002711794:plot(main = sprintf("%s kernel", kernel))
1507002711795:})
1507002712905:density_plot("gaussian")
1507002716535:density_plot <- mtcars$mpg %>%
1507002716536:sample(size = 10000, replace = TRUE) %>%
1507002716537:(function(kernel) {
1507002716537:. %>>%
1507002716538:density(kernel = kernel) %>>%
1507002716538:plot(main = sprintf("%s kernel", kernel))
1507002716539:})
1507002746682:density_plot <- mtcars$mpg %>%
1507002746683:sample(size = 10000, replace = TRUE) %>>%
1507002746685:(function(kernel) {
1507002746685:. %>%
1507002746686:density(kernel = kernel) %>>%
1507002746687:plot(main = sprintf("%s kernel", kernel))
1507002746687:})
1507002748851:density_plot("gaussian")
1507002759422:density_plot <- mtcars$mpg %>%
1507002759422:sample(size = 10000, replace = TRUE) %>>%
1507002759423:(function(kernel) {
1507002759423:. %>>%
1507002759424:density(kernel = kernel) %>%
1507002759424:plot(main = sprintf("%s kernel", kernel))
1507002759425:})
1507002760594:density_plot("gaussian")
1507002791985:density_plot <- mtcars$mpg %>%
1507002791988:sample(size = 10000, replace = TRUE) %>>%
1507002791989:(function(kernel) {
1507002791991:. %>>%
1507002791992:density(kernel = kernel) %>%
1507002791992:plot(main = sprintf("%s kernel", kernel))
1507002791993:})
1507002797032:density_plot
1507002813377:density(sample(size = 100), "gaussian")
1507002818867:density(sample(size = 100), kernel = "gaussian")
1507002822508:density(x = sample(size = 100), kernel = "gaussian")
1507002826010:?density
1507002837774:density(x = sample(size = 199))
1507002878248:density(x = sample(mtcars$mpg, size = 199))
1507002889295:density(x = sample(mtcars$mpg, size = 199, replace = T))
1507002900190:density(x = sample(mtcars$mpg, size = 199, replace = T), kernel = "gaussian")
1507002905348:density(x = sample(mtcars$mpg, size = 199, replace = T), kernel = "gaussian") %>% plot
1507002933585:density_plot <- mtcars$mpg %>%
1507002933586:sample(size = 10000, replace = TRUE) %>>%
1507002933587:(function(kernel) {
1507002933588:. %>%
1507002933589:density(., kernel = kernel) %>%
1507002933591:plot(main = sprintf("%s kernel", kernel))
1507002933592:})
1507002936837:density_plot
1507002943286:density_plot('gaussian')
1507002968500:density_plot <- mtcars$mpg %>%
1507002968502:sample(size = 10000, replace = TRUE) %>>%
1507002968503:(function(., kernel) {
1507002968504:. %>%
1507002968505:density(., kernel = kernel) %>%
1507002968507:plot(main = sprintf("%s kernel", kernel))
1507002968508:})
1507002969761:density_plot('gaussian')
1507002985950:?%.%
1507002993283:data %.%
1507002993284:melt(id.vars=c("treatment", "sex")) %.%
1507002993285:group_by(sex, treatment, variable) %.%
1507002993285:summarise(mean(value))
1507003071184:mtcars %>>%
1507003071187:filter(mpg <= mean(mpg)) %>>%
1507003071188:select(mpg, wt, cyl) %>>%
1507003071189:(~ plot(.)) %>>%
1507003071190:(model = lm(mpg ~ wt + cyl, data = .)) %>>%
1507003071191:(summ = summary(.)) %>>%
1507003071192:(coefficients)
1507003086289:?filter
1507003096396:mtcars %>>%
1507003096397:dplyr::filter(mpg <= mean(mpg)) %>>%
1507003096397:select(mpg, wt, cyl) %>>%
1507003096398:(~ plot(.)) %>>%
1507003096398:(model = lm(mpg ~ wt + cyl, data = .)) %>>%
1507003096399:(summ = summary(.)) %>>%
1507003096399:(coefficients)
1507003144428:mtcars %>%
1507003144431:dplyr::filter(mpg <= mean(mpg)) %>%
1507003144432:select(mpg, wt, cyl) %T>%
1507003144432:plot %>%
1507003144433:(model = lm(mpg ~ wt + cyl, data = .)) %>%
1507003144434:(summ = summary(.)) %>%
1507003144434:(coefficients)
1507003164670:mtcars %>%
1507003164671:dplyr::filter(mpg <= mean(mpg)) %>%
1507003164672:select(mpg, wt, cyl) %T>%
1507003164673:plot %>%
1507003164676:lm(mpg ~ wt + cyl, data = .) %>%
1507003164677:(summ = summary(.)) %>%
1507003164679:(coefficients)
1507003170036:mtcars %>%
1507003170036:dplyr::filter(mpg <= mean(mpg)) %>%
1507003170037:select(mpg, wt, cyl) %T>%
1507003170037:plot %>%
1507003170038:lm(mpg ~ wt + cyl, data = .) %>%
1507003170038:summary(.) %>%
1507003170039:(coefficients)
1507003217794:mtcars %>%
1507003217798:dplyr::filter(mpg <= mean(mpg)) %>%
1507003217800:select(mpg, wt, cyl) %T>%
1507003217800:plot %>%
1507003217801:lm(mpg ~ wt + cyl, data = .) %>%
1507003217803:summary(.) %>%
1507003217804:(coefficients)
1507003246717:mtcars %>%
1507003246719:dplyr::filter(mpg <= mean(mpg)) %>%
1507003246719:select(mpg, wt, cyl) %T>%
1507003246720:plot %>%
1507003246720:lm(mpg ~ wt + cyl, data = .) %>%
1507003246721:summary(.)
1507003322538:Pipe(mtcars)$
1507003322539:.(~ summary(.) -> summ)$
1507003322540:lm(formula = mpg ~ wt + cyl)$
1507003322541:summary()
1507003336014:summ
1507003344104:Pipe(mtcars)$
1507003344105:.(~ summary(.) -> summ)$
1507003344105:lm(formula = mpg ~ wt + cyl)$
1507003344106:summary()
1507003345271:summ
1507003418012:?hop
1507003474657:my_pipe <- function(.) {
1507003474659:. <- sum(.)
1507003474660:. <- sqrt(.)
1507003474661:.^2
1507003474662:}
1507003490966:my_pipe(c(1:3))
1507003496180:my_pipe <- function(.) {
1507003496181:. <- sum(.)
1507003496181:. <- sqrt(.)
1507003496182:}
1507003497165:my_pipe(c(1:3))
1507003504808:my_pipe <- function(.) {
1507003504810:. <- sum(.)
1507003504811:.sqrt(.)
1507003504813:}
1507003509706:my_pipe <- function(.) {
1507003509707:. <- sum(.)
1507003509708:sqrt(.)
1507003509709:}
1507003511676:my_pipe(c(1:3))
1507003534100:my_pipe <- function(.) {
1507003534102:. <- sum(.) %>% sqrt(.)
1507003534103:}
1507003538667:my_pipe(c(1:3))
1507003546815:my_pipe <- function(.) {
1507003546816:. <- sum(.) %>% sqrt(.)
1507003546817:return(.)
1507003546817:}
1507003549314:my_pipe(c(1:3))
1507003647108:mtcars %>%
1507003647109:(select(mpg) -> a) %>% mean()
1507003660008:mtcars %>%
1507003660009:(select(mpg) -> a) %>% count(mpg)
1507003666178:mtcars %>>%
1507003666179:(select(mpg) -> a) %>% count(mpg)
1507003669761:mtcars %>>%
1507003669762:(select(mpg) -> a) %>>% count(mpg)
1507003682510:mtcars %>>%
1507003682511:(select(mpg) -> a)
1507003684204:a
1507003689806:mtcars
1507003698078:mtcars %>>%
1507003698079:(select(mpg))
1507003701747:mtcars %>>%
1507003701748:select(mpg)
1507003717513:mtcars %>%
1507003717514:(select(mpg))
1507003745910:mtcars %>>%
1507003745910:(. %>% select(mpg) -> a) %>% count(mpg)
1507003748903:mtcars %>>%
1507003748905:(. %>% select(mpg) -> a)
1507003751666:a
1507003761956:mtcars %>>%
1507003761957:select(mpg)
1507003772056:mtcars %>>%
1507003772056:select(mpg) %>% count(mpg)
1507003787735:mtcars %>>%
1507003787736:(select(mpg) -> a) %>% count(mpg)
1507003796912:mtcars %>>%
1507003796913:(select(., mpg) -> a) %>% count(mpg)
1507003817414:mtcars %>%
1507003817415:(select(., mpg) -> a) %>% count(mpg)
1507003825074:mtcars %>%
1507003825075:{select(., mpg) -> a} %>% count(mpg)
1507003826430:a
1507003841279:mtcars %>%
1507003841280:{select(mpg) -> a} %>% count(mpg)
1507003846208:mtcars %>%
1507003846208:{select(., mpg) -> a} %>% count(mpg)
1507003861992:a
1507003870297:mtcars %>%
1507003870298:{select(., mpg) = a} %>% count(mpg)
1507003877847:mtcars %>%
1507003877848:{a <- select(., mpg)} %>% count(mpg)
1507003878727:a
1507003951605:mtcars %>%
1507003951606:(df ~ lm(mpg ~ ., data = df))
1507003961520:mtcars %>%
1507003961521:{df ~ lm(mpg ~ ., data = df)}
1507003975999:mtcars %>>%
1507003976000:(df ~ lm(mpg ~ ., data = df))
1507083582798:rmarkdown::render("report/report.Rmd")
1507083663877:?read_csv
1507084191725:source("src/Regression.R")
1507084220341:p
1507084222363:p1
1507084224753:p2
1507084736484:p4
1507084885586:knitr::opts_chunk$set(echo = F, warning = F, message = F, comment = "")
1507084886066:gridExtra::grid.arrange(p5, p6, ncol = 1)
1507085260493:station %>% count(city)
1507085773032:read_csv("./../data/201608_weather_data.csv") %>% glimpse
1507085849754:t <- read_csv("./../data/201608_weather_data.csv") %T>% glimpse
1507085853360:t
1507085890088:ncol(t)
1507086080095:formula1
1507086195488:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1507086195489:# s$which
1507086195490:s$cp
1507086196854:s$which[which.min(s$cp),]
1507086661287:summary(fit)
1507086677738:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1507086678774:plot(fit)
1507086716423:summary(fit)$Residuals
1507086729752:summary(fit) %$% Residuals
1507086742272:summary(fit) %$% residuals
1507086754707:summary(fit) %$% coef
1507086761921:summary(fit) %$% coefficients
1507086867670:rmarkdown::render("report/report.Rmd")
1507086995554:p10
1507087742656:# variable selection
1507087742658:# 1. basic formula
1507087742660:formula1 <- formula(
1507087742663:num_trips ~
1507087742664:1 + weekday +
1507087742665:mean_temperature_f +
1507087742665:precipitation_in +
1507087742666:mean_visibility_miles +
1507087742667:mean_humidity +
1507087742668:mean_wind_speed_mph +
1507087742669:cloud_cover +
1507087742669:events
1507087742670:)
1507087743278:l1 <- regsubsets(data = weather, formula1, nvmax = 15)
1507087743722:s1 <- summary(l1)
1507087745097:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1507087745098:# s$which
1507087745098:s1$cp
1507087745795:s1$which[which.min(s1$cp),]
1507087809224:l <- regsubsets(data = weather_holiday_adjust, formula1, nvmax = 15)
1507087809823:s <- summary(l)
1507087811005:# data.frame(s$outmat, RSS = s$rss, R2 = s$rsq, Cp = s$cp, BIC = s$bic)
1507087811006:# s$which
1507087811007:s$cp
1507087811808:s$which[which.min(s$cp),]
1507087819248:formula3 <- formula(
1507087819249:sqrt(num_trips) ~ 1 +
1507087819250:weekday1 +
1507087819250:mean_temperature_f +
1507087819251:mean_visibility_miles +
1507087819251:eventsRain +
1507087819252:`eventsRain-Thunderstorm`
1507087819252:)
1507087823360:formula3
1507088151097:summary(fit_holiday_adjust)
1507088153614:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1507088154321:plot(fit_holiday_adjust)
1507088188691:rmarkdown::render("report/report.Rmd")
1507088384534:source("src/Regression.R")
1507088406539:rmarkdown::render("report/report.Rmd")
1507088697426:myViewer <- getOption("viewer")
1507088701677:myViewer("~/test.html")
1507088716034:file.copy("~/test.html", file.path(tempdir(), "test.html"))
1507088729005:myViewer(file.path(tempdir(), "test.html"))
1507088736016:?myViewer
1507088756926:myViewer("report/report.html")
1507088825102:sessionInfo()
1507088861503:viewer <- getOption("viewer")
1507088861510:if (!is.null(viewer))
1507088861511:viewer("http://localhost:8100")
1507088861545:else
1507088861548:utils::browseURL("http://localhost:8100")
1507088872250:rmarkdown::render("report/report.Rmd")
1507088928509:getOption("viewer")
1507088960185:viewer()
1507088972009:temp.f <- tempfile()
1507088972011:cat("Hello", file = temp.f)
1507088972014:rstudio::viewer(temp.f)
1507088981741:install.packages("rstudio")
1507088993237:library(rstudioapi)
1507088995268:temp.f <- tempfile()
1507088995271:cat("Hello", file = temp.f)
1507088995274:rstudio::viewer(temp.f)
1507089003639:temp.f <- tempfile()
1507089003640:cat("Hello", file = temp.f)
1507089003641:viewer(temp.f)
1507089018442:viewer("report/report.Rmd")
1507089028248:viewer("report/report.html")
1507089051557:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1507089059745:source("src/Regression.R")
1507089081617:rmarkdown::render("report/report.Rmd")
1507089098627:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1507089184524:temp.f <- tempfile()
1507089184529:cat("Hello", file = temp.f)
1507089184536:rstudioapi::viewer(temp.f)
1507089201878:temp.f <- tempfile()
1507089201879:cat("Hello", file = temp.f)
1507089201880:rstudioapi::viewer("report/report.html")
1507089289907:temp.f <- tempfile()
1507089289909:cat("Hello", file = temp.f)
1507089289910:rstudioapi::viewer(temp.f)
1507089295535:temp.f <- tempfile()
1507089295537:cat("Helloasas", file = temp.f)
1507089295539:rstudioapi::viewer(temp.f)
1507089299698:rmarkdown::render("report/report.Rmd")
1507089329176:getOption()
1507089333703:getOption("viewer")
1507089394337:unlink('report/report_cache', recursive = TRUE)
1507089459338:rmarkdown::render("report/report.Rmd")
1507089505528:library(knitr)
1507089505536:library(markdown)
1507089505722:f <- system.file("examples", "knitr-minimal.Rmd", package = "knitr")
1507089505726:knit(f)
1507089506093:markdownToHTML('knitr-minimal.md',output='knitr-minimal.html')
1507089506135:rstudio::viewer('knitr-minimal.html')
1507089513521:library(knitr)
1507089513523:library(markdown)
1507089513524:f <- system.file("examples", "knitr-minimal.Rmd", package = "knitr")
1507089513526:knit(f)
1507089513721:markdownToHTML('knitr-minimal.md',output='knitr-minimal.html')
1507089514122:rstudioapi::viewer('knitr-minimal.html')
1507089549053:p1
1507089557069:plotly::ggplotly(p1)
1507089567499:rmarkdown::render("report/report.Rmd")
1507089587954:?rmarkdown
1507089664775:knit_with_parameters('~/Documents/Harrisburg/500_52/Project/bay_area_bike_share/report/presentation/presentation.Rmd')
1507089769781:knitr::render("report/report.Rmd")
1507089774914:library(knitr)
1507089776059:knitr::render("report/report.Rmd")
1507089885914:rmarkdown::render("report/report.Rmd")
1507090045899:devtools::install_github("rstudio/rmarkdown")
1507090058470:library(rmarkdown)
1507090061842:rmarkdown::render("report/report.Rmd")
1507090088469:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1507090114657:rmarkdown::render("report/report.Rmd")
1507090586266:knitr::opts_chunk$set(echo = F, warning = F, message = F, comment = "")
1507090586517:read_csv("./../data/201608_station_data.csv", n_max = 10) %>%
1507090586520:DT::datatable(
1507090586522:head(station, 10),
1507090586525:fillContainer = F, options = list(pageLength = 3, scrollX = T, dom = "tp"),
1507090586527:rownames = F
1507090586529:)
1507090586697:read_csv("./../data/201608_trip_data.csv", n_max = 10) %>%
1507090586700:DT::datatable(
1507090586702:head(trip, 10),
1507090586704:fillContainer = F, options = list(pageLength = 3, scrollX = T, dom = "tp"),
1507090586706:rownames = F
1507090586708:)
1507090587150:read_csv("./../data/201608_weather_data.csv", n_max = 10) %>%
1507090587158:DT::datatable(
1507090587160:head(station, 10),
1507090587162:fillContainer = F, options = list(pageLength = 3, scrollX = T, dom = "tp"),
1507090587164:rownames = F
1507090587167:)
1507090587288:p1
1507090588019:p2
1507090588555:p3
1507090591649:p4
1507090594364:gridExtra::grid.arrange(p5, p6, ncol = 1)
1507090596796:l8
1507090596984:p7
1507090597559:t <- read_csv("./../data/201608_weather_data.csv") %T>% glimpse
1507090597693:formula1
1507090597706:s1$which[which.min(s1$cp),]
1507090597718:formula2
1507090597731:summary(fit)
1507090597758:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1507090597763:plot(fit)
1507090744104:render("report/report.Rmd")
1507090957880:knitr::opts_chunk$set(echo = F, warning = F, message = F, comment = "")
1507090958971:library(tidyverse)
1507091336593:render("input.Rmd", html_document(toc = TRUE))
1507091343902:library(rmarkdown)
1507091344802:render("input.Rmd", html_document(toc = TRUE))
1507091537692:unlink('report/report_cache', recursive = TRUE)
1507091575485:knitr::opts_chunk$set(echo = F, warning = F, message = F, comment = "")
1507091575487:library(tidyverse)
1507091575490:library(rmarkdown)
1507091575492:library(knitr)
1507091575674:read_csv("./../data/201608_trip_data.csv", n_max = 10) %>%
1507091575677:DT::datatable(
1507091575678:head(., 10),
1507091575680:fillContainer = F, options = list(pageLength = 3, scrollX = T, dom = "tp"),
1507091575682:rownames = F
1507091575684:)
1507091578407:knitr::opts_chunk$set(echo = F, warning = F, message = F, comment = "")
1507091578411:library(tidyverse)
1507091578415:library(rmarkdown)
1507091578420:library(knitr)
1507091578432:read_csv("./../data/201608_station_data.csv", n_max = 10) %>%
1507091578433:DT::datatable(
1507091578435:head(., 10),
1507091578437:fillContainer = F, options = list(pageLength = 3, scrollX = T, dom = "tp"),
1507091578439:rownames = F
1507091578441:)
1507091588378:p4
1507091645668:render("report/report.Rmd")
1507091715120:source("src/Regression.R")
1507091740895:rmarkdown::render("report/report.Rmd")
1507166293781:source("src/Regression.R")
1507166316408:rmarkdown::render("report/report.Rmd")
1507166492695:station %$% cityname
1507166493667:# all station ids in a city
1507166493668:station_in_city <- function(cityname) {
1507166493669:station %$% cityname
1507166493671:}
1507166527925:# all station ids in a city
1507166527925:station_in_city <- function(cityname) {
1507166527926:station %>%
1507166527926:filter(city == cityname) %$%
1507166527927:cityname
1507166527927:}
1507166533472:station_in_city("San Jose")
1507166542860:# all station ids in a city
1507166542861:station_in_city <- function(cityname) {
1507166542861:station %>%
1507166542862:filter(city == cityname) %$%
1507166542862:id
1507166542863:}
1507166544944:station_in_city("San Jose")
1507166853980:source("src/Regression.R")
1507166983977:rmarkdown::render("report/report.Rmd")
1507245737360:?cor.test
1507245747033:navigation
1507245756080:x <- c(44.4, 45.9, 41.9, 53.3, 44.7, 44.1, 50.7, 45.2, 60.1)
1507245756082:y <- c( 2.6,  3.1,  2.5,  5.0,  3.6,  4.0,  5.2,  2.8,  3.8)
1507245756083:##  The alternative hypothesis of interest is that the
1507245756083:##  Hunter L value is positively associated with the panel score.
1507245756084:cor.test(x, y, method = "kendall", alternative = "greater")
1507349575387:purrr::cheatsheet
1507483088911:a <- c(4,12,7,5,11,8, 9, 13, 10, 6)
1507483134161:b <- c(340, 850, 570, 470, 820, 610, 630, 900, 800, 480)
1507483143917:lm(b~a)
1507483174909:summary(lm(b~a))
1507483211385:hours <- c(4, 12, 7, 5, 11, 8, 9, 13, 10, 6)
1507483222472:salary <- c(340, 850, 570, 470, 820, 610, 630, 900, 800, 480)
1507483235225:summary(lm(salary ~ hours))
1507483607497:data.frame(stringsAsFactors=FALSE,
1507483607498:Year = c("Real Home Price Index", "1946", "106.5058955", "1947",
1507483607499:"109.3296707", "1948", "101.2225795", "1949", "100.0466076",
1507483607499:"1950", "105.8948393", "1951", "103.8986687", "1852",
1507483607500:"103.9743275", "1953", "114.7133093", "1954", "114.199126", "1955",
1507483607500:"115.4621261", "1956", "115.3166155"),
1507483607501:Year = c("Real Home Price Index", "1946", "106.5058955", "1947",
1507483607501:"109.3296707", "1948", "101.2225795", "1949", "100.0466076",
1507483607502:"1950", "105.8948393", "1951", "103.8986687", "1852",
1507483607504:"103.9743275", "1953", "114.7133093", "1954", "114.199126", "1955",
1507483607506:"115.4621261", "1956", "115.3166155")
1507483607509:)
1507483653498:data.frame(
1507483653500:Year = c(106.5058955, 1947, 109.3296707, 1948, 101.2225795, 1949,
1507483653501:100.0466076, 1950, 105.8948393, 1951, 103.8986687, 1852,
1507483653502:103.9743275, 1953, 114.7133093, 1954, 114.199126, 1955, 115.4621261,
1507483653503:1956, 115.3166155),
1507483653503:Price = c(106.5058955, 1947, 109.3296707, 1948, 101.2225795, 1949,
1507483653504:100.0466076, 1950, 105.8948393, 1951, 103.8986687, 1852,
1507483653504:103.9743275, 1953, 114.7133093, 1954, 114.199126, 1955, 115.4621261,
1507483653505:1956, 115.3166155)
1507483653507:)
1507483703938:addinexamples:::subsetAddin()
1507483780136:109.3296707 +101.2225795+100.0466076
1507483789804:109.3296707 +101.2225795+100.0466076 %>% ./3
1507483794123:109.3296707 +101.2225795+100.0466076 %>>% ./3
1507483800459:library(pipeR)
1507483802826:109.3296707 +101.2225795+100.0466076 %>>% ./3
1507483808849:109.3296707 +101.2225795+100.0466076 %>>% (./3)
1507483819405:(109.3296707 +101.2225795+100.0466076) %>>% (./3)
1507483961462:(106.5058955 + 109.3296707 + 101.2225795 + 100.0466076 + 105.8948393) %>>% (./5)
1507483968271:(106.5058955 + 109.3296707 + 101.2225795 + 100.0466076 + 105.8948393)/5
1507485926607:a <- c(88, 44, 54, 65, 72, 85)
1507485931224:a <- ts(a)
1507485932721:a
1507485964519:sma(a)
1507485981215:install.packages("smooth")
1507485992918:listall.packages("Mcomp")
1507486004586:install.packages("Mcomp")
1507486008653:library(smooth)
1507486021236:library(Mcomp)
1507486028107:sma(a)
1507486054709:summary(sma(a))
1507486062437:ma(a)
1507486079438:ma(a, fun = mean)
1507486084191:ma(a, FIN = mean)
1507486090063:ma(a, FUN = mean)
1507486101771:install.packages("hydroTSM")
1507486106615:library(hydroTSM)
1507486108934:ma(a, FUN = mean)
1507486114880:ma(a)
1507486121903:?ma
1507486138672:ma(a, order = 2)
1507486144983:a
1507486163744:a <- c(88, 44, 54, 65, 72, 85)
1507486165092:ma(a, order = 2)
1507486178040:a
1507486208005:ma(a, order = 1)
1507486227089:ma(a, order = 12)
1507486231514:ma(a, order = 4)
1507486246623:hydroTSM::ma(a, order = 4)
1507486250811:hydroTSM::ma(a)
1507486296653:install.packages("pracma")
1507486301579:library(pracma)
1507486316941:movavg(a)
1507486323350:movavg(a, n = 2)
1507486399234:mad(a)
1507486435703:mad(a, center = mean(a))
1507486459599:movavg(a, n = 2)
1507486462434:b <- movavg(a, n = 2)
1507486471227:mad(b, center = mean(b))
1507486476790:mean(b)
1507486481451:sd(b)
1507486509071:mad(b, center = median(b))
1507489489873:(750/10000) / ( (1500/10000) * (2500/10000))
1507491483018:data.frame(stringsAsFactors=FALSE,
1507491483023:Female = c("Male", "Male", "Female", "Female", "Male", "Male", "Male",
1507491483023:"Female", "Male", "Male", "Female", "Female", "Male",
1507491483024:"Female"),
1507491483024:Fruits = c("Cereal", "Milk", "Fruits", "Milk", "Cereal", "Milk", "Milk",
1507491483025:"Fruits", "Fruits", "Cereal", "Cereal", "Milk", "Fruits",
1507491483025:"Fruits")
1507491483026:)
1507491589954:df <- data.frame(stringsAsFactors=FALSE,
1507491589957:Female = c("Male", "Male", "Female", "Female", "Male", "Male", "Male",
1507491589958:"Female", "Male", "Male", "Female", "Female", "Male",
1507491589959:"Female"),
1507491589959:Fruits = c("Cereal", "Milk", "Fruits", "Milk", "Cereal", "Milk", "Milk",
1507491589960:"Fruits", "Fruits", "Cereal", "Cereal", "Milk", "Fruits",
1507491589960:"Fruits")
1507491589961:)
1507491593814:chisq.test(df)
1507491600639:?chisq.test
1507491651996:M <- as.table(rbind(c(762, 327, 468), c(484, 239, 477)))
1507491652003:dimnames(M) <- list(gender = c("F", "M"),
1507491652006:party = c("Democrat","Independent", "Republican"))
1507491652012:(Xsq <- chisq.test(M))
1507491655449:M
1507491661494:tabel()
1507491669621:table()
1507491674735:table(df)
1507491681885:df
1507491697859:table(df) %>% chisq.test()
1507491753473:chisq.test(table(df))
1507491786518:chisq.test(table(df),simulate.p.value = TRUE)
1507491864446:chisq.test(table(df))
1507491906727:t <- chisq.test(table(df))
1507491909336:t$statistic
1507492013935:table(df)
1507492487381:b <- movavg(a, n = 2)
1507492488974:b
1507492491723:a <- c(88, 44, 54, 65, 72, 85)
1507492494024:b <- movavg(a, n = 2)
1507492495766:a
1507492499249:b <- movavg(a, n = 2)
1507492504588:b
1507492511177:b-a
1507492520787:abs(b-a)
1507492526419:abs(b-a) %>% sd
1507492549238:a
1507492549616:b
1507492559789:b-a
1507492690712:df <- data.frame(stringsAsFactors=FALSE,
1507492690714:Gender = c("Female", "Male", "Male", "Female", "Female", "Male", "Male", "Male",
1507492690715:"Female", "Male", "Male", "Female", "Female", "Male",
1507492690715:"Female"),
1507492690716:Preference = c("Fruits", "Cereal", "Milk", "Fruits", "Milk", "Cereal", "Milk", "Milk",
1507492690716:"Fruits", "Fruits", "Cereal", "Cereal", "Milk", "Fruits",
1507492690717:"Fruits")
1507492690719:)
1507492691564:t <- chisq.test(table(df))
1507492692202:t$statistic
1507492697732:chisq.test(table(df))
1507492700260:df <- data.frame(stringsAsFactors=FALSE,
1507492700261:Gender = c("Female", "Male", "Male", "Female", "Female", "Male", "Male", "Male",
1507492700261:"Female", "Male", "Male", "Female", "Female", "Male",
1507492700262:"Female"),
1507492700263:Preference = c("Fruits", "Cereal", "Milk", "Fruits", "Milk", "Cereal", "Milk", "Milk",
1507492700263:"Fruits", "Fruits", "Cereal", "Cereal", "Milk", "Fruits",
1507492700264:"Fruits")
1507492700264:)
1507492700729:chisq.test(table(df))
1507492769642:a <- c(88, 44, 54, 65, 72, 85)
1507492771251:b
1507492819286:b <- movavg(a, n = 2)
1507492824335:?movavg
1507492840197:mad(b, center = median(b))
1507492845095:mad(b, center = mean(b))
1507492849648:sd(b)
1507493045205:b
1507493054383:b %>% slice(2:4)
1507493059074:b[2:4]
1507493063508:b[2:5]
1507493066510:a{2:5}
1507493070660:a[2:5]
1507493077568:b1 <- b[2:5]
1507493083665:a1 <- a[2:5]
1507493088104:b1-a1
1507493095132:mean(b1,a1)
1507493101053:mean(b1+a1)
1507493104498:(b1+a1)
1507493106695:(b1+a1).2
1507493111644:(b1+a1)/2
1507493118440:b1 - (b1+a1)/2
1507493123333:a1 - (b1+a1)/2
1507493128273:a
1507493163089:b
1507493186822:b <- movavg(a, n = 2)
1507493192783:b
1507493211532:b <- movavg(a, n = 1)
1507493213559:b
1507493217100:a
1507493226397:b <- movavg(a, n = 4)
1507493229458:b <- movavg(a, n = 2)
1507493232025:a
1507493235876:b
1507493280287:b[2:5]
1507493286355:a{3"6"}
1507493290239:a[3:6]
1507493294655:a1<a[3:6]
1507493300190:a1<- a[3:6]
1507493301012:a
1507493305795:b1 - a1
1507493315205:abs(b1 - a1)
1507493317442:abs(b1 - a1) %>% mean
1507509394500:qnorm(1.94)
1507509398812:pnorm(1.94)
1507509421771:43-50
1507509429319:7/pnorm(1.94)
1507509480967:7/1.94
1507510552368:install.packages("explainr")
1507510583818:devtools::install_github("hilaryparker/explainr")
1507510607554:library(explainr)
1507510618204:?dplyr::explain
1507510629463:chisq.test(table(df)) %>% explain
1507510648418:ptest <- prop.test(x = 500, n = 1008)
1507510648425:explain(ptest)
1507513805944:?combine
1507513840487:install.packages("combinat")
1507513844047:require(combinat)
1507513844197:permn(3)
1507513844201:combn(3, 2)
1507513850834:combn(20, 10)
1507513891213:?combn
1507513906216:?choose
1507513915831:choose(20, 10)
1507513926993:comb = function(n, x) {
1507513926995:return(factorial(n) / (factorial(x) * factorial(n-x)))
1507513926995:}
1507513929527:comb(20, 10)
1507513937687:?permn
1507513941382:permn(20)
1507513948942:perms(20)
1507513981338:??permutation
1507514004952:permn(20)
1507514017847:?combn
1507514030489:choose(20, 10)
1507514037927:combn(20, 10)
1507514057219:lchoose(20, 10)
1507514082042:choose(20, 20)
1507514094446:choose(20, 10)/5^10
1507514199566:choose(20, 10)*4^10/5^20
1507514252295:choose(20, 10)*(4^10)/(5^20)
1507515477104:qnorm(.9)
1507515516934:qnorm(.9)*94/40 %>% .^2
1507515522803:qnorm(.9)*94/40
1507515541988:qnorm(.9)*94/40 %>>% (.^2)
1507515548401:qnorm(.9)*94/40 %>>% (.)^2
1507515556480:qnorm(.9)*94/40 %>>% (. * .)
1507515561019:qnorm(.9)*94/40
1507515571708:(qnorm(.9)*94/40)^2
1507516192191:qnorm(.99)
1507516194544:qnorm(0.99)
1507516199373:qnorm(0.99)*2.4
1507516215530:52 - qnorm(0.99)*2.4
1507516219458:52 + qnorm(0.99)*2.4
1507516260321:52 - qnorm(0.995)*2.4
1507516263077:52 + qnorm(0.995)*2.4
1507516493008:?TDist
1507516501357:pt(.9)
1507516504078:qt(.9)
1507516515484:qnorm(.9)
1507516526588:qnorm(.9)*1215/40
1507516949936:pnorm(.9)
1507516957026:qnorm(.9)
1507516964991:qnorm(.95)
1507516976036:qnorm(.975)
1507517104241:qnorm(.9)*2*94/40
1507517114731:qnorm(.9)*2*94/40 %>>% ^2
1507517116670:qnorm(.9)*2*94/40 %>>% .^2
1507517124658:qnorm(.9)*2*94/40 %>>% square
1507517130643:??square
1507517149071:(qnorm(.9)*2*94/40)^2
1507517171603:(qnorm(.95)*2*94/40)^2
1507517187316:(qnorm(.95)*2*94/80)^2
1507517190675:(qnorm(.95)*2*94/40)^2
1507517405446:qnorm(.95)
1507517431656:(qnorm(.95)*94/40)^2
1507517719568:qnorm(.9)
1507517907184:pnorm(.9)
1507517929207:pnorm(.9)*94.40
1507517935122:pnorm(.9)*94.4040
1507517938967:pnorm(.9)*94/40
1507518337410:pnorm(.9)*94/20
1507518408368:pnorm(2)
1507518414242:qnorm(2)
1507518426718:qnorm(.95)
1507518470753:pnorm(.95)
1507518480675:pnorm(.975)
1507518487886:qnorm(.975)
1507518502018:qnorm(.95)
1507518535059:qnorm(.95)*2*
1507518537989:qnorm(.95)*2
1507518545245:(qnorm(.95)*2)^2
1507518557019:(qnorm(.95)*2)^2^94^2
1507518560704:(qnorm(.95)*2)^2*94^2
1507518567040:(qnorm(.95)*2)^2*94^2/20^2
1507518571014:(qnorm(.95)*2)^2*94^2/40^2
1507518575742:(qnorm(.95)*2)^2*94^2/20^2
1507518580416:(qnorm(.95)*2)^2*94^2/20^2/2
1507597566272:curve(sin(x)+x^2, 0, pi)
1507597576323:curve(sin(x)+x^2, 0, pi)curve(sin(x)+x^2, 0, pi)
1507597583788:curve(sin(x)+x^2, 0, pi)
1507597589393:dev.off()
1507597591573:curve(sin(x)+x^2, 0, pi)
1507597661423:par(mar = c(2, 2, 2, 2))
1507597661438:par(mfrow = c(1, 1))
1507597661490:R <- 3
1507597661514:r <- 2
1507597661521:x <- seq(0, 2*pi,length.out=50)
1507597661551:y <- seq(0, pi,length.out=50)
1507597661618:M <- mesh(x, y)
1507597661637:alpha <- M$x
1507597661652:beta <- M$y
1507597661662:surf3D(x = (R + r*cos(alpha)) * cos(beta),
1507597661664:y = (R + r*cos(alpha)) * sin(beta),
1507597661666:z = r * sin(alpha),
1507597661679:colkey=FALSE,
1507597661694:bty="b2",
1507597661699:main="Half of a Torus")
1507597681427:install.packages("plot3D")
1507597697733:library(plot3D)
1507597702224:par(mar = c(2, 2, 2, 2))
1507597702227:par(mfrow = c(1, 1))
1507597702229:R <- 3
1507597702231:r <- 2
1507597702232:x <- seq(0, 2*pi,length.out=50)
1507597702234:y <- seq(0, pi,length.out=50)
1507597702235:M <- mesh(x, y)
1507597702239:alpha <- M$x
1507597702240:beta <- M$y
1507597702241:surf3D(x = (R + r*cos(alpha)) * cos(beta),
1507597702242:y = (R + r*cos(alpha)) * sin(beta),
1507597702244:z = r * sin(alpha),
1507597702244:colkey=FALSE,
1507597702246:bty="b2",
1507597702247:main="Half of a Torus")
1507597752691:install.packages("rgl")
1507597770806:aa
1507597775154:library(rgl)
1507597785582:aa
1507597924093:x <- seq(0,100,0.05)#x在区间[-2,3]之间，取值隔0.05取一个
1507597924341:y <- seq(0,1,0.05)#y在区间[-1,7]之间,取值隔0.05取一个
1507597924726:f <- function(x,y)#实现函数
1507597924730:{
1507597924732:(x*(1-y) - 30)/(x*(1-y))
1507597924733:}
1507597925409:z <- outer(x,y,f)#让x,y在函数f的关系下作外积运算，形成网格，这样才能绘出三维图形
1507597926204:a <- seq(0,100,10)
1507597926877:for (i in a)
1507597927964:{
1507597927965:persp(x,y,z,theta=i,phi=30,expand=0.7,col="blue")#这里让观看的角度每隔一定时间变一次，theta应该是水平方向#的，phi是竖直方向上的角度
1507597927967:Sys.sleep(3)#让R的运行暂停三秒
1507597927968:}
1507597940979:x
1507597943093:y
1507597943889:f
1507597955839:1
1507597955841:2
1507597955841:3
1507597955842:4
1507597955846:5
1507597955847:6
1507597955848:7
1507597955849:8
1507597955850:9
1507597955851:10
1507597955854:11
1507597955854:12
1507597955855:13
1507597955856:14
1507597955857:x <- seq(-2,3,0.05)#x在区间[-2,3]之间，取值隔0.05取一个
1507597955861:y <- seq(-1,7,0.05)#y在区间[-1,7]之间,取值隔0.05取一个
1507597955863:f <- function(x,y)#实现函数
1507597955865:{
1507597955865:x^4-2*x^2*y-2*x*y+2*y^2+4.5*x-4*y+4
1507597955868:}
1507597955870:z <- outer(x,y,f)#让x,y在函数f的关系下作外积运算，形成网格，这样才能绘出三维图形
1507597955872:a <- seq(0,100,10)
1507597955874:for (i in a)
1507597955875:{
1507597955876:persp(x,y,z,theta=i,phi=30,expand=0.7,col="blue")#这里让观看的角度每隔一定时间变一次，theta应该是水平方向#的，phi是竖直方向上的角度
1507597955877:Sys.sleep(3)#让R的运行暂停三秒
1507597955878:}
1507598031003:presp(x, y, z)
1507598037433:persp(x, y, z)
1507598084600:zorder = rank(z)
1507598090919:persp3d(x, y, z, col = rainbow(as.integer(max(zorder)))[zorder])
1507598413185:fn = function(x, y) {
1507598413189:x^2 + y^2 - 10 * (cos(2 * pi * x) + cos(2 * pi * y)) + 20
1507598413193:}
1507598413405:a = 5
1507598413836:x = seq(-a, a, 0.05)
1507598414037:y = seq(-a, a, 0.05)
1507598416548:z = outer(x, y, fn)
1507598418967:persp(x, y, z)
1507598422930:library(rgl)
1507598426097:zorder = rank(z)
1507598430228:persp3d(x, y, z, col = rainbow(as.integer(max(zorder)))[zorder])
1507598494409:x <- seq(0,100,0.05)#x在区间[-2,3]之间，取值隔0.05取一个
1507598494416:y <- seq(0,1,0.05)#y在区间[-1,7]之间,取值隔0.05取一个
1507598494417:f <- function(x,y)#实现函数
1507598494418:{
1507598494419:(x*(1-y) - 30)/(x*(1-y))
1507598494419:}
1507598494420:z <- outer(x,y,f)#让x,y在函数f的关系下作外积运算，形成网格，这样才能绘出三维图形
1507598494424:a <- seq(0,100,10)
1507598494426:persp(x, y, z)
1507598516912:x <- seq(0,100,0.05)#x在区间[-2,3]之间，取值隔0.05取一个
1507598517309:y <- seq(0,1,0.05)#y在区间[-1,7]之间,取值隔0.05取一个
1507598518257:f <- function(x,y)#实现函数
1507598518258:{
1507598518258:(x*(1-y) - 30)/(x*(1-y))
1507598518259:}
1507598521345:z <- outer(x,y,f)#让x,y在函数f的关系下作外积运算，形成网格，这样才能绘出三维图形
1507598524273:persp(x, y, z)
1507598526193:persp3d(x, y, z, col = rainbow(as.integer(max(zorder)))[zorder])
1507598531226:zorder = rank(z)
1507598531794:persp3d(x, y, z, col = rainbow(as.integer(max(zorder)))[zorder])
1507598535677:f
1507598542060:z <- outer(x,y,f)#让x,y在函数f的关系下作外积运算，形成网格，这样才能绘出三维图形
1507598543154:z
1507598553188:persp(x, y, z)
1507598605961:x <- seq(0,100,0.05)#x在区间[-2,3]之间，取值隔0.05取一个
1507598606311:y <- seq(0,0.9,0.05)#y在区间[-1,7]之间,取值隔0.05取一个
1507598606930:f <- function(x,y)#实现函数
1507598606933:{
1507598606934:(x*(1-y) - 30)/(x*(1-y))
1507598606935:}
1507598607592:z <- outer(x,y,f)#让x,y在函数f的关系下作外积运算，形成网格，这样才能绘出三维图形
1507598608415:persp(x, y, z)
1507598610618:zorder = rank(z)
1507598610980:persp3d(x, y, z, col = rainbow(as.integer(max(zorder)))[zorder])
1507598615400:z
1507598624946:x
1507598680105:fn = function(x, y) {
1507598680108:(x*(1-y) - 30)/(x*(1-y))
1507598680110:}
1507598680477:x = seq(1, 100, 1)
1507598680745:y = seq(0, 0.9, 0.05)
1507598680978:z = outer(x, y, fn)
1507598681321:persp(x, y, z)
1507598684979:library(rgl)
1507598685453:zorder = rank(z)
1507598685694:persp3d(x, y, z, col = rainbow(as.integer(max(zorder)))[zorder])
1507599166399:((x+30)*(1-y) - 30)/((x+30)*(1-y))
1507599167013:fn = function(x, y) {
1507599167014:((x+30)*(1-y) - 30)/((x+30)*(1-y))
1507599167015:}
1507599169166:fn = function(x, y) {
1507599169167:((x+30)*(1-y) - 30)/((x+30)*(1-y))
1507599169168:}
1507599169904:x = seq(1, 100, 1)
1507599170350:y = seq(0, 0.9, 0.05)
1507599170651:z = outer(x, y, fn)
1507599171804:persp(x, y, z)
1507599173993:library(rgl)
1507599174349:zorder = rank(z)
1507599174744:persp3d(x, y, z, col = rainbow(as.integer(max(zorder)))[zorder])
1507599205158:y = seq(0, 0.5, 0.05)
1507599205900:z = outer(x, y, fn)
1507599206233:persp(x, y, z)
1507599207679:library(rgl)
1507599207971:zorder = rank(z)
1507599208218:persp3d(x, y, z, col = rainbow(as.integer(max(zorder)))[zorder])
1507599300915:((x+50)*(1-y) - 50)/((x+50)*(1-y))
1507599301448:fn = function(x, y) {
1507599301449:((x+50)*(1-y) - 50)/((x+50)*(1-y))
1507599301452:}
1507599301903:x = seq(1, 100, 1)
1507599302376:y = seq(0, 0.5, 0.05)
1507599302825:z = outer(x, y, fn)
1507599303022:persp(x, y, z)
1507599303443:library(rgl)
1507599303863:zorder = rank(z)
1507599304681:persp3d(x, y, z, col = rainbow(as.integer(max(zorder)))[zorder])
1507599695832:((x+50)*(1-y) - 50)
1507599698338:fn = function(x, y) {
1507599698341:((x+50)*(1-y) - 50)
1507599698343:}
1507599698944:x = seq(1, 100, 1)
1507599699937:y = seq(0, 0.5, 0.05)
1507599700150:z = outer(x, y, fn)
1507599701301:persp(x, y, z)
1507599703107:library(rgl)
1507599703383:zorder = rank(z)
1507599703860:persp3d(x, y, z, col = rainbow(as.integer(max(zorder)))[zorder])
1507599751919:y = seq(0, 0.8, 0.05)
1507599753636:z = outer(x, y, fn)
1507599754450:persp(x, y, z)
1507599756400:zorder = rank(z)
1507599756548:persp3d(x, y, z, col = rainbow(as.integer(max(zorder)))[zorder])
1507610671021:RStudio.Version()
1507610673957:ls
1507610675445:dir()
1507611338631:tibble
1507613731269:?printf
1507613737264:??printf
1507684030675:source("src/Regression.R")
1507684440092:?moon_reader
1507684469224:?inf_mr
1507684491990:xaringan::infinite_moon_reader("report/presentation/presentation.Rmd")
1507684506113:xaringan::infinite_moon_reader("docs/presentation.Rmd")
1507684540760:dir()
1507684555370:getwd()
1507684558483:source("src/Regression.R")
1507684574888:rmarkdown::render("report/report.Rmd")
1507684590308:xaringan::infinite_moon_reader("docs/presentation.Rmd")
1507684617656:options(htmltools.dir.version = FALSE)
1507684617660:options(servr.daemon = TRUE)
1507684617662:knitr::opts_chunk$set(echo = F, tidy = F, warning = F, message = F,
1507684617665:comment = "", tidy = F, fig.width = 10,
1507684617667:eval = require("DT", "tidyverse"))
1507684617672:library(tidyverse)
1507684617676:library(gridExtra)
1507684617680:library(DT)
1507684617980:trip <- read_csv("/../data/201608_trip_data.csv")
1507684665163:xaringan::infinite_moon_reader("docs/presentation.Rmd")
1507685077819:w1
1507685252161:xaringan::infinite_moon_reader("docs/presentation.Rmd")
1507685419848:w1
1507695795644:mtcars %>% pull(mpg)
1507695798763:mtcars
1507695815029:mtcars %$% mpg
1507695817567:mtcars %>% pull(mpg)
1507698128069:weather_frame
1507769732508:vif(fit3)
1507769746236:vif(fit_holiday_adjust)
1507770270598:render("report/report.Rmd")
1507771044195:?random
1507771050589:?unif
1507771052978:Uniform
1507771056747:?runif
1507771091232:round(runif(6, min = 17, max = 20))
1507771101398:?rnorm
1507771116800:clear
1507771143463:round(runif(6, 17, 20))
1507771258668:set.seed(1)
1507771293282:a <- round(runif(5, 17, 20))
1507771327032:b <- paste(a[1], 20, a[-1])
1507771328149:b
1507771342624:a[-1]
1507771350791:a
1507771377342:b <- paste(c(c(a[1], 20), a[-1]))
1507771378700:b
1507771386900:?append
1507771402927:append(a[1], 20)
1507771426653:append(a, 20, 2)
1507771430327:append(a, 20, 1)
1507771450677:append(round(runif(5, 16, 20)), 20, 1)
1507771468991:set.seed(100)
1507771475848:append(round(runif(5, 16, 20)), 20, 1)
1507771634236:set.seed(100)
1507771634245:append(round(runif(5, 16, 20)), 20, 1)
1507771638688:set.seed(100)
1507771638690:append(round(runif(5, 16, 20)), 20, 1)
1507776478142:source("src/Regression.R")
1507776495858:rmarkdown::render("report/report.Rmd")
1507776507204:xaringan::infinite_moon_reader("docs/index.Rmd")
1507776564229:servr::daemon_stop("4619892784")
1507776694111:installed.packages()
1507776707159:"ggplot"  %in% installed.packages()
1507776712452:"ggplot2"  %in% installed.packages()
1507776911426:require(ggplot2,character.only = TRUE)
1507776920225:require("ggplot2",character.only = TRUE)
1507776926051:require("ggplt2",character.only = TRUE)
1507776993796:list.of.packages <- c("ggplot2", "Rcpp")
1507776993800:new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
1507776993842:if(length(new.packages)) install.packages(new.packages)
1507777001421:new.packages
1507777012577:ength(new.packages)
1507777014784:length(new.packages)
1507777210878:pckg <- function(x) {
1507777210881:if(!require(i, character.only = T)){
1507777210884:install.packages(x, dependencies = T)
1507777210885:library(package)
1507777210886:} else library(package)
1507777210887:}
1507777340209:source('~/Documents/Harrisburg/500_52/Project/bay_area_bike_share/config/library.R')
1507777558995:source('~/Documents/Harrisburg/500_52/Project/bay_area_bike_share/run.R')
1507777652905:pckg
1507777662922:pckg("hello")
1507777705676:source('~/Documents/Harrisburg/500_52/Project/bay_area_bike_share/run.R')
1507777849386:pckg("pacman")
1507777892278:pckg <- function(x) {
1507777892280:if (!require(x, character.only = T)) {
1507777892280:install.packages(x, dependencies = T)
1507777892281:library(x, character.only = T)
1507777892282:}
1507777918995:pckg("glmnet")
1507777969643:pckg(ads)
1507777986842:pckg(rbundler)
1507778014834:pckg("rbundler")
1507778034307:pckg("tidyverse")
1507778061736:pckg <- function(x) {
1507778061737:if (!require(x, character.only = T)) {
1507778061738:install.packages(x, dependencies = T)
1507778061738:library(x, character.only = T)
1507778061739:} else library(x, character.only = T)
1507778061739:}
1507778069626:pckg("tidyverse")
1507778082583:pckg("DT")
1507778097343:source('~/Documents/Harrisburg/500_52/Project/bay_area_bike_share/run.R')
1507779003242:getwd()
1507779022846:source("run.R")
1507779089377:View(p9)
1507861331568:# daily trip numbers in SF
1507861331571:trip_daily_san_francisco <- trip %>%
1507861331572:filter(start_station_id %in% station_id_san_francisco) %>%
1507861331572:mutate(start_date = as.Date(start_date)) %>%
1507861331573:group_by(start_date) %>%
1507861331574:summarise(num_trips = n()) %>%
1507861331575:mutate(start_date = as.Date(start_date))
1507861395800:# number of trips by day
1507861395801:p1 <- trip %>%
1507861395801:mutate(start_date = as.Date(start_date)) %>%
1507861395802:group_by(start_date) %>%
1507861395803:summarise(num_trips = n()) %>%
1507861395803:mutate(day_of_week = start_date %>% strftime("%A"),
1507861395804:week_nr = start_date %>% strftime("%W"),
1507861395805:weekday = start_date %>% strftime("%u") %>% as.numeric) %>%
1507861395805:mutate(weekday = if_else(weekday < 6, "weekday", "weekend")) %>%
1507861395806:ggplot(aes(start_date, num_trips, color = weekday)) +
1507861395806:geom_point() +
1507861395807:# geom_smooth()+
1507861395807:labs(x = "Date",
1507861395808:y = "Total Number of Bicycle Trips",
1507861395809:title = "Trips Each Day")
1507861405338:source("run.R")
1507863842589:source('run.R')
1508034942308:pnorm(.9)
1508034957642:pnorm(.95)
1508034962610:pnorm(.975)
1508034967515:qnorm(.95)
1508034972554:qnorm(.9)
1508034979746:qnorm(.975)
1508034984898:qnorm(.95)
1508034999836:qnorm(.95) * 94 / 40
1508035008663:(qnorm(.95) * 94 / 40)^2
1508222329575:p<-prcomp(USArrests, scale=T)
1508222331204:p
1508222337084:biplot(p)
1508222802469:某中学随机抽取某年级30名学生，测量其身高，体重，胸围，坐高，针对这30名中学生身体四项指标数据做主成分分析。
1508222802479:student<-data.frame(
1508222802481:X1=c(148, 139, 160, 149, 159, 142, 153, 150, 151, 139,
1508222802481:140, 161, 158, 140, 137, 152, 149, 145, 160, 156,
1508222802482:151, 147, 157, 147, 157, 151, 144, 141, 139, 148),
1508222802483:X2=c(41, 34, 49, 36, 45, 31, 43, 43, 42, 31,
1508222802483:29, 47, 49, 33, 31, 35, 47, 35, 47, 44,
1508222802484:42, 38, 39, 30, 48, 36, 36, 30, 32, 38),
1508222802484:X3=c(72, 71, 77, 67, 80, 66, 76, 77, 77, 68,
1508222802485:64, 78, 78, 67, 66, 73, 82, 70, 74, 78,
1508222802485:73, 73, 68, 65, 80, 74, 68, 67, 68, 70),
1508222802486:X4=c(78, 76, 86, 79, 86, 76, 83, 79, 80, 74,
1508222802486:74, 84, 83, 77, 73, 79, 79, 77, 87, 85,
1508222802487:82, 78, 80, 75, 88, 80, 76, 76, 73, 78)
1508222802487:)
1508222802507:#主成分分析
1508222802508:student.pr <- princomp(student, cor = TRUE)
1508222802540:#显示结果
1508222802540:summary(student.pr, loadings=TRUE)
1508222802551:#预测，显示各样本主成分的值
1508222802552:pre<-predict(student.pr)
1508222802553:#显示碎石图
1508222802554:screeplot(student.pr,type="lines")
1508222802598:# 主成分分析散点图
1508222802599:biplot(student.pr)
1508222867235:which(X1==max(X1))
1508222867247:which(X2==max(X2))
1508222867248:which(X3==max(X3))
1508222867249:which(X4==max(X4))
1508280949316:install.packages("dlstats")
1508280961394:library(dlstats)
1508280971159:cran_stats("rlist")
1508281057784:# rlist tutorial
1508281057785:devtools::install_github("renkun-ken/rlist")
1508281066871:library(rlist)
1508281266405:url <- "http://renkun.me/rlist-tutorial/data/people.json"
1508281287731:library(pipeR)
1508281300174:people <- list.load(url)
1508281305979:url <- "http://renkun.me/rlist-tutorial/data/people.json"
1508281308597:people <- list.load(url)
1508281325659:url <- "https://renkun-ken.github.io/rlist-tutorial/data/people.json"
1508281326135:people <- list.load(url)
1508281430330:people %>%
1508281430332:list.filter(Expertise$R >= 1 & Expertise$Python >= 1) %>%
1508281430333:list.class(Interests) %>%
1508281430333:list.sort(-length(.)) %>%
1508281430334:list.take(3) %>%
1508281430334:list.map(. %>% list.table(Age))
1508281436430:people
1508281442453:people %>%
1508281442456:list.filter(Expertise$R >= 1 & Expertise$Python >= 1) %>%
1508281442458:list.class(Interests) %>%
1508281442458:list.sort(-length(.)) %>%
1508281442459:list.take(3) %>%
1508281442459:list.map(. %>% list.table(Age))
1508281448959:people %>%
1508281448960:list.filter(Expertise$R >= 1 & Expertise$Python >= 1) %>>%
1508281448961:list.class(Interests) %>>%
1508281448962:list.sort(-length(.)) %>>%
1508281448964:list.take(3) %>>%
1508281448967:list.map(. %>>% list.table(Age))
1508281485580:people
1508281542293:people %>% names
1508281546304:people %>% class
1508281549854:?list.names
1508281555139:people %>% list.names()
1508281565605:people[1] %>% list.names()
1508281568972:people[1]
1508281572874:people[1][[1]]
1508281576754:people[1][[1]] %>% list.names
1508281582555:people[[1]] %>% list.names
1508281600908:people[[1]] %>% class
1508281604466:people[[1]][[1]] %>% class
1508281610548:people[[1]][1] %>% class
1508281612683:people[[1]][1]
1508287726976:a <- list(a = 1:3, b = "a string", c = pi, d = list(-1, -5))
1508287731327:a$b
1508287737272:a$c
1508287741123:a$d
1508287748115:a$d %>% str
1508287756040:list(2,3)
1508287934464:a
1508288215110:df <- data.frame(
1508288215112:a = rnorm(10),
1508288215112:b = rnorm(10),
1508288215113:c = rnorm(10),
1508288215113:d = rnorm(10)
1508288215113:)
1508288217528:df
1508288221602:results <- numeric(length(df))
1508288223870:results
1508288228312:length(df)
1508288235493:seq_along(df)
1508288242294:df[1]
1508288246443:df[[1]]
1508288256771:df[1] %>% class
1508288261817:df[,1] %>% class
1508288285027:df %<>% as_tibble()
1508288290671:library(magrittr)
1508288292349:df %<>% as_tibble()
1508288295049:df %>% class
1508288297789:length(df)
1508288300515:df[1]
1508288303583:df[[1]]
1508288308848:df[[a]]
1508288311939:df[["a"]]
1508288940801:vector("numeric", 3)
1508288946303:?vector
1508289092143:apply
1508289110563:?apply
1508291183234:mtcars %>%
1508291183236:split(.$cyl)
1508291187963:mtcars
1508291192357:?split
1508291221803:split(mtcars$cyl)
1508291241472:data.table::split(mtcars$cyl)
1508291260952:data.table::split()
1508291263476:data.table::split
1508291267375:library(data.table)
1508291268933:split
1508291301162:mtcars %>%
1508291301163:split(.$cyl)
1508291316868:split(mtcars, .$cyl)
1508291320135:split(mtcars, cyl)
1508291323076:split(mtcars, $cyl)
1508291360063:models <- mtcars %>%
1508291360064:split(.$cyl) %>%
1508291360065:map(function(df) lm(mpg ~ wt, data = df))
1508291362794:models
1508291368631:models %>% class
1508291563756:split(mtcars, function(df) df$cyl)
1508291575996:split(mtcars, f = (function(df) df$cyl))
1508291608409:return(df$cyl)
1508291609152:fun1 <- function(df) {
1508291609153:return(df$cyl)
1508291609154:}
1508291609709:split(mtcars, f = fun1)
1508291621995:fun1 <- function(df) {
1508291621997:return(df$cyl)
1508291621997:}
1508291626747:fun1(mtcars)
1508291636830:return(levels(df$cyl))
1508291638715:fun1 <- function(df) {
1508291638716:return(levels(df$cyl))
1508291638716:}
1508291641189:return(levels(df$cyl))
1508291646905:fun1 <- function(df) {
1508291646906:return(df$cyl)
1508291646907:}
1508291647498:split(mtcars, f = fun1)
1508291672989:split(mtcars$cyl)
1508291676960:split(mtcars$cyl, f = split)
1508291696677:split(1:10, 1:2)
1508291710841:split(mtcars, f = mtcars$cyl)
1508291714952:split(mtcars, mtcars$cyl)
1508291741593:mtcars %>%
1508291741595:split(mtcars$cyl)
1508292316604:models %>%
1508292316607:map(summary) %>%
1508292316608:map_dbl(~.$r.squared)
1508292319436:models %>%
1508292319437:map(summary) %>%
1508292319437:map_dbl(.$r.squared)
1508293060871:mtcars %>%
1508293060876:map_lgl(is.factor)
1508293076981:mtcars %>%
1508293076982:map_lgl(is.factor) %>%
1508293076983:class
1508293102168:mtcars %>%
1508293102171:map_lgl(is.factor) %>% {.[[1]]}
1508293114459:mtcars %>%
1508293114460:map_lgl(is.factor) %>% (.[[1]])
1508293121781:mtcars %>%
1508293121782:map_lgl(is.factor) %>%
1508293121782:{.[[1]]}
1508293126263:mtcars %>%
1508293126264:map_lgl(is.factor) %>%
1508293126265:{.[1]}
1508293131482:mtcars %>%
1508293131484:map_lgl(is.factor) %>%
1508293131484:{.[[1]]}
1508293154274:map(1:5, runif)
1508293164889:list(1:5)
1508293184866:runif(1:5)
1508293197031:?runif
1508293206093:runif(1)
1508293208738:runif(5)
1508293232166:c <- c(1:5)
1508293233404:c
1508293235727:c[[1]]
1508293237989:c[[2]]
1508293239600:c[1]
1508293241032:c[2]
1508294492376:issues <- jsonlite::fromJSON("issues.json", simplifyVector = FALSE)
1508294521301:library(jsonlite)
1508294523505:issues <- jsonlite::fromJSON("issues.json", simplifyVector = FALSE)
1508294566199:url1 <- "https://api.github.com/repos/hadley/r4ds/issues"
1508294578549:issue <- list.load(url1)
1508294584798:issues %>% str
1508294594887:issues <- list.load(url1)
1508294595931:issues %>% str
1508294618274:str(issues[1])
1508294634398:str(issues[[1]])
1508294650215:length(issues)
1508296138365:issues %>%
1508296138367:map_int("id")
1508296145876:issues %>%
1508296145877:map_int(.$id)
1508296149559:issues %>%
1508296149561:map_int(~.$id)
1508296213823:issues %>% map_lgl("locked")
1508296220702:issues %>% map_chr("state")
1508296253498:users <- issues %>% map("user")
1508296255551:users
1508296307154:str(issues[[1]])
1508296538065:users %>% map("id")
1508296544568:users %>% map_chr("id")
1508296550034:users %>% map_chr("login")
1508296591990:issues %>% map_chr(c("user", "login"))
1508296639269:issues %>% map_int(c("user", "id"))
1508381458810:.Last.value
1508381785490:x1=c(1,3,4,29,68,4,6,9)
1508381790560:x2=c(4,6)
1508381798669:x1[!x2]
1508381800556:x1
1508381807290:x1[which(!x2)]
1508381816322:x1[which(x1 != x2)]
1508381832096:which(x1 != x2)
1508381844610:x1 != x2
1508381948707:?dparse
1508381953914:?deparse
1508381965792:deparse(args(lm))
1508381971812:deparse(s)
1508381980949:deparse(args(plot))
1508381996376:deparse(subtitle(x))
1508382012177:deparse(substitute(x))
1508382017697:?substitute
1508382039449:substitute(asas)
1508382055193:deparse(substitute(asas))
1508382061905:substitute(asas) %>% class
1508382065272:deparse(substitute(asas)) %>% class
1508382101508:quote(adfas)
1508382103928:quote(adfas) %>% names
1508382108049:quote(adfas) %>% class
1508382152228:substitute(lm, env = residuals)
1508382157153:substitute(lm, residuals)
1508382170213:substitute(lm)
1508382174747:enquote(cl)
1508382179821:enquote(lm)
1508382187748:lm
1508382198767:x
1508382204189:equote(x1)
1508382208910:enquote(x1)
1508382213595:enquote(x1) %>% class
1508460941139:install.packages('DiagrammeR')
1508460951355:library(DiagrammeR)
1508460977107:√
1508460978991:grViz("
1508460978992:digraph boxes_and_circles {
1508460978993:# a 'graph' statement
1508460978993:graph [overlap = true, fontsize = 10]
1508460978994:# several 'node' statements
1508460978994:node [shape = box,
1508460978995:fontname = Helvetica]
1508460978995:A; B; C; D; E; F
1508460978997:node [shape = circle,
1508460978997:fixedsize = true,
1508460978997:width = 0.9] // sets as circles
1508460978998:1; 2; 3; 4; 5; 6; 7; 8
1508460979002:# several 'edge' statements
1508460979004:A->1 B->2 B->3 B->4 C->A
1508460979007:1->D E->A 2->4 1->5 1->F
1508460979007:E->6 4->6 5->7 6->7 3->8
1508460979008:}
1508460979008:")
1508461210119:DiagrammeR("
1508461210124:sequenceDiagram;
1508461210126:participant R;
1508461210128:Note left of R: Get Data<br/>Do Calculations
1508461210130:htmlwidgets->>R: dependencies, binding
1508461210131:alt Static
1508461210131:R->>Browser: json;
1508461210132:Note right of Browser: User Interact
1508461210133:else Shiny
1508461210133:loop continuously in response to event
1508461210135:R-->>Browser: json over socket;
1508461210136:Browser-->>R: json over socket;
1508461210136:Note left of R: Get Data<br/>Do Calculations
1508461210137:Note right of Browser: User Interact
1508461210137:end
1508461210138:")
1508551197217:?switch
1508551216609:rcauchy(10)
1508552361937:4%3
1508552367291:4 %% 3
1508552369971:4 %% 2
1508552371815:4 %% 5
1508552373912:4 %% 6
1508604295961:mtcars %>% split(.$cyl)
1508604427218:?split
1508604455909:split(mtcars, function(df) df$cyl)
1508604480020:split(mtcars, cyl)
1508604484917:split(mtcars, mtcars$cyl)
1508604626685:models <- mtcars %>%
1508604626687:split(.$cyl) %>%
1508604626687:map(~lm(mpg ~ wt, data = .))
1508604634405:models %>%
1508604634407:map(summary) %>%
1508604634408:map_dbl(~.$r.squared)
1508604637705:models %>%
1508604637706:map(summary)
1508604645563:models %>%
1508604645564:map(summary) %>%
1508604645565:map_dbl(.$r.squared)
1508604663788:models %>%
1508604663790:map(summary)[[2]]
1508604670053:models %>%
1508604670054:map(summary) %>>% .[[2]]
1508604675712:library(pipeR)
1508604680206:models %>%
1508604680207:map(summary) %>>% (.[[2]])
1508604694481:models %>%
1508604694482:map(summary) %>>% (.[[2]]) %>% (.$r.squared)
1508604697540:models %>%
1508604697541:map(summary) %>>% (.[[2]]) %>>% (.$r.squared)
1508604717814:models %>%
1508604717815:map(summary) %>>% (.[[2]]) %>% r.squared
1508604725366:models %>%
1508604725369:map(summary) %>>% (.[[2]]) %>% .$r.squared
1508604745490:models %>%
1508604745491:map(summary) %>% .[[2]] %>% .$r.squared
1508604754589:models %>%
1508604754590:map(summary) %>% .$r.squared
1508604845922:models %>%
1508604845925:map(summary) %>%
1508604845925:map_dbl(function(df) df$r.squared)
1508604973372:?map
1508613399962:RStudio.Version()
1508634993247:require(pipeR)
1508634993270:rnorm(100000,mean=10,sd=1) %>>%
1508634993277:sample(.,size=length(.)0.2,replace=FALSE) %>%
1508634993289:abs %>%
1508634993292:log %|>%
1508634993293:(a -> diff(a)) %|>%
1508634993296:(a -> plot(a,col="red",type="l"))
1508635008917:require(pipeR)
1508635008919:rnorm(100000,mean=10,sd=1) %>>%
1508635008920:sample(.,size=length(.)0.2,replace=FALSE) %>%
1508635008922:abs %>%
1508635008923:log %>>%
1508635008924:(a -> diff(a)) %>>%
1508635008925:(a -> plot(a,col="red",type="l"))
1508635028024:require(pipeR)
1508635028025:rnorm(100000,mean=10,sd=1) %>>%
1508635028026:sample(.,size=length(.)0.2,replace=FALSE) %>>%
1508635028027:abs %>>%
1508635028027:log %>>%
1508635028028:(a -> diff(a)) %>>%
1508635028028:(a -> plot(a,col="red",type="l"))
1508635056031:require(pipeR)
1508635056033:rnorm(100000,mean=10,sd=1) %>>%
1508635056033:sample(.,size=length(.)*0.2,replace=FALSE) %>>%
1508635056034:abs %>>%
1508635056034:log %>>%
1508635056034:(a -> diff(a)) %>>%
1508635056035:(a -> plot(a,col="red",type="l"))
1508635072352:require(pipeR)
1508635072353:rnorm(100000,mean=10,sd=1) %>>%
1508635072354:sample(.,size=length(.)*0.2,replace=FALSE) %>>%
1508635072354:abs %>>%
1508635072355:log %|>%
1508635072355:(a -> diff(a)) %>>%
1508635072356:(a -> plot(a,col="red",type="l"))
1508635163634:require(pipeR)
1508635163637:rnorm(100000,mean=10,sd=1) %>>%
1508635163638:sample(.,size=length(.)*0.2,replace=FALSE) %>>%
1508635163639:abs %>>%
1508635163639:log %>>%
1508635163641:(~ a = diff(a)) %>>%
1508635163645:(~a = plot(a,col="red",type="l"))
1508635237951:iris %>% `[`(1,3) %>% head()
1508635241476:iris %>% `[`(1,3)
1508635256690:iris %>% .[, 1:2]
1508635293390:mydata<-list(
1508635293391:mmm=1:5,
1508635293392:nn=c("dd","fff","ttt"),
1508635293392:dd=6:20
1508635293393:)
1508635293394:mydata %>% extract2(1)
1508635293398:mydata %>% `[[`(1)
1508635293402:mydata[[1]]
1508635293403:mydata$mmm
1508635300049:library(magrittr)
1508635301726:mydata<-list(
1508635301728:mmm=1:5,
1508635301728:nn=c("dd","fff","ttt"),
1508635301729:dd=6:20
1508635301729:)
1508635301730:mydata %>% extract2(1)
1508635301732:mydata %>% `[[`(1)
1508635301733:mydata[[1]]
1508635301733:mydata$mmm
1508636017730:√
1508636020176:#输出年份：
1508636020177:format(Sys.Date(),format="%Y")  #[1] "2017"
1508636020194:format(Sys.Date(),format="%y")  #[1] "17"
1508636020195:#输出月份：
1508636020196:format(Sys.Date(),format="%b") #[1] "10月"
1508636020197:format(Sys.Date(),format="%B") #[1] "十月"
1508636020199:format(Sys.Date(),format="%m") #[1] "10"
1508636020200:#输出星期：
1508636020200:format(Sys.Date(),format="%A") #[1] "星期二"
1508636020201:format(Sys.Date(),format="%a") #[1] "周二"#
1508636020202:自定义输出：
1508636020203:format(Sys.Date(),format="%Y年%m月%d日")
1508636020206:#[1] "2017年10月03日"
1508636146113:as.POSIXlt("03/10月/2017 12:09:30",format="%d/%b/%Y %H:%M:%S")
1508636150949:as.POSIXlt("03/10/2017 12:09:30",format="%d/%b/%Y %H:%M:%S")
1508636173623:as.POSIXct("03/10/2017 12:09:30",format="%d/%b/%Y %H:%M:%S")
1508636191615:as.POSIXct("03/Oct/2017 12:09:30",format="%d/%b/%Y %H:%M:%S")
1508637595611:pipeline(mtcars$mpg,
1508637595614:sample(size = 10000, replace = TRUE),
1508637595615:density(kernel = "gaussian"),
1508637595616:plot(col = "red", main = "density of mpg (bootstrap)"))
1508637600985:pipeline(mtcars$mpg,
1508637600987:sample(size = 10000, replace = TRUE),
1508637600988:density(kernel = "gaussian"),
1508637600989:plot(col = "red", main = "density of mpg (bootstrap)"))
1508637611669:pipeline(
1508637611672:mtcars$mpg,
1508637611674:sample(size = 10000, replace = TRUE),
1508637611675:density(kernel = "gaussian"),
1508637611676:plot(col = "red", main = "density of mpg (bootstrap)")
1508637611677:)
1508637635721:pipeline(
1508637635722:mtcars$mpg,
1508637635723:sample(size = 10000, replace = TRUE),
1508637635723:density(kernel = "gaussian"),
1508637635724:plot(col = "red", main = "density of mpg (bootstrap)")
1508637635725:)
1508637663769:pipeline({
1508637663771:mtcars$mpg
1508637663771:sample(size = 10000, replace = TRUE)
1508637663772:density(kernel = "gaussian")
1508637663772:plot(col = "red", main = "density of mpg (bootstrap)")
1508637663774:})
1508637669582:sample(size = 100, replace = TRUE)
1508637673935:pipeline({
1508637673936:mtcars$mpg
1508637673937:sample(size = 100, replace = TRUE)
1508637673937:density(kernel = "gaussian")
1508637673938:plot(col = "red", main = "density of mpg (bootstrap)")
1508637673938:})
1508637682852:mtcars$mpg
1508637683675:sample(size = 100, replace = TRUE)
1508637693055:pipeline(
1508637693057:mtcars$mpg,
1508637693059:sample(., size = 10000, replace = TRUE),
1508637693060:density(kernel = "gaussian"),
1508637693061:plot(col = "red", main = "density of mpg (bootstrap)")
1508637693062:)
1508637699204:pipeline({
1508637699205:mtcars$mpg
1508637699205:sample(., size = 100, replace = TRUE)
1508637699206:density(kernel = "gaussian")
1508637699206:plot(col = "red", main = "density of mpg (bootstrap)")
1508637699207:})
1508637701451:sample(., size = 100, replace = TRUE)
1508637704235:pipeline(
1508637704236:mtcars$mpg,
1508637704237:sample(., size = 10000, replace = TRUE),
1508637704238:density(kernel = "gaussian"),
1508637704238:plot(col = "red", main = "density of mpg (bootstrap)")
1508637704238:)
1508638437568:pipeline(
1508638437571:mtcars$mpg,
1508638437573:sample(., size = 10000, replace = TRUE),
1508638437574:density(kernel = "gaussian"),
1508638437575:plot(col = "red", main = "density of mpg (bootstrap)")
1508638437575:)
1508638441879:pipeline(
1508638441879:mtcars$mpg,
1508638441880:sample(., size = 1000, replace = TRUE),
1508638441880:density(kernel = "gaussian"),
1508638441881:plot(col = "red", main = "density of mpg (bootstrap)")
1508638441881:)
1508640974392:install.packages("formattable")
1508640998000:library(formattable)
1508640998039:formattable(df, list(
1508640998039:age = color_tile("white", "orange"),
1508640998040:grade = formatter("span", style = x ~ ifelse(x == "A",
1508640998040:style(color = "green", font.weight = "bold"), NA)),
1508640998041:area(col = c(test1_score, test2_score)) ~ normalize_bar("pink", 0.2),
1508640998042:final_score = formatter("span",
1508640998043:style = x ~ style(color = ifelse(rank(-x) <= 3, "green", "gray")),
1508640998044:x ~ sprintf("%.2f (rank: %02d)", x, rank(-x))),
1508640998045:registered = formatter("span",
1508640998046:style = x ~ style(color = ifelse(x, "green", "red")),
1508640998047:x ~ icontext(ifelse(x, "ok", "remove"), ifelse(x, "Yes", "No")))
1508640998048:))
1508641016485:df <- data.frame(
1508641016486:id = 1:10,
1508641016487:name = c("Bob", "Ashley", "James", "David", "Jenny",
1508641016487:"Hans", "Leo", "John", "Emily", "Lee"),
1508641016487:age = c(28, 27, 30, 28, 29, 29, 27, 27, 31, 30),
1508641016488:grade = c("C", "A", "A", "C", "B", "B", "B", "A", "C", "C"),
1508641016489:test1_score = c(8.9, 9.5, 9.6, 8.9, 9.1, 9.3, 9.3, 9.9, 8.5, 8.6),
1508641016490:test2_score = c(9.1, 9.1, 9.2, 9.1, 8.9, 8.5, 9.2, 9.3, 9.1, 8.8),
1508641016491:final_score = c(9, 9.3, 9.4, 9, 9, 8.9, 9.25, 9.6, 8.8, 8.7),
1508641016491:registered = c(TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, TRUE, FALSE, FALSE, FALSE),
1508641016492:stringsAsFactors = FALSE)
1508641017893:library(formattable)
1508641017894:formattable(df, list(
1508641017895:age = color_tile("white", "orange"),
1508641017896:grade = formatter("span", style = x ~ ifelse(x == "A",
1508641017896:style(color = "green", font.weight = "bold"), NA)),
1508641017897:area(col = c(test1_score, test2_score)) ~ normalize_bar("pink", 0.2),
1508641017898:final_score = formatter("span",
1508641017899:style = x ~ style(color = ifelse(rank(-x) <= 3, "green", "gray")),
1508641017900:x ~ sprintf("%.2f (rank: %02d)", x, rank(-x))),
1508641017901:registered = formatter("span",
1508641017902:style = x ~ style(color = ifelse(x, "green", "red")),
1508641017902:x ~ icontext(ifelse(x, "ok", "remove"), ifelse(x, "Yes", "No")))
1508641017903:))
1508642241623:install.packages("lintr")
1508642378985:library(lintr)
1508642404219:# in class project
1508642404221:library(tidyverse)
1508644371249:system("python test.py")
1508645414805:library(lintr)
1508646303511:install.packages("lambda.r")
1508646317207:library(lambda.r)
1508646328751:fib(n) %as% { fib(n-1) + fib(n-2) }
1508646331469:fib
1508646351368:fib(0) %as% 1
1508646364360:fib(1) %as% 1
1508646375099:fib(n) %when% { n >= 0 } %as% { fib(n-1) + fib(n-2) }
1508646379048:fib
1508646980981:library(lintr)
1508647043743:na.omit %>%
1508647043746:filter(facenumber_in_poster != 0)
1508647198962:library(lintr)
1508647222118:libray(lintr)
1508647229491:library(lintr)
1508647245244:ls
1508647248712:dir()
1508647259801:lintr("in_class_project.R")
1508647264612:lint("in_class_project.R")
1508647749820:x <- Integer(5)
1508647749822:x %isa% Integer
1508647759282:library(lambda.r)
1508647760540:x <- Integer(5)
1508647760541:x %isa% Integer
1508647771224:Integer(x) %as% x
1508647772572:x <- Integer(5)
1508647772574:x %isa% Integer
1508647776240:x
1508647782011:fib(n) %as% { fib(n-1) + fib(n-2) }
1508647789055:fib(n) %when% { n >= 0 } %as% { fib(n-1) + fib(n-2) }
1508647794712:fib(0) %as% 1
1508647794723:fib(1) %as% 1
1508647799939:fib(n) %when% {
1508647799940:is.numeric(n)
1508647799940:n >= 0
1508647799940:} %as% { fib(n-1) + fib(n-2) }
1508647802994:f(1)
1508647806714:fib(22)
1508647810373:fib(1)
1508647813325:fib(2)
1508647820943:fib
1508647838523:fib(n) %when% { n >= 0 } %as% { fib(n-1) + fib(n-2) }
1508647840104:fib(1)
1508647848679:fib(1) %as% 1
1508647850375:fib(1)
1508647877472:library(lambda.r)
1508647879051:fib(n) %as% { fib(n-1) + fib(n-2) }
1508647881719:fib(1)
1508647977322:q()
1508649559353:library(lambda.r)
1508649567867:fib(n) %as% { fib(n-1) + fib(n-2) }
1508649574785:fib(0) %as% 1
1508649574797:fib(1) %as% 1
1508649578339:fib(n) %when% { n >= 0 } %as% { fib(n-1) + fib(n-2) }
1508649583153:fib(n) %when% {
1508649583154:is.numeric(n)
1508649583154:n >= 0
1508649583155:} %as% { fib(n-1) + fib(n-2) }
1508649584839:f(2)
1508649587717:fib(2)
1508649658346:ulimit -s
1508649763162:library(lambda.r)
1508649763709:fib(n) %::% numeric : numeric
1508649767322:fib(n) %::% Integer : numeric
1508649770289:make.gen(n) %::% numeric : Function
1508649773067:fib(2)
1508649802048:Temperature(x, system, units) %as%
1508649802049:{
1508649802050:x@system <- system
1508649802052:x@units <- units
1508649802053:x
1508649802055:}
1508649807929:freezing(x) %::% Temperature : logical
1508649807946:freezing(x) %when% {
1508649807947:x@system == 'metric'
1508649807947:x@units == 'celsius'
1508649807948:} %as% {
1508649807949:if (x < 0) { TRUE }
1508649807950:else { FALSE }
1508649807950:}
1508649816614:Temperature(x, system="metric", units='celsius') %as%
1508649816615:{
1508649816616:x@system <- system
1508649816616:x@units <- units
1508649816616:x
1508649816617:}
1508649821784:Temperature(20)
1508650203987:?safely
1508722503376:library(purrr)
1508722518334:n <- c(1, 3, 5)
1508722525953:mu <- c(1, 2, 3)
1508722540034:sigma <- c(1, 2, 1)
1508722560435:pmap(n, mu, sigma, rnorm)
1508722576215:args <- list(n, mu, sigma)
1508722577208:pmap(n, mu, sigma, rnorm)
1508722595179:n %<>% as.list
1508722603574:library(magrittr)
1508722604690:n %<>% as.list
1508722613322:mu %<>% as.list()
1508722632342:sigma %<>%  as.list()
1508722637142:pmap(n, mu, sigma, rnorm)
1508722644881:args <- list(n, mu, sigma)
1508722654954:pmap(args, rnorm)
1508722685211:map(c(1, 2,3), rnorm)
1508722697135:map(list(1, 2,3), rnorm)
1508722745527:args <- list(c(1, 2, 3), n(1,2,3), c(1,2,1))
1508722749064:args <- list(c(1, 2, 3), c(1,2,3), c(1,2,1))
1508722750643:map(list(1, 2,3), rnorm)
1508722754022:pmap(args, rnorm)
1508722756426:args
1508722768549:args %>% pmap(nnorm)
1508722772417:args %>% pmap(rnorm)
1508722803836:args <- list(c(1, 2, 3, 3), c(1,2,3), c(1,2,1))
1508722805869:args %>% pmap(rnorm)
1508722838918:args <- list(list(1, 2, 3, 3), list(1,2,3),list(1,2,1))
1508722840367:args %>% pmap(rnorm)
1508724056347:f <- c("runif", "rnorm", "rpois")
1508724056349:param <- list(
1508724056349:list(min = -1, max = 1),
1508724056351:list(sd = 5),
1508724056352:list(lambda = 10),
1508724056353:list(n = list(1,2,3,4))
1508724056353:)
1508724065111:invoke_map(f, param) %>% str()
1508724074904:f <- c("runif", "rnorm", "rpois")
1508724074905:param <- list(
1508724074906:list(min = -1, max = 1),
1508724074906:list(sd = 5),
1508724074907:list(lambda = 10),
1508724074907:list(n = list(1,2,3))
1508724074907:)
1508724076115:invoke_map(f, param) %>% str()
1508724095089:f <- c("runif", "rnorm", "rpois")
1508724095090:param <- list(
1508724095091:list(min = -1, max = 1),
1508724095091:list(sd = 5),
1508724095092:list(lambda = 10),
1508724095093:list(n = list(1,2,3))
1508724095093:)
1508724152352:f <- c("runif", "rnorm", "rpois")
1508724152353:param <- list(
1508724152353:list(min = -1, max = 1, n = 3),
1508724152354:list(sd = 5, n = 4),
1508724152354:list(lambda = 10, n = 5)
1508724152355:)
1508724154821:invoke_map(f, param) %>% str()
1508724203661:sim <- dplyr::frame_data(
1508724203662:~f,      ~params,
1508724203663:"runif", list(min = -1, max = -1),
1508724203663:"rnorm", list(sd = 5),
1508724203664:"rpois", list(lambda = 10)
1508724203666:)
1508724204788:sim
1508724220207:?frame_data
1508724251736:sim <- tibble(
1508724251737:~f,      ~params,
1508724251738:"runif", list(min = -1, max = -1),
1508724251738:"rnorm", list(sd = 5),
1508724251738:"rpois", list(lambda = 10)
1508724251739:)
1508724262477:sim <- as_tibble(
1508724262478:~f,      ~params,
1508724262479:"runif", list(min = -1, max = -1),
1508724262480:"rnorm", list(sd = 5),
1508724262480:"rpois", list(lambda = 10)
1508724262481:)
1508724275108:sim <- tibble::tibble(
1508724275109:~f,      ~params,
1508724275109:"runif", list(min = -1, max = -1),
1508724275110:"rnorm", list(sd = 5),
1508724275110:"rpois", list(lambda = 10)
1508724275111:)
1508724293880:sim <- frame_data(
1508724293881:~f,      ~params,
1508724293881:"runif", list(min = -1, max = -1),
1508724293882:"rnorm", list(sd = 5),
1508724293882:"rpois", list(lambda = 10)
1508724293883:)
1508724298435:?frame_data
1508724329154:sim <- data_frame(
1508724329155:~f,      ~params,
1508724329156:"runif", list(min = -1, max = -1),
1508724329156:"rnorm", list(sd = 5),
1508724329156:"rpois", list(lambda = 10)
1508724329157:)
1508724333581:?frame
1508724341089:?frame_data
1508724377317:sim <- tibble_(
1508724377318:~f,      ~params,
1508724377319:"runif", list(min = -1, max = -1),
1508724377319:"rnorm", list(sd = 5),
1508724377320:"rpois", list(lambda = 10)
1508724377320:)
1508724380857:sim <- tibble(
1508724380858:~f,      ~params,
1508724380858:"runif", list(min = -1, max = -1),
1508724380859:"rnorm", list(sd = 5),
1508724380859:"rpois", list(lambda = 10)
1508724380860:)
1508724392825:tribble(
1508724392825:~x,  ~y,
1508724392826:"a", 1:3,
1508724392826:"b", 4:6
1508724392827:)
1508724412878:sim <- tibble(
1508724412879:~f,      ~params,
1508724412879:"runif", list(min = -1, max = -1),
1508724412880:"rnorm", list(sd = 5),
1508724412880:"rpois", list(lambda = 10)
1508724412880:)
1508724423794:sim <- tibble(
1508724423795:~ f,      ~ params,
1508724423796:"runif", list(min = -1, max = -1),
1508724423796:"rnorm", list(sd = 5),
1508724423797:"rpois", list(lambda = 10)
1508724423797:)
1508724460747:sim
1508724484467:sim %>% dplyr::mutate(
1508724484474:samples = invoke_map(f, params, n = 10)
1508724484475:)
1508724503917:sim %>% dplyr::mutate(
1508724503918:samples = invoke_map(f, params, n = 10)
1508724503919:) %>% unnest()
1508724520500:sim %>% dplyr::mutate(
1508724520502:samples = invoke_map(f, params, n = 10)
1508724520502:) %>% select(samples)
1508724527269:sim %>% dplyr::mutate(
1508724527270:samples = invoke_map(f, params, n = 10)
1508724527270:) %>% select(samples) %>% unest
1508724532458:sim %>% dplyr::mutate(
1508724532460:samples = invoke_map(f, params, n = 10)
1508724532461:) %>% select(samples) %>% unnest
1508724631238:plots <- mtcars %>%
1508724631239:split(.$cyl) %>%
1508724631240:map(~ggplot(., aes(mpg, wt)) + geom_point())
1508724633104:plots
1508724654801:print(plots)
1508724661186:View(plots)
1509075040971:ls
1509144852660:gl(3, 10)
1509144860046:?gl
1509149149989:gl(2, 1, 10)
1509149152816:gl(2, 3, 10)
1509149162176:gl(3, 3, 10)
1509149281422:library(datasets)
1509149290938:head(airquality)
1509149308852:airquality %>%
1509149308853:split(~.$Month)
1509149352132:airquality %>%
1509149352133:split(~.$Month)
1509149363523:airquality %>%
1509149363524:split(~$Month)
1509149377789:library(purrr)
1509149381052:airquality %>%
1509149381054:split(~.$dMonth)
1509149400573:class(airquality)
1509149413869:airquality %<>% as.tibble
1509149420301:library(magrittr)
1509149421175:airquality %<>% as.tibble
1509149424514:dairquality %>%
1509149424516:split(~.$dMonth)
1509149429048:airquality %>%
1509149429050:split(~.$dMonth)
1509149438520:airquality %>%
1509149438522:split(~.$Month)
1509149457079:split(airquality, airquality$Month)
1509201524892:mean
1509201530141:sd
1509201576027:gcb
1509201585382:lm
1509201586720:glm
1509216618394:getwd()
1509216620636:cd ..
1509216630491:setwd("../512-50/")
1509216632009:ls
1509216633136:dir
1509216634821:dir()
1509216647281:install.packages("editR")
1509216653631:library(editR)
1509216816041:render("ProblemSet_1.Rmd")
1509217113123:mtcars
1509217256832:knitr::opts_chunk$set(echo = TRUE)
1509217256836:library(tidyverse)
1509217257001:# place the code to import graphics here
1509217257002:mtcars %>%
1509217257004:ggplot(aes(gear)) +
1509217257005:geom_bar()
1509217345215:# place the code to import graphics here
1509217345217:mtcars %>%
1509217345219:ggplot(aes(gear)) +
1509217345220:facet_wrap(. ~ cyl) +
1509217345222:geom_bar()
1509217374544:# place the code to import graphics here
1509217374546:mtcars %>%
1509217374548:ggplot(aes(gear)) +
1509217374549:facet_grid(. ~ cyl) +
1509217374551:geom_bar()
1509217412389:# place the code to import graphics here
1509217412391:mtcars %>%
1509217412393:ggplot(aes(wt, mpg)) +
1509217412394:geom_point()
1509217580128:# place the code to import graphics here
1509217580130:mtcars %>%
1509217580132:ggplot(aes(gear)) +
1509217580133:geom_bar(stat = "identity")
1509217606853:# place the code to import graphics here
1509217606855:mtcars %>%
1509217606856:ggplot(aes(gear, fill = cyl)) +
1509217606858:geom_bar(stat = "identity")
1509217616800:# place the code to import graphics here
1509217616802:mtcars %>%
1509217616803:ggplot(aes(y = gear, fill = cyl)) +
1509217616804:geom_bar(stat = "identity")
1509217627026:# place the code to import graphics here
1509217627028:mtcars %>%
1509217627030:ggplot(aes(x = "", y = gear, fill = cyl)) +
1509217627032:geom_bar(stat = "identity")
1509217645290:# place the code to import graphics here
1509217645292:mtcars %>%
1509217645295:ggplot(aes(x = gear, y = cyl)) +
1509217645296:geom_bar(stat = "identity")
1509217695984:ggplot(aes(x = gear, y = "", fill = cyl) +
1509217702382:geom_bar(stat = "identity")
1509217707935:# place the code to import graphics here
1509217707937:mtcars %>%
1509217707938:ggplot(aes(x = gear, y = "", fill = cyl)) +
1509217707940:geom_bar(stat = "identity")
1509217768722:# place the code to import graphics here
1509217768725:mtcars %>%
1509217768726:ggplot(aes(gear, fill = cyl)) +
1509217768728:geom_bar(stat = "identity")
1509217781030:# place the code to import graphics here
1509217781032:mtcars %>%
1509217781033:ggplot(aes(gear, fill = cyl)) +
1509217781035:geom_bar)
1509217790455:# place the code to import graphics here
1509217790458:mtcars %>%
1509217790460:ggplot(aes(gear, fill = cyl)) +
1509217790461:geom_bar()
1509217844248:# place the code to import graphics here
1509217844250:mtcars %>%
1509217844253:ggplot(aes(gear)) +
1509217844254:geom_bar(aes(fill = cyl))
1509217849495:mtcars
1509217874992:mpg
1509217971894:mtcars %>%
1509217971895:ggplot(aes(gear)) +
1509217971896:geom_bar(aes(fill = cyl))
1509218007714:g <- ggplot(mpg, aes(class))
1509218019996:g + geom_bar(aes(fill = drv))
1509218024152:mpg
1509218049308:# place the code to import graphics here
1509218049310:mtcars %>%
1509218049312:ggplot(aes(gear)) +
1509218049314:geom_bar(aes(fill = as.character(cyl)))
1509218057832:# place the code to import graphics here
1509218057834:mtcars %>%
1509218057836:ggplot(aes(gear)) +
1509218057837:geom_bar(aes(fill = as.character(cyl)))
1509218170303:# place the code to import graphics here
1509218170306:mtcars %>%
1509218170307:ggplot(aes(gear, fill = as.character(cyl))) +
1509218170309:geom_bar(positiion = "dodge")
1509218194688:# place the code to import graphics here
1509218194690:mtcars %>%
1509218194692:ggplot(aes(gear, fill = as.character(cyl))) +
1509218194694:geom_bar(position = position_dodge(preserve = "single"))
1509218210531:# place the code to import graphics here
1509218210533:mtcars %>%
1509218210536:ggplot(aes(gear, fill = as.character(cyl))) +
1509218210538:geom_bar(position = position_dodge(preserve = "single"))
1509218219009:# place the code to import graphics here
1509218219011:mtcars %>%
1509218219012:ggplot(aes(gear, fill = factor(cyl))) +
1509218219013:geom_bar(position = position_dodge(preserve = "single"))
1509218224994:# place the code to import graphics here
1509218224996:mtcars %>%
1509218224999:ggplot(aes(gear, fill = factor(cyl))) +
1509218225000:geom_bar()
1509218238823:# place the code to import graphics here
1509218238824:mtcars %>%
1509218238826:ggplot(aes(gear, fill = factor(cyl))) +
1509218238827:geom_bar(position = "dodge")
1509218244547:mtcars %>%
1509218244548:ggplot(aes(gear, fill = factor(cyl))) +
1509218244549:geom_bar(position = "dodge")
1509218254153:mtcars
1509218323898:# place the code to import graphics here
1509218323901:mtcars %>%
1509218323903:ggplot(aes(gear, fill = factor(cyl))) +
1509218323904:geom_bar(position_dodge(width = 2))
1509218351904:# place the code to import graphics here
1509218351906:mtcars %>%
1509218351908:ggplot(aes(factor(gear), fill = factor(cyl))) +
1509218351910:geom_bar(position_dodge(width = 2))
1509218381274:mtcars %>% ggplot(aes(gear, fill = factor(cyl)))
1509218407691:ggplot(mtcars, aes(factor(cyl), fill = factor(vs))) +
1509218407693:geom_bar(position = position_dodge(preserve = "single"))
1509218426454:ggplot(mtcars, aes(factor(cyl), fill = factor(vs))) +
1509218426455:geom_bar(position_dodge())
1509218430100:ggplot(mtcars, aes(factor(cyl), fill = factor(vs))) +
1509218430101:geom_bar(position_dodge())
1509218442246:mtcars %>%
1509218442247:ggplot(aes(wt, mpg)) +
1509218442247:geom_point()
1509218461672:# place the code to import graphics here
1509218461674:mtcars %>%
1509218461676:ggplot(aes(gear, fill = factor(cyl))) +
1509218461678:geom_bar(position_dodge(width = 2))
1509218467865:# place the code to import graphics here
1509218467867:mtcars %>%
1509218467868:ggplot(aes(gear, fill = factor(cyl))) +
1509218467870:geom_bar(position_dodge())
1509218471547:# place the code to import graphics here
1509218471549:mtcars %>%
1509218471550:ggplot(aes(gear, fill = factor(cyl))) +
1509218471552:geom_bar()
1509218514860:# place the code to import graphics here
1509218514864:mtcars %>%
1509218514865:ggplot(aes(gear, fill = factor(cyl))) +
1509218514867:geom_bar(stat = "ideneityd", position = position_dodge())
1509218521510:# place the code to import graphics here
1509218521511:mtcars %>%
1509218521513:ggplot(aes(gear, fill = factor(cyl))) +
1509218521516:geom_bar(stat = "ideneity", position = position_dodge())
1509218526087:# place the code to import graphics here
1509218526089:mtcars %>%
1509218526090:ggplot(aes(gear, fill = factor(cyl))) +
1509218526092:geom_bar(stat = "identity", position = position_dodge())
1509218549394:# place the code to import graphics here
1509218549396:mtcars %>%
1509218549397:ggplot(aes(gear, fill = factor(cyl))) +
1509218549399:geom_bar(position = position_dodge())
1509218565269:# place the code to import graphics here
1509218565271:mtcars %>%
1509218565272:ggplot(aes(gear, fill = factor(cyl))) +
1509218565274:geom_bar(position = position_dodge(width = 0.3))
1509218592955:# place the code to import graphics here
1509218592957:mtcars %>%
1509218592960:ggplot(aes(gear, fill = factor(cyl))) +
1509218592962:geom_bar(position = position_dodge(width = 0.3), color = "black")
1509218614582:# place the code to import graphics here
1509218614583:mtcars %>%
1509218614585:ggplot(aes(gear, fill = factor(cyl))) +
1509218614587:geom_bar(position = "dodge")
1509218698630:?geom_bar
1509218712834:# place the code to import graphics here
1509218712836:mtcars %>%
1509218712838:ggplot(aes(gear, fill = factor(cyl))) +
1509218712840:geom_bar(position = "dodge", width = 0.1)
1509218718718:# place the code to import graphics here
1509218718720:mtcars %>%
1509218718722:ggplot(aes(gear, fill = factor(cyl))) +
1509218718724:geom_bar(position = "dodge", width = 0.5)
1509218924317:mtcars
1509218950297:# place the code to import graphics here
1509218950299:mtcars %>%
1509218950302:ggplot(aes(x = "", y = carb)) +
1509218950303:coord_polar("y", start = 0)
1509218969679:# place the code to import graphics here
1509218969681:mtcars %>%
1509218969683:ggplot(aes(x = "", y = carb, fill = carb)) +
1509218969685:coord_polar("y", start = 0)
1509219001680:# place the code to import graphics here
1509219001682:mtcars %>%
1509219001685:ggplot(aes(x = "", y = carb)) +
1509219001686:coord_polar("y", start = 0, stat = "identity")
1509219051279:# place the code to import graphics here
1509219051282:mtcars %>%
1509219051284:ggplot(aes(x = factor(1), fill = carb)) +
1509219051285:coord_polar("y", start = 0)
1509219059065:# place the code to import graphics here
1509219059067:mtcars %>%
1509219059068:ggplot(aes(x = factor(1), fill = carb)) +
1509219059070:coord_polar("x", start = 0)
1509219084807:# place the code to import graphics here
1509219084809:mtcars %>%
1509219084810:ggplot(aes(x = factor(1), fill = carb)) +
1509219084811:geom_bar() +
1509219084813:coord_polar("x", start = 0)
1509219104713:ggplot(PlantGrowth, aes(x=factor(1), fill=group))+
1509219104714:geom_bar(width = 1)+
1509219104714:coord_polar("y")
1509219107702:mtcars
1509219118104:# place the code to import graphics here
1509219118105:mtcars %>%
1509219118107:ggplot(aes(x = factor(1), fill = factor(carb))) +
1509219118108:geom_bar() +
1509219118109:coord_polar("x", start = 0)
1509219122193:# place the code to import graphics here
1509219122194:mtcars %>%
1509219122196:ggplot(aes(x = factor(1), fill = factor(carb))) +
1509219122197:geom_bar() +
1509219122198:coord_polar("x", start = 0)
1509219134114:# place the code to import graphics here
1509219134115:mtcars %>%
1509219134116:ggplot(aes(x = factor(1), fill = factor(carb))) +
1509219134119:coord_polar("x", start = 0)
1509219143204:# place the code to import graphics here
1509219143205:mtcars %>%
1509219143207:ggplot(aes(x = factor(1), fill = factor(carb))) +
1509219143208:geom_bar() +
1509219143210:coord_par("x", start = 0)
1509219155413:# place the code to import graphics here
1509219155414:mtcars %>%
1509219155416:ggplot(aes(x = factor(1), fill = factor(carb))) +
1509219155419:geom_bar() +
1509219155421:coord_polar("x")
1509219166493:# place the code to import graphics here
1509219166495:mtcars %>%
1509219166496:ggplot(aes(x = factor(1), fill = factor(carb))) +
1509219166497:geom_bar(width = 1) +
1509219166499:coord_polar("x")
1509219187783:ggplot(PlantGrowth, aes(x=factor(1), fill=group))+
1509219187784:geom_bar(width = 1)+
1509219187785:coord_polar("y")
1509219211553:PlantGrowth %>% tibble()
1509219213769:PlantGrowth %>% tibble(.)
1509219217254:PlantGrowth %>% as.tibble()
1509219229622:mtcars %>% as.tibble()
1509219245080:factor(mtcars$carb)
1509219250896:factor(mtcars$carb) %>% class
1509219265772:# place the code to import graphics here
1509219265774:mtcars %>%
1509219265776:ggplot(aes(x = factor(1), fill = factor(carb))) +
1509219265778:coord_polar("x")
1509219277589:# place the code to import graphics here
1509219277591:mtcars %>%
1509219277593:ggplot(aes(x = factor(1), fill = factor(carb))) +
1509219277594:geom_bar(width = 1) +
1509219277596:coord_polar("y")
1509219305076:# place the code to import graphics here
1509219305078:mtcars %>%
1509219305080:ggplot(aes(x = factor(1), fill = factor(carb))) +
1509219305083:geom_bar(width = 1) +
1509219305084:coord_polar("y") +
1509219305086:scale_fill_brewer(palette="Dark2")
1509219319217:# place the code to import graphics here
1509219319219:mtcars %>%
1509219319221:ggplot(aes(x = factor(1), fill = factor(carb))) +
1509219319223:geom_bar(width = 1) +
1509219319225:coord_polar("y") +
1509219319231:scale_fill_brewer(palette = "Set1")
1509219342083:# place the code to import graphics here
1509219342085:mtcars %>%
1509219342086:ggplot(aes(x = factor(1), fill = carb)) +
1509219342088:geom_bar(width = 1) +
1509219342089:coord_polar("y") +
1509219342091:scale_fill_brewer(palette = "Set1")
1509219346423:factor
1509219349438:# place the code to import graphics here
1509219349440:mtcars %>%
1509219349441:ggplot(aes(x = factor(1), fill = factor(carb))) +
1509219349442:geom_bar(width = 1) +
1509219349444:coord_polar("y") +
1509219349446:scale_fill_brewer(palette = "Set1")
1509219454727:# place the code to import graphics here
1509219454729:mtcars %>%
1509219454730:ggplot(aes(wt, mpg)) +
1509219454731:geom_point(aes(fill = factor(cyl)))
1509219461163:# place the code to import graphics here
1509219461164:mtcars %>%
1509219461166:ggplot(aes(wt, mpg)) +
1509219461168:geom_point(aes(color = factor(cyl)))
1509219504696:# place the code to import graphics here
1509219504698:mtcars %>%
1509219504700:ggplot(aes(wt, mpg)) +
1509219504701:geom_point(aes(color = factor(cyl), size = vs))
1509219527296:# place the code to import graphics here
1509219527297:mtcars %>%
1509219527299:ggplot(aes(wt, mpg)) +
1509219527300:geom_point(aes(color = factor(cyl), size = hp))
1509219552667:# place the code to import graphics here
1509219552669:mtcars %>%
1509219552671:ggplot(aes(wt, mpg)) +
1509219552673:geom_point(aes(color = factor(cyl), size = qsec))
1509220574148:?aes
1509220804046:# place the code to import graphics here
1509220804049:mtcars %>%
1509220804052:ggplot(aes(x = factor(1), fill = factor(carb))) +
1509220804055:geom_bar(width = 1) +
1509220804058:coord_polar("y") +
1509220804060:scale_fill_brewer(palette = "Set2")
1509220811552:# place the code to import graphics here
1509220811553:mtcars %>%
1509220811555:ggplot(aes(x = factor(1), fill = factor(carb))) +
1509220811557:geom_bar(width = 1) +
1509220811559:coord_polar("y") +
1509220811561:scale_fill_brewer(palette = "Set1")
1509221247136:x <- 1
1509221248287:x
1509221252030:x <--1
1509221254496:x
1509221260558:x <- -1
1509221341823:hist(mtcars$gear)
1509221357706:mtcars
1509221378770:?barplot
1509221571583:# place the code to import graphics here
1509221571585:mtcars %>%
1509221571587:ggplot(aes(gear, fill = factor(cyl))) +
1509221571590:geom_bar(position = "stacked", width = 0.5)
1509221574543:# place the code to import graphics here
1509221574545:mtcars %>%
1509221574547:ggplot(aes(gear, fill = factor(cyl))) +
1509221574548:geom_bar(position = "stack", width = 0.5)
1509221584817:# place the code to import graphics here
1509221584818:mtcars %>%
1509221584820:ggplot(aes(gear, fill = factor(cyl))) +
1509221584821:geom_bar(position = "dodge", width = 0.5)
1509415718797:clear
1509415728306:clean
1509415736397:clear
1509415739481:?clear
1509415741415:??clear
1509415747219:clean
1510022828689:library(datasets)
1510022831848:library(dplyr)
1510022842098:nycflights
1510022876660:library(nycflights13)
1510022887661:install.packages("nycflights13")
1510022910293:library(nycflights13)
1510022923699:nycflights13::flights
1510023006329:flights <- fread("https://raw.githubusercontent.com/wiki/arunsrinivasan/flights/NYCflights14/flights14.csv")
1510023010469:library(datasets)
1510023012440:flights <- fread("https://raw.githubusercontent.com/wiki/arunsrinivasan/flights/NYCflights14/flights14.csv")
1510023015991:?fread
1510023025767:library(data.table)
1510023045185:library(data.table)
1510023070124:flights <- fread("https://raw.githubusercontent.com/wiki/arunsrinivasan/flights/NYCflights14/flights14.csv")
1510023072487:library(data.table)
1510023074601:flights <- fread("https://raw.githubusercontent.com/wiki/arunsrinivasan/flights/NYCflights14/flights14.csv")
1510023094755:flights
1510023109885:dim(flights)
1510023265005:DT = data.table(ID = c("b","b","b","a","a","c"), a = 1:6, b = 7:12, c = 13:18)
1510023272129:DT
1510023291855:DT = data.table(ID = c("b","b","b","a","a","c"), a = 1:6, b = 7:12, c = 13:18)
1510023294128:library(data.table)
1510023294617:flights <- fread("https://raw.githubusercontent.com/wiki/arunsrinivasan/flights/NYCflights14/flights14.csv")
1510023298424:flights
1510023299028:dim(flights)
1510023299693:DT = data.table(ID = c("b","b","b","a","a","c"), a = 1:6, b = 7:12, c = 13:18)
1510023302592:DT
1510023317567:class(DT$ID)
1510028437299:getwd(getwd())
1510028439387:getwd()
1510029827503:ans <- flights[origin == "JFK" & month == 6L]
1510029830566:ans
1510029841657:head(ans)
1510029957668:ans <- flights[order(origin, -dest)]
1510029978401:ans
1510030112139:ans <- flights[, arr_delay]
1510030115288:ans
1510030119733:ans %>% haed
1510030123323:ans %>% head
1510030130412:head(ans)
1510030140854:ans <- flights[, list(arr_delay)]
1510030141290:head(ans)
1510030256870:ans <- flights[, .(arr_delay)]
1510030257237:head(ans)
1510030640383:ans <- flights[, .(delay_arr = arr_delay, delay_dep = dep_delay)]
1510030642406:ans
1510030650589:flights
1510030669591:library(data.table)
1510030669768:flights <- fread("https://raw.githubusercontent.com/wiki/arunsrinivasan/flights/NYCflights14/flights14.csv")
1510030673075:flights
1510030673095:dim(flights)
1510030673096:DT = data.table(ID = c("b","b","b","a","a","c"), a = 1:6, b = 7:12, c = 13:18)
1510030673098:DT
1510030673101:class(DT$ID)
1510030673102:ans <- flights[origin == "JFK" & month == 6L]
1510030673123:head(ans)
1510030673127:ans <- flights[order(origin, -dest)]
1510030673341:ans
1510030673791:ans <- flights[, .(arr_delay)]
1510030674170:head(ans)
1510030674545:ans <- flights[, .(delay_arr = arr_delay, delay_dep = dep_delay)]
1510030680683:flights
1510030682733:ans
1510031177225:ans <- flights[origin == "JFK" & month == 6L, .N]
1510031181712:ans
1510031341981:flights
1510031365930:ans <- flights[, c("arr_delay", "dep_delay"), with = FALSE]
1510031368074:ans
1510031394296:ans <- flights[, list(arr_delay, dep_delay)]
1510031394709:ans
1510031474212:ans <- flights[, list(-arr_delay, -dep_delay)]
1510031474663:ans
1510031486285:ans <- flights[, .(arr_delay, dep_delay)]
1510031486725:ans
1510099901145:getwd()
1510099942462:install.packages("xkcd")
1510099949952:library(xkcd)
1510100067879:theme_xkcd <- theme(
1510100067883:panel.background = element_rect(fill="white"),
1510100067885:axis.ticks = element_line(colour=NA),
1510100067887:panel.grid = element_line(colour="white"),
1510100067888:axis.text.y = element_text(colour=NA),
1510100067889:axis.text.x = element_text(colour="black"),
1510100067891:text = element_text(size=16, family="Humor Sans")
1510100067892:)
1510100078444:knitr::opts_chunk$set(echo = TRUE)
1510100078448:library(tidyverse)
1510100078637:# place the code to import graphics here
1510100078639:# add number of cylinders and 1/4 mile time into the plot
1510100078640:mtcars %>%
1510100078642:ggplot(aes(wt, mpg)) +
1510100078643:geom_point(aes(color = factor(cyl), size = qsec)) +
1510100078644:theme_xkcd
1510100105849:theme_xkcd <- theme(
1510100105851:panel.background = element_rect(fill="white"),
1510100105853:axis.ticks = element_line(colour=NA),
1510100105854:panel.grid = element_line(colour="white"),
1510100105855:axis.text.y = element_text(colour=NA),
1510100105856:axis.text.x = element_text(colour="black"),
1510100105857:text = element_text(size=16, family="Humor Sans")
1510100105858:)
1510100111524:# place the code to import graphics here
1510100111527:# add number of cylinders and 1/4 mile time into the plot
1510100111528:mtcars %>%
1510100111530:ggplot(aes(wt, mpg)) +
1510100111535:geom_point(aes(color = factor(cyl), size = qsec)) +
1510100111536:theme_xkcd
1510100138667:# place the code to import graphics here
1510100138669:# add number of cylinders and 1/4 mile time into the plot
1510100138671:mtcars %>%
1510100138672:ggplot(aes(wt, mpg)) +
1510100138673:geom_point(aes(color = factor(cyl), size = qsec)) +
1510100138675:xkcdaxis(xrange = range(mtcars$wt), yrange = range(mtcars$mpg)) +
1510100138676:theme(text = element_text(size = 20, family = "xkcd"))
1510100201120:# place the code to import graphics here
1510100201122:# add number of cylinders and 1/4 mile time into the plot
1510100201124:mtcars %>%
1510100201125:ggplot(aes(wt, mpg)) +
1510100201126:geom_point(aes(color = factor(cyl), size = qsec)) +
1510100201128:theme(axis.line = element_line(size=1, colour = "black"), panel.grid.major = element_blank(),
1510100201129:panel.grid.minor = element_blank(), panel.border = element_blank(),
1510100201131:panel.background = element_blank()) +
1510100201133:theme(plot.title=element_text(family="xkcd-Regular"), text=element_text(family="xkcd-Regular"),
1510100201135:axis.text.x=element_text(colour="black", size = 10),
1510100201136:axis.text.y=element_text(colour="black", size = 10),
1510100201138:legend.key=element_rect(fill="white", colour="white"))
1510100212547:library(extrafont)
1510100212549:download.file("http://simonsoftware.se/other/xkcd.ttf",
1510100212549:dest="xkcd.ttf", mode="wb")
1510100213374:system("mkdir ~/.fonts")
1510100213412:system("cp xkcd.ttf  ~/.fonts")
1510100213424:font_import(paths = "~/.fonts", pattern="[X/x]kcd")
1510100213429:loadfonts()
1510100225600:font_import(paths = "~/.fonts", pattern="[X/x]kcd")
1510100245226:loadfonts()
1510100248250:# place the code to import graphics here
1510100248252:# add number of cylinders and 1/4 mile time into the plot
1510100248253:mtcars %>%
1510100248255:ggplot(aes(wt, mpg)) +
1510100248256:geom_point(aes(color = factor(cyl), size = qsec)) +
1510100248257:theme(axis.line = element_line(size=1, colour = "black"), panel.grid.major = element_blank(),
1510100248259:panel.grid.minor = element_blank(), panel.border = element_blank(),
1510100248261:panel.background = element_blank()) +
1510100248263:theme(plot.title=element_text(family="xkcd-Regular"), text=element_text(family="xkcd-Regular"),
1510100248265:axis.text.x=element_text(colour="black", size = 10),
1510100248266:axis.text.y=element_text(colour="black", size = 10),
1510100248267:legend.key=element_rect(fill="white", colour="white"))
1510100271258:fill <- c("#56B4E9", "#ff69b4")
1510100271260:p1 <- ggplot() +
1510100271260:geom_line(aes(y = export, x = year, colour = product), size=1.5, data = charts.data,
1510100271261:stat="identity") +
1510100271261:theme(legend.position="bottom", legend.direction="horizontal",
1510100271262:legend.title = element_blank()) +
1510100271262:scale_x_continuous(breaks=seq(2006,2014,1)) +
1510100271263:labs(x="Year", y="USD million") +
1510100271263:ggtitle("Composition of Exports to China ($)") +
1510100271263:scale_color_manual(values=fill) +
1510100271264:theme(axis.line = element_line(size=1, colour = "black"), panel.grid.major = element_blank(),
1510100271264:panel.grid.minor = element_blank(), panel.border = element_blank(),
1510100271265:panel.background = element_blank()) +
1510100271265:theme(plot.title=element_text(family="xkcd-Regular"), text=element_text(family="xkcd-Regular"),
1510100271266:axis.text.x=element_text(colour="black", size = 10),
1510100271266:axis.text.y=element_text(colour="black", size = 10),
1510100271267:legend.key=element_rect(fill="white", colour="white"))
1510100388978:# place the code to import graphics here
1510100388980:# add number of cylinders and 1/4 mile time into the plot
1510100388981:mtcars %>%
1510100388983:ggplot(aes(wt, mpg)) +
1510100388984:geom_point(aes(color = factor(cyl), size = qsec)) +
1510100388985:theme(axis.line = element_line(size=1, colour = "black"), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.border = element_blank(), panel.background = element_blank()) +
1510100388987:theme(plot.title=element_text(family="xkcd-Regular"),text=element_text(family="xkcd-Regular"),axis.text.x=element_text(colour="black", size = 10), axis.text.y=element_text(colour="black", size = 10), legend.key=element_rect(fill="white", colour="white"))
1510100399298:# place the code to import graphics here
1510100399300:# add number of cylinders and 1/4 mile time into the plot
1510100399301:mtcars %>%
1510100399303:ggplot(aes(wt, mpg)) +
1510100399304:geom_point(aes(color = factor(cyl), size = qsec)) +
1510100399306:theme(axis.line = element_line(size=1, colour = "black"), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.border = element_blank(), panel.background = element_blank())
1510100422247:# place the code to import graphics here
1510100422249:mtcars %>%
1510100422251:ggplot(aes(x = factor(1), fill = factor(carb))) +
1510100422252:geom_bar(width = 1) +
1510100422253:coord_polar("y") +
1510100422255:scale_fill_brewer(palette = "Set1") +
1510100422256:theme(axis.line = element_line(size=1, colour = "black"), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.border = element_blank(), panel.background = element_blank())
1510100430753:# place the code to import graphics here
1510100430754:mtcars %>%
1510100430755:ggplot(aes(x = factor(1), fill = factor(carb))) +
1510100430757:geom_bar(width = 1) +
1510100430759:coord_polar("y") +
1510100430760:scale_fill_brewer(palette = "Set1")
1510100531430:# place the code to import graphics here
1510100531434:mtcars %>%
1510100531436:ggplot(aes(gear)) +
1510100531438:geom_bar() +
1510100531439:theme(axis.line = element_line(size=1, colour = "black"), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.border = element_blank(), panel.background = element_blank())
1510100680113:counts <- table(gear)                                                           # count the number of cars per gear
1510100681112:df <- as.data.frame.table(counts,                                       # convert the count table to a dataframe
1510100681112:responseName = "freq")
1510100683694:library(ggplot2)
1510100684067:attach(mtcars)
1510100684521:counts <- table(gear)                                                           # count the number of cars per gear
1510100686855:df <- as.data.frame.table(counts,                                       # convert the count table to a dataframe
1510100686856:responseName = "freq")
1510100687751:df1 <- as.data.frame.table(table(vs, gear),                     # create a dataframe of car by gears and engine type
1510100687753:responseName = "freq")
1510100688365:# basic bar graph
1510100688366:p1 <- ggplot(data=df, aes(x=gear, y=freq)) +
1510100688367:geom_bar(stat="identity")
1510100688955:print(p1)
1510100690822:# basic 2-variable bar graph
1510100690823:p2 <- ggplot(data=df1, aes(x=gear, y=freq, fill=vs)) +
1510100690823:geom_bar(stat="identity")
1510100691221:print(p2)
1510100692576:# basic line graph
1510100692577:p3 <- ggplot(data=df, aes(x=gear, y=freq, group=1)) +
1510100692577:geom_line()
1510100693872:print(p3)
1510100710689:df$xmin <- as.numeric(df$gear) - 0.1                            # where each bar should start on the x-axis
1510100711260:df$xmax <- as.numeric(df$gear) + 0.1                            # where each bar should end on the x-axis
1510100711775:df$ymin <- 1                                                                            # where each bar should start on the y-axis
1510100712510:df$ymax <- df$freq                                                                      # where each bar should end on the y-axis
1510100713193:xrange <- range(min(df$xmin) - 0.1,                             # specify the range of the x-axis
1510100713193:max(df$xmax) + 0.1)
1510100713686:yrange <- range(min(df$ymin),                                           # specify the range of the y-axis
1510100713688:max(df$ymax) + 1)
1510100714130:mapping <- aes(xmin=xmin,ymin=ymin,xmax=xmax,ymax=ymax)
1510100714615:p1 <- ggplot(data=df, aes(x=gear, y=freq)) +
1510100714616:xkcdrect(mapping,df) +                                                  # xkcd function to plot the bar shapes
1510100714617:xkcdaxis(xrange,yrange) +
1510100714619:xlab("number of gears") +
1510100714619:ylab("frequency") +
1510100714620:scale_x_discrete(labels=c(as.character(df$gear)))
1510100715574:print(p1)
1510100725728:install.packages("xkcd", dependencies=T)
1510100744679:install.packages("xkcd", dependencies = T)
1510100753708:library(sysfonts)
1510100753711:system("mkdir -p ~/.fonts")
1510100753723:download.file("http://simonsoftware.se/other/xkcd.ttf", dest="~/.fonts/xkcd.ttf", mode="wb")
1510100754241:download.file("http://dl.dropbox.com/u/12305244/Humor-Sans.ttf", dest="~/.fonts/Humor-Sans.ttf", mode="wb")
1510100755300:font.paths("~/.fonts")
1510100755303:font.add("xkcd", regular = "xkcd.ttf")
1510100755305:font.add("Humor Sans", regular = "Humor-Sans.ttf")
1510100781945:library(sysfonts)
1510100781946:download.file("http://simonsoftware.se/other/xkcd.ttf", dest="~/Library/Fonts/xkcd.ttf", mode="wb")
1510100782460:download.file("http://dl.dropbox.com/u/12305244/Humor-Sans.ttf", dest="~/Library/Fonts/Humor-Sans.ttf", mode="wb")
1510100783612:font.add("xkcd", regular = "xkcd.ttf")
1510100783613:font.add("Humor Sans", regular = "Humor-Sans.ttf")
1510102304994:R.version
1510102358453:whereis r
1510110681358:whereis R
1510110956152:licence()
1510110982231:system()
1510110997337:R.home()
1510111012038:R.home("bin")
1510111020881:file.path(R.home("bin"), "R")
1510111111658:system("type R")
1510111224675:R.home()
1510111232052:file.path(R.home("bin"), "R")
1510111234974:R.home()
1510111237406:system("type R")
1510111326565:file.path(R.home("bin"), "R")
1510111343545:.libPaths()
1510111379925:session_info()
1510111519238:install_github('andreacirilloac/updateR')
1510111576081:updateR(admin_password = '123123')
1510111582808:library(updateR)
1510111583723:updateR(admin_password = '123123')
1510111674759:ls
1510111852636:system("type R")
1510111857386:R.home()
1510112302592:Sys.getenv('R_HOME')
1510112488695:system("type R | xargs readlink")
1510112496195:system("ls")
1510112503043:system("type R")
1510112520016:?file.path
1510112905756:.libPaths()
1510113974209:getwd()
1510113978915:#!/usr/local/bin/Rscript
1510113978915:setwd("/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share")
1510113979405:source("src/Regression.R")
1510113998630:rmarkdown::render("report/report.Rmd")
1510114038654:knitr::opts_chunk$set(echo = F, warning = F, message = F, comment = "")
1510114038657:library(tidyverse)
1510114038659:library(rmarkdown)
1510114038664:library(knitr)
1510114038855:read_csv("./../data/201608_trip_data.csv", n_max = 10) %>%
1510114038857:DT::datatable(
1510114038858:head(., 10),
1510114038861:fillContainer = F, options = list(pageLength = 3, scrollX = T, dom = "tp"),
1510114038863:rownames = F
1510114038864:)
1510114040470:read_csv("./../data/201608_station_data.csv", n_max = 10) %>%
1510114040472:DT::datatable(
1510114040473:head(., 10),
1510114040475:fillContainer = F, options = list(pageLength = 3, scrollX = T, dom = "tp"),
1510114040476:rownames = F
1510114040477:)
1510114043573:read_csv("./../data/201608_weather_data.csv", n_max = 10) %>%
1510114043574:DT::datatable(
1510114043576:head(., 10),
1510114043577:fillContainer = F, options = list(pageLength = 3, scrollX = T, dom = "tp"),
1510114043579:rownames = F
1510114043580:)
1510114048616:read_chunk('../src/Regression.R')
1510114049615:p1
1510114052463:p2
1510114054921:p3
1510114058559:gridExtra::grid.arrange(p5, p6, ncol = 1)
1510114060738:l8
1510114063164:p7
1510114066654:t <- read_csv("./../data/201608_weather_data.csv") %T>% glimpse
1510114070563:formula1
1510114073825:s1$which[which.min(s1$cp),]
1510114075710:formula2
1510114077954:summary(fit)
1510114080085:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1510114080790:plot(fit)
1510114083581:p10
1510114088268:w1
1510114090545:summary(fit_holiday_adjust)
1510114091021:par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
1510114091866:plot(fit_holiday_adjust)
1510114102406:p4
1510114115831:rmarkdown::render("report/report.Rmd")
1510114137136:?render
1510114224716:devtools::install_github("rstudio/rmarkdown")
1510114240494:library(rmarkdown)
1510114243864:rmarkdown::render("report/report.Rmd")
1510114285517:source("src/Regression.R")
1510114303659:rmarkdown::render("report/report.Rmd")
1510114948311:Sys.getenv("RSTUDIO_PANDOC")
1510116942494:?rmarkdown::pandoc_available
1510116950396:pandoc_version()
1510116959743:if (pandoc_available())
1510116959744:cat("pandoc", as.character(pandoc_version()), "is available!\n")
1510116966393:if (pandoc_available("1.12.3"))
1510116966394:cat("requried version of pandoc is available!\n")
1510117741192:?knit
1510118251119:pandoc_version()
1510118256450:# knit("./report/report.Rmd", output = "./report/report.md")
1510118256451:rmarkdown::render("report/report.Rmd", "html_document", quiet = T)
1510118266120:source("src/Regression.R")
1510118285725:# knit("./report/report.Rmd", output = "./report/report.md")
1510118285726:rmarkdown::render("report/report.Rmd", "html_document", quiet = T)
1510118350774:pandoc_available(version = NULL, error = FALSE)
1510118385067:pckg("rmarkdown")
1510118391430:rmarkdown_format()
1510118410461:# knit("./report/report.Rmd", output = "./report/report.md")
1510118410463:rmarkdown::render("report/report.Rmd", "html_document", quiet = T)
1510119062637:pandoc_version()
1510119070416:Sys.getenv("RSTUDIO_PANDOC")
1510120341362:# knit("./report/report.Rmd", output = "./report/report.md")
1510120341364:rmarkdown::render("report/report.Rmd", "html_document")
1510120345480:source("src/Regression.R")
1510120365882:# knit("./report/report.Rmd", output = "./report/report.md")
1510120365883:rmarkdown::render("report/report.Rmd", "html_document")
1510120553247:rmarkdown:::find_pandoc()
1510120567630:rmarkdown::find_external_resources()
1510120574011:as.list(rmarkdown:::.pandoc)
1510120724561:Sys.getenv("RSTUDIO_PANDOC")
1510120767885:Sys.setenv(RSTUDIO_PANDOC="/usr/local/bin")
1510120769483:Sys.getenv("RSTUDIO_PANDOC")
1510120815206:# knit("./report/report.Rmd", output = "./report/report.md")
1510120815207:rmarkdown::render("report/report.Rmd", "html_document")
1510121173847:environment()
1510121178757:list.dirs()
1510121190098:installed.packages()
1510121233811:rmarkdown::pandoc_available()
1510121238927:pandoc_version()
1510121638104:rmarkdown::pandoc_available()
1510121893331:ls
1510122222079:.libPaths()
1510122243994:source('~/Documents/Harrisburg/500-52/Project/bay_area_bike_share/config/library.R')
1510124086105:.libPaths()
1510124150972:Sys.getenv("RSTUDIO_PANDOC")
1510124287877:Sys.getenv(RSTUDIO_PANDOC="/Applications/RStudio.app/Contents/MacOS/pandoc")
1510124331958:Sys.getenv("RSTUDIO_PANDOC"="/Applications/RStudio.app/Contents/MacOS/pandoc")
1510124334814:Sys.getenv(RSTUDIO_PANDOC="/Applications/RStudio.app/Contents/MacOS/pandoc")
1510124344864:Sys.getenv()
1510124398787:Sys.getenv(RSTUDIO_PANDOC="/usr/local/bin/pandoc")
1510124433071:Sys.getenv("RSTUDIO_PANDOC=/usr/local/bin/pandoc")
1510124440863:Sys.getenv()
1510124470276:?Sys.getenv
1510124482620:Sys.getenv(c("R_HOME", "R_PAPERSIZE", "R_PRINTCMD", "HOST"))
1510124502020:Sys.getenv("HOST")
1510124510156:Sys.getenv("R_HOME")
1510124517530:Sys.getenv("R_HOME" = s)
1510124538064:Sys.getenv("$RSTUDIO_PANDOC=/usr/local/bin/pandoc")
1510124545435:Sys.getenv()
1510125558184:#!/usr/local/bin/Rscript
1510125558185:setwd("/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share")
1510125569354:source("src/Regression.R")
1510125589143:# pandoc_version()
1510125589144:# rmarkdown::pandoc_available()
1510125589144:# knit("./report/report.Rmd", output = "./report/report.md")
1510125589145:rmarkdown::render("/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.Rmd", output_file = "/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.html")
1510125778227:Sys.getenv()
1510125785745:#!/usr/local/bin/Rscript
1510125785747:setwd("/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share")
1510125786110:source("src/Regression.R")
1510125807796:# Sys.getenv("RSTUDIO_PANDOC=/usr/local/bin/pandoc")
1510125807798:pandoc_version()
1510125809338:rmarkdown::pandoc_available()
1510125811430:# knit("./report/report.Rmd", output = "./report/report.md")
1510125811430:rmarkdown::render("/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.Rmd", output_file = "/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.html")
1510125902715:Sys.getenv()
1510126017952:#!/usr/local/bin/Rscript
1510126017953:setwd("/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share")
1510126018232:source("src/Regression.R")
1510126036541:library(rmarkdown)
1510126036543:# Sys.getenv("RSTUDIO_PANDOC=/usr/local/bin/pandoc")
1510126036543:pandoc_version()
1510126037430:rmarkdown::pandoc_available()
1510126037448:# knit("./report/report.Rmd", output = "./report/report.md")
1510126037449:rmarkdown::render("/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.Rmd", output_file = "/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.html")
1510126115844:Sys.getenv()
1510126157689:clear
1510126162487:#!/usr/local/bin/Rscript
1510126162488:setwd("/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share")
1510126162899:source("src/Regression.R")
1510126182410:# knit("./report/report.Rmd", output = "./report/report.md")
1510126182411:rmarkdown::render("/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.Rmd", output_file = "/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.html")
1510126225649:#!/usr/local/bin/Rscript
1510126225651:setwd("/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share")
1510126226181:source("src/Regression.R")
1510126243285:Sys.getenv("RSTUDIO_PANDOC")
1510126243286:pandoc_version()
1510126244110:rmarkdown::pandoc_available()
1510126247618:# knit("./report/report.Rmd", output = "./report/report.md")
1510126247619:rmarkdown::render("/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.Rmd", output_file = "/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.html")
1510126313233:install.packages("rmarkdown")
1510126351743:devtools::install_github("rstudio/markdown")
1510126361562:# knit("./report/report.Rmd", output = "./report/report.md")
1510126361564:rmarkdown::render("/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.Rmd", output_file = "/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.html")
1510126376571:library(rmarkdown)
1510126380178:# knit("./report/report.Rmd", output = "./report/report.md")
1510126380178:rmarkdown::render("/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.Rmd", output_file = "/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.html")
1510126450819:devtools::install_github("rstudio/rmarkdown")
1510126467213:library(rmarkdown)
1510126469151:# knit("./report/report.Rmd", output = "./report/report.md")
1510126469152:rmarkdown::render("/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.Rmd", output_file = "/Users/liangquanzhou/Documents/Harrisburg/500-52/Project/bay_area_bike_share/report/report.html")
1510126515536:Sys.getenv("RSTUDIO_PANDOC")
1510126635424:Sys.setenv(RSTUDIO_PANDOC="/Applications/RStudio.app/Contents/MacOS/pandoc")
1510456052643:getwd()
1510463055137:getwd(getwd())
1510463058167:getwd
1510463058168:getwd()
1510463812485:pnorm(.05)
1510463819267:qnorm(.03)
1510463827466:qnorm(.025)
1510463832445:qnorm(1- .025)
1510463963191:577/900
1510464011009:knitr::opts_chunk$set(echo = TRUE)
1510464011012:library(tidyverse)
1510464011207:p + sqrt((p * (1 - p)) / n)
1510464018683:alpha <- 0.05
1510464019070:n <- 900
1510464019454:p <- 577 / 900
1510464019742:z <- pnorm(1 - alpha/2)
1510464021248:p + sqrt((p * (1 - p)) / n)
1510464035715:w <- sqrt((p * (1 - p)) / n)
1510464048838:w <- z * sqrt((p * (1 - p)) / n)
1510464050025:w
1510466835957:?t.test
1510529135655:(86.35 - 90)/(23.90/sqrt(500))
1510529228081:xbar <- 86.35
1510529228237:s <- 23.9
1510529228381:n <- 250
1510529228564:mu <- 90
1510529229096:t <- (xbar - mu)/(s/sqrt(n))
1510529268735:?rnorm
1510529276630:?rt
1510529284805:qt(t)
1510529314486:qt(t, 899)
1510529318261:pt(t, 899)
1510529404327:df <- t - 1
1510529489784:pt(t, df, lower.tail = F)
1510529492349:pt(t, df, lower.tail = T)
1510529500343:df
1510529513577:n <- 250
1510529513911:df <- n - 1
1510529516627:pt(t, df, lower.tail = T)
1510529521694:pt(t, df, lower.tail = F)
1510529796847:xbar1 <- 88.53
1510529797026:s1 <- 18.29
1510529797160:n1 <- 900
1510529797328:df1 <- n1 - 1
1510529797905:t1 <- (xbar1 - mu)/(s1/sqrt(n1))
1510529801039:51
1510529802577:t1
1510529940962:pt(t1, df1, lower.tail = F)
1510530101788:arrest <- read_csv("USArrests_Coasts.csv")
1510530105180:arrest
1510530134924:arrest %>% View
1510530265589:# select all coast state, then seperate it to east and west
1510530265594:eastCoast <- arrest %>%
1510530265596:filter(`East Coast` == "Yes")
1510530266037:westCoast <- arrest %>%
1510530266039:filter(`West Coast` == "Yes")
1510530289524:eastCoast
1510530291377:# select all coast state, then seperate it to east and west
1510530291379:eastCoast <- arrest %>%
1510530291381:filter(`East Coast` == "Yes")
1510530305149:westCoast <- arrest %>%
1510530305151:filter(`West Coast` == "Yes")
1510530307729:arrest <- read_csv("USArrests_Coasts.csv")
1510530312384:# select all coast state, then seperate it to east and west
1510530312386:eastCoast <- arrest %>%
1510530312388:filter(`East Coast` == "Yes")
1510530312970:westCoast <- arrest %>%
1510530312972:filter(`West Coast` == "Yes")
1510530329623:arrest <- read_csv("USArrests_Coasts.csv") %>%
1510530329625:rename(X1 = state)
1510530335531:arrest
1510530350797:arrest <- read_csv("USArrests_Coasts.csv") %>%
1510530350801:rename(state = X1)
1510530354228:arrest
1510530364224:# select all coast state, then seperate it to east and west
1510530364226:eastCoast <- arrest %>%
1510530364228:filter(`East Coast` == "Yes")
1510530376006:?filter
1510530386718:library(tidyverse)
1510530388712:# select all coast state, then seperate it to east and west
1510530388714:eastCoast <- arrest %>%
1510530388716:filter(`East Coast` == "Yes")
1510530395773:# select all coast state, then seperate it to east and west
1510530395774:eastCoast <- arrest %>%
1510530395778:dplyr::filter(`East Coast` == "Yes")
1510530404172:library(dplyr)
1510530407392:# select all coast state, then seperate it to east and west
1510530407396:eastCoast <- arrest %>%
1510530407398:dplyr::filter(`East Coast` == "Yes")
1510530407593:westCoast <- arrest %>%
1510530407595:dplyr::filter(`West Coast` == "Yes")
1510530410725:eastCoast
1510530444274:# assault
1510530559750:# muder: H_0: east <= west, H_a: east > west
1510530559753:muderEast <- eastCoast %>%
1510530559756:pull(Murder)
1510530559910:muderWest <- westCoast %>%
1510530559912:pull(Murder)
1510530578757:t.test(muderEast, muderWest)
1510530586580:?t.test
1510530598924:t.test(muderEast, muderWest, alternative = "greater")
1510530786106:# assault: H_0: east <= west, H_a: east > west
1510530786110:assaultEast <- eastCoast %>%
1510530786111:pull(assaultEast)
1510530786339:assaultWest <- westCoast %>%
1510530786341:pull(assaultWest)
1510530790547:# assault: H_0: east <= west, H_a: east > west
1510530790549:assaultEast <- eastCoast %>%
1510530790551:pull(assaultEast)
1510530791023:assaultWest <- westCoast %>%
1510530791025:pull(assaultWest)
1510530808535:# assault: H_0: east <= west, H_a: east > west
1510530808537:assaultEast <- eastCoast %>%
1510530808541:pull(Assault)
1510530808747:assaultWest <- westCoast %>%
1510530808749:pull(Assaultt)
1510530809014:t.test(assaultEast, assaultWest, alternative = "greater")
1510530817184:assaultWest <- westCoast %>%
1510530817186:pull(Assault)
1510530817912:t.test(assaultEast, assaultWest, alternative = "greater")
1510530902811:# rape: H_0: east <= west, H_a: east > west
1510530902814:rapeEast <- eastCoast %>%
1510530902816:pull(Rape)
1510530903000:rapeWest <- westCoast %>%
1510530903006:pull(Rape)
1510530912011:t.test(rapeEast, rapeWest, alternative = "greater")
1510531590758:xbar <- 86.35
1510531590930:sigma <- 5
1510531591153:n <- 250
1510531591333:mu <- 90
1510531591617:z <- (xbar - mu)/(sigma/sqrt(n))
1510531593036:z
1510531626503:pnorm(z)
1510531630198:qnorm(z)
1510531635007:pnorm(z)
1510531637948:?pnorm
1510531649649:pnorm(z, lower.tail = F)
1510531740860:?z.tes
1510531742368:?z.test
1510531745382:??z.test
1510531784432:xbar1 <- 88.53
1510531784610:n1 <- 900
1510531784773:z1 <- (xbar1 - mu)/(sigma/sqrt(n1))
1510531800477:pnorm(z1, lower.tail = F)
1510531844133:xbar1 <- 88.53
1510531844415:n1 <- 900
1510531844791:z1 <- (xbar1 - mu)/(sigma/sqrt(n1))
1510531890365:xbar1
1510531893438:n1
1510531894803:z1
1510532004425:pnorm(z, lower.tail= F)
1510532375172:?help(co2)
1510532389489:?help(CO2)
1510532409835:co2
1510532442756:knitr::opts_chunk$set(echo = TRUE)
1510532442759:library(tidyverse)
1510532442771:co2 <- dataset(co2)
1510532452589:co2 <- data(co2)
1510532456399:co2
1510532462083:CO2
1510532471499:co2 <- data(CO2)
1510532472931:co2
1510532483434:load(CO2)
1510532492118:CO2
1510532495634:?CO2
1510532513402:datasets(CO2)
1510532518764:datasets::CO2
1510532525493:co2 <- datasets::co2
1510532526971:co2
1510532540547:CO2 <- datasets::CO2
1510532566132:CO2
1510532646786:CO2 %>% group_by(Type, Treatment)
1510532846429:CO2 %>%
1510532846437:group_by(Type, Treatment) %>%
1510532846439:summarise(mean_conc = mean(conc), std_conc = std(conc))
1510532854439:CO2 %>%
1510532854441:group_by(Type, Treatment) %>%
1510532854443:summarise(mean_conc = mean(conc), sd_conc = sd(conc))
1510533008513:# Type: H0: mean conc at Quebec = mean conc at Mississipi
1510533008516:quebec <- CO2 %>% filter(Type == "Quebec") %>% pull(conc)
1510533008703:mississipi <- CO2 %>% filter(Type == "Mississipi") %>% pull(conc)
1510533030603:CO2 %>% names()
1510533041337:?filter
1510533056777:# Type: H0: mean conc at Quebec = mean conc at Mississipi
1510533056778:quebec <- CO2 %>% dplyr::filter(Type == "Quebec") %>% pull(conc)
1510533057174:mississipi <- CO2 %>% dplyr::filter(Type == "Mississipi") %>% pull(conc)
1510533073970:t.test(quebec, mississipi)
1510533080495:quebec
1510533083254:mississipi
1510533103541:mississippi <- CO2 %>% dplyr::filter(Type == "Mississippi") %>% pull(conc)
1510533103727:t.test(quebec, mississippi)
1510533201895:# Treatment: H0: mean conc of chilled = mean conc of nonchilled
1510533201900:chilled <- CO2 %>% dplyr::filter(Treatment == "chilled") %>% pull(conc)
1510533202074:nonchilled <- CO2 %>% dplyr::filter(Treatment == "nonchilled") %>% pull(conc)
1510533208718:t.test(chilled, nonchilled)
1510533317524:CO2 %>%
1510533317528:as_tibble() %>%
1510533317530:group_by(Type, Treatment) %>%
1510533317532:summarise(mean_conc = mean(conc), sd_conc = sd(conc))
1510533321896:CO2 %>%
1510533321898:as_tibble() %>%
1510533321900:group_by(Type, Treatment) %>%
1510533321902:summarise(mean_conc = mean(conc), sd_conc = sd(conc))
1510533334867:CO2
1510533353863:mean(CO2$conc)
1510533420955:CO2 %>%
1510533421011:as_tibble() %>%
1510533421014:group_by(Type, Treatment) %>%
1510533421015:summarise(mean_uptake = mean(uptake), sd_uptake = sd(uptake))
1510533430453:mississippi <- CO2 %>% dplyr::filter(Type == "Mississippi") %>% pull(uptake)
1510533431694:t.test(quebec, mississippi)
1510533458457:# Treatment: H0: mean conc of chilled = mean conc of nonchilled
1510533458459:chilled <- CO2 %>% dplyr::filter(Treatment == "chilled") %>% pull(uptake)
1510533459436:nonchilled <- CO2 %>% dplyr::filter(Treatment == "nonchilled") %>% pull(uptake)
1510533461111:t.test(chilled, nonchilled)
1510533751312:aov(uptake ~ Type + Treatment, data = CO2)
1510533781941:res_aov <- aov(uptake ~ Type + Treatment, data = CO2)
1510533786418:summary(res_aov)
1510533968260:table(mtcars$vs , mtcars$am)
1510534122335:t1 <- table(mtcars$vs , mtcars$am)
1510534125547:t2 <- table(mtcars$gear , mtcars$crab)
1510534133162:t3 <- table(mtcars$cyl , mtcars$gear)
1510534137131:t2 <- table(mtcars$gear , mtcars$crab)
1510534148864:t2 <- table(mtcars$gear , mtcars$carb)
1510534165774:chisq.test(t1)
1510534171064:chisq.test(t2)
1510534177498:chisq.test(t3)
1510534183948:t1
1510534185032:t2
1510534186192:t3
1510541729482:knitr::opts_chunk$set(echo = TRUE)
1510541729503:#Place your code here and delete this!
1510541729506:anscombe
1510541741380:#Place your code here and delete this!
1510541741383:datasets(anscombe)
1510541745267:#Place your code here and delete this!
1510541745270:data(anscombe)
1510541764689:#Place your code here and delete this!
1510541764692:data <- datasets::anscombe
1510541800570:library(tidyverse)
1510541837397:data
1510541870979:?fBasic
1510541881180:??fBasic
1510541921304:data %>% apply(2, mean)
1510541965050:plot(data)
1510542178810:install.packages("fBasics")
1510542228071:library(fBasics)
1510542235957:?fBasics
1510542300158:colMeans(data)
1510542306701:fBasic::colMeans(data)
1510542312889:fBasics::colMeans(data)
1510542355858:```{r}
1510542356733:colMeans(data)
1510542438299:correlationTest(data$x1, data$y1)
1510542448413:corr(data$x1, data$y1)
1510542454317:??corrlecation
1510542492269:cor(data$x1, data$y1)
1510542505499:cor(data$x2, data$y2)
1510542515699:cor(data$x3, data$y3)
1510542528874:cor(data$x4, data$y4)
1510542594693:plot(data$x1, data$y1)
1510542595284:plot(data$x2, data$y2)
1510542595789:plot(data$x3, data$y3)
1510542596251:plot(data$x4, data$y4)
1510542616926:par(c(2,2))
1510542624409:?par
1510542637861:plot(data$x1, data$y1)
1510542639152:plot(data$x2, data$y2)
1510542639694:plot(data$x3, data$y3)
1510542640121:plot(data$x4, data$y4)
1510542643423:par(c(2,2))
1510542643430:plot(data$x1, data$y1)
1510542643462:plot(data$x2, data$y2)
1510542643502:plot(data$x3, data$y3)
1510542643533:plot(data$x4, data$y4)
1510542662073:par(mfrow = c(2,2))
1510542662708:plot(data$x1, data$y1)
1510542663378:plot(data$x2, data$y2)
1510542663678:plot(data$x3, data$y3)
1510542663891:plot(data$x4, data$y4)
1510542666549:par(mfrow = c(2,2))
1510542666554:plot(data$x1, data$y1)
1510542666583:plot(data$x2, data$y2)
1510542666615:plot(data$x3, data$y3)
1510542666658:plot(data$x4, data$y4)
1510542668707:par(mfrow = c(2,2))
1510542668718:plot(data$x1, data$y1)
1510542668754:plot(data$x2, data$y2)
1510542668785:plot(data$x3, data$y3)
1510542668805:plot(data$x4, data$y4)
1510542679833:plot(data$x1, data$y1)
1510542699378:par(mfrow = c(2,2))
1510542699380:plot(data$x1, data$y1)
1510542699427:plot(data$x2, data$y2)
1510542699456:plot(data$x3, data$y3)
1510542699491:plot(data$x4, data$y4)
1510542705157:?plot
1510542755069:par(mfrow = c(2,2))
1510542755074:plot(data$x1, data$y1)
1510542755144:plot(data$x2, data$y2)
1510542755174:plot(data$x3, data$y3)
1510542755194:plot(data$x4, data$y4, type = "p")
1510542780036:par(mfrow = c(2,2))
1510542780042:plot(data$x1, data$y1)
1510542780107:plot(data$x2, data$y2)
1510542780148:plot(data$x3, data$y3)
1510542780168:plot(data$x4, data$y4, pch = 1)
1510542786106:plot(1:10)
1510542795787:plot(1:10, pch = 11)
1510542799675:plot(1:10, pch = 15)
1510542809134:plot(1:10, pch = 21)
1510542851088:plot(1:10, pch = 16)
1510542868763:par(mfrow = c(2,2), pch = 16)
1510542872789:plot(data$x1, data$y1)
1510542872817:plot(data$x2, data$y2)
1510542872845:plot(data$x3, data$y3)
1510542872881:plot(data$x4, data$y4)
1510542954530:abline(lm(data$y1 ~ data$x1))
1510542956096:plot(data$x1, data$y1)
1510542956351:abline(lm(data$y1 ~ data$x1))
1510542962571:plot(data$x1, data$y1)
1510542962609:abline(lm(data$y1 ~ data$x1))
1510543047622:lm(data$y1 ~ data$x1)
1510543059208:lm(data$y2 ~ data$x2)
1510543060450:lm(data$y3 ~ data$x3)
1510543061109:lm(data$y4 ~ data$x4)
1510543089309:plot(data$x4, data$y4)
1510543090171:abline(lm(data$y4 ~ data$x4))
1510543196865:lm1 <- lm(data$y1 ~ data$x1)
1510543197094:lm2 <- lm(data$y2 ~ data$x2)
1510543197338:lm3 <- lm(data$y3 ~ data$x3)
1510543197625:lm4 <- lm(data$y4 ~ data$x4)
1510543199726:summary(lm1)
1510543200180:summary(lm2)
1510543201172:summary(lm3)
1510543202782:summary(lm4)
1510543219532:plot(data$x1, data$y1)
1510543222441:plot(data$x2, data$y2)
1510543223890:plot(data$x3, data$y3)
1510543225091:plot(data$x4, data$y4)
1510552861804:View(mtcars)
1510553453401:plot(1:10)
1510619234648:1. mtcars %>% ggplot(aes(x = cyl, y = wt)) %>% geom_point()
1510619243485:mtcars %>% ggplot(aes(x = cyl, y = wt)) %>% geom_point()
1510619259471:mtcars %>% ggplot(., aes(x = cyl, y = wt)) %>% geom_point()
1510619283836:ggplot(mtcars, aes(cyl, wt)) + geom_point()
1510723430863:?knit
1510723824262:knit("report/report.Rmd")
1512802466599:getwd()
1512802486307:setwd("~/Documents/Harrisburg/512-50")
1512802489145:ls()
1512802493043:getwd()
1512802506012:file.edit("ProblemSet_3.Rmd")
1512802656370:mpg
1512802685765:?mpg
1512802711800:knitr::opts_chunk$set(echo = TRUE)
1512802711804:library(tidyverse)
1512802712073:mpg <- ggplot2::mpg
1512802713384:mpg
1512802803592:?geom_bar
1512802832124:mpg %>%
1512802832126:ggplot(aes(x = class, color = trans)) +
1512802832128:geom_bar(position = "stack")
1512802839862:mpg %>%
1512802839865:ggplot(aes(x = class, fill = trans)) +
1512802839867:geom_bar(position = "stack")
1512802930175:mpg %>%
1512802930177:ggplot(aes(x = class, fill = trans)) +
1512802930178:geom_bar(position = "stack") +
1512802930185:+ labs(color = "Transmission")
1512802939567:mpg %>%
1512802939570:ggplot(aes(x = class, fill = trans)) +
1512802939573:geom_bar(position = "stack") +
1512802939575:labs(color = "Transmission")
1512802950660:mpg %>%
1512802950662:ggplot(aes(x = class, fill = trans)) +
1512802950666:geom_bar(position = "stack") +
1512802950671:labs(fill = "Transmission")
1512803022886:mpg
1512803158466:mpg %>%
1512803158536:ggplot(aes(x = manufacturer)) +
1512803158538:geom_boxplot() +
1512803158539:coord_flip()
1512803182839:mpg %>%
1512803182842:ggplot(aes(x = manufacturer, y = hwy)) +
1512803182847:geom_boxplot() +
1512803182853:coord_flip()
1512803218998:mpg %>%
1512803219005:ggplot(aes(x = manufacturer, y = hwy)) +
1512803219008:geom_boxplot() +
1512803219011:coord_flip() +
1512803219013:labs(x = "Highway Fuel Efficiency (miles/gallon)")
1512803252096:mpg %>%
1512803252102:ggplot(aes(x = manufacturer, y = hwy)) +
1512803252106:geom_boxplot() +
1512803252109:coord_flip() +
1512803252111:labs(y = "Highway Fuel Efficiency (miles/gallon)",
1512803252113:x = "Vehicle Manufacturer") +
1512803252115:theme_classic()
1512803366310:diamonds <- ggplot2::diamonds
1512803389375:diamonds
1512803399204:diamonds %>%
1512803399208:ggplot(aes(x = price)) +
1512803399212:geom_density()
1512803415285:diamonds %>%
1512803415287:ggplot(aes(x = price, fill = cut)) +
1512803415290:geom_density()
1512803441501:library(ggtheme)
1512803447900:install.packages(ggthem)
1512803460226:install.packages("ggthemes")
1512803470182:library(ggtheme)
1512803475063:library(ggthemes)
1512803493301:geom_density()
1512803496771:?geom_density
1512803519471:diamonds %>%
1512803519473:ggplot(aes(x = price, fill = cut)) +
1512803519475:geom_density(alpha = 0.5)
1512803524604:diamonds %>%
1512803524609:ggplot(aes(x = price, fill = cut)) +
1512803524612:geom_density(alpha = 0.2)
1512803548440:diamonds %>%
1512803548444:ggplot(aes(x = price, fill = cut)) +
1512803548448:geom_density(alpha = 0.2) +
1512803548450:theme_economist()
1512803564268:diamonds %>%
1512803564272:ggplot(aes(x = price, fill = cut, color = cut)) +
1512803564276:geom_density(alpha = 0.1) +
1512803564279:theme_economist()
1512803624200:diamonds %>%
1512803624207:ggplot(aes(x = price, fill = cut, color = cut)) +
1512803624209:geom_density(alpha = 0.1) +
1512803624211:labs(x = "Diamond Price (USD)",
1512803624213:y = "Density",
1512803624215:title = "Diamond Price Density") +
1512803624217:theme_economist()
1512803708179:iris
1512803715321:iris %>% as.tibble()
1512803767929:iris %>%
1512803767941:ggplot(aes(x = Sepal.Length, y = Petal.Length)) +
1512803767943:geom_point() +
1512803767945:geom_smooth(method = "lm")
1512803805323:iris %>%
1512803805326:ggplot(aes(x = Sepal.Length, y = Petal.Length)) +
1512803805331:geom_point() +
1512803805335:geom_smooth(method = "lm") +
1512803805339:labs(x = "Iris Sepal Length",
1512803805341:y = "Iris Petal Length") +
1512803805342:theme_minimal()
1512803823308:iris %>%
1512803823311:ggplot(aes(x = Sepal.Length, y = Petal.Length)) +
1512803823312:geom_point() +
1512803823314:geom_smooth(method = "lm") +
1512803823316:labs(x = "Iris Sepal Length",
1512803823319:y = "Iris Petal Length",
1512803823323:title = "Relationship between Petal and Sepal Length") +
1512803823325:theme_minimal()
1512803959898:iris
1512803964370:iris %>% as.tibble()
1512803980911:iris %>%
1512803980913:ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
1512803980915:geom_point() +
1512803980918:geom_smooth(method = "lm") +
1512803980920:labs(x = "Iris Sepal Length",
1512803980922:y = "Iris Petal Length",
1512803980925:title = "Relationship between Petal and Sepal Length") +
1512803980927:theme_minimal()
1512803985999:iris %>%
1512803986001:ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
1512803986003:geom_point() +
1512803986004:geom_smooth(method = "lm") +
1512803986006:labs(x = "Iris Sepal Length",
1512803986008:y = "Iris Petal Length",
1512803986013:title = "Relationship between Petal and Sepal Length") +
1512803986015:theme_minimal()
1512804026543:iris %>%
1512804026556:ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
1512804026558:geom_point() +
1512804026561:geom_smooth(method = "lm") +
1512804026563:labs(x = "Iris Sepal Length",
1512804026565:y = "Iris Petal Length",
1512804026568:title = "Relationship between Petal and Sepal Length",
1512804026570:subtitle = "Species level comparison") +
1512804026571:theme_bw()
1512804050572:iris %>%
1512804050576:ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
1512804050579:geom_point() +
1512804050582:geom_smooth(method = "lm", se = F) +
1512804050585:labs(x = "Iris Sepal Length",
1512804050588:y = "Iris Petal Length",
1512804050590:title = "Relationship between Petal and Sepal Length",
1512804050592:subtitle = "Species level comparison") +
1512804050594:theme_bw()
1512804119398:iris %>%
1512804119402:ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
1512804119403:geom_point() +
1512804119405:geom_smooth(method = "lm", se = F) +
1512804119407:labs(x = "Iris Sepal Length",
1512804119409:y = "Iris Petal Length",
1512804119412:title = "Relationship between Petal and Sepal Length",
1512804119414:subtitle = "Species level comparison") +
1512804119416:theme(lengend.position = "bottom")
1512804131022:iris %>%
1512804131024:ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
1512804131026:geom_point() +
1512804131028:geom_smooth(method = "lm", se = F) +
1512804131032:labs(x = "Iris Sepal Length",
1512804131036:y = "Iris Petal Length",
1512804131038:title = "Relationship between Petal and Sepal Length",
1512804131040:subtitle = "Species level comparison") +
1512804131042:theme(legend.position = "bottom") +
1512804131048:theme_bw()
1512804142804:iris %>%
1512804142806:ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
1512804142807:geom_point() +
1512804142809:geom_smooth(method = "lm", se = F) +
1512804142811:labs(x = "Iris Sepal Length",
1512804142813:y = "Iris Petal Length",
1512804142816:title = "Relationship between Petal and Sepal Length",
1512804142818:subtitle = "Species level comparison") +
1512804142819:theme(legend.position = "bottom")
1512804236498:iris %>%
1512804236504:ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
1512804236506:geom_point() +
1512804236510:geom_smooth(method = "lm", se = F) +
1512804236513:labs(x = "Iris Sepal Length",
1512804236515:y = "Iris Petal Length",
1512804236517:title = "Relationship between Petal and Sepal Length",
1512804236518:subtitle = "Species level comparison") +
1512804236520:theme_base(legend.position = "bottom") +
1512804240429:iris %>%
1512804240431:ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
1512804240435:geom_point() +
1512804240437:geom_smooth(method = "lm", se = F) +
1512804240443:labs(x = "Iris Sepal Length",
1512804240445:y = "Iris Petal Length",
1512804240447:title = "Relationship between Petal and Sepal Length",
1512804240449:subtitle = "Species level comparison") +
1512804240451:theme_base(legend.position = "bottom")
1512804256744:iris %>%
1512804256746:ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
1512804256748:geom_point() +
1512804256751:geom_smooth(method = "lm", se = F) +
1512804256754:labs(x = "Iris Sepal Length",
1512804256758:y = "Iris Petal Length",
1512804256760:title = "Relationship between Petal and Sepal Length",
1512804256761:subtitle = "Species level comparison") +
1512804256763:theme_base() +
1512804256764:theme(legend.position = "bottom")
1512804294996:iris %>%
1512804294998:ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
1512804295001:geom_point() +
1512804295004:geom_smooth(method = "lm", se = F) +
1512804295007:labs(x = "Iris Sepal Length",
1512804295010:y = "Iris Petal Length",
1512804295011:title = "Relationship between Petal and Sepal Length",
1512804295013:subtitle = "Species level comparison") +
1512804295015:theme_classic() +
1512804295020:theme(legend.position = "bottom")
1512804325503:iris %>%
1512804325506:ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
1512804325508:geom_point() +
1512804325509:geom_smooth(method = "lm", se = F) +
1512804325512:labs(x = "Iris Sepal Length",
1512804325513:y = "Iris Petal Length",
1512804325515:title = "Relationship between Petal and Sepal Length",
1512804325517:subtitle = "Species level comparison") +
1512804325519:theme_bw() +
1512804325523:theme(legend.position = "bottom")
1512804463782:iris %>%
1512804463801:ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
1512804463803:geom_point() +
1512804463805:geom_smooth(method = "lm", se = F) +
1512804463807:labs(x = "Iris Sepal Length",
1512804463809:y = "Iris Petal Length",
1512804463811:title = "Relationship between Petal and Sepal Length",
1512804463813:subtitle = "Species level comparison") +
1512804463815:theme_classic() +
1512804463817:theme(legend.position = "bottom")
1512804499668:iris %>%
1512804499671:ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
1512804499673:geom_point() +
1512804499675:geom_smooth(method = "lm", se = F) +
1512804499678:labs(x = "Iris Sepal Length",
1512804499682:y = "Iris Petal Length",
1512804499684:title = "Relationship between Petal and Sepal Length",
1512804499686:subtitle = "Species level comparison") +
1512804499687:theme_tufte() +
1512804499690:theme(legend.position = "bottom")
1512804875538:file.edit("ProblemSet_4.Rmd")
1512805081103:knitr::opts_chunk$set(echo = TRUE)
1512805081135:library(tidyverse)
1512805081150:library(readxl)
1512805099562:data <- read_excel("http://www1.nyc.gov/assets/ccrb/downloads/excel/ccrb_datatransparencyinitiative.xlsx")
1512805139143:?source
1512805150442:source("http://www1.nyc.gov/assets/ccrb/downloads/excel/ccrb_datatransparencyinitiative.xlsx")
1512805164275:source("www1.nyc.gov/assets/ccrb/downloads/excel/ccrb_datatransparencyinitiative.xlsx")
1512805294405:temp = tempfile(fileext = ".xlsx")
1512805295353:dataURL <- "http://www1.nyc.gov/assets/ccrb/downloads/excel/ccrb_datatransparencyinitiative.xlsx"
1512805295934:download.file(dataURL, destfile=temp, mode='wb')
1512805313113:data <- read_excel(temp)
1512805314983:data
1512805332915:data <- read_excel(temp, sheet = 2)
1512805361782:data
1512886003156:data <- read_excel(temp, sheet = 2)
1512886021263:View(data)
1512886130540:dict <- read_excel(temp, sheet = 1)
1512886136110:dict %>% View
1512886143663:dict
1512886150307:dict[[1]]
1512886164500:readLines(dict)
1512886168852:readlines(dict)
1512886173517:readline(dict)
1512888587272:data %>%
1512888587278:ggplot(aes(x = `Received Year`, fill = `Allegation FADO Type`)) +
1512888587279:geom_bar(position = "stack") +
1512888587282:labs(title = "Complaints received by year")
