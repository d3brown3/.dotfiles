---
title: "ANLY 512 - Problem Set 3"
subtitle: "Exploring the Grammar of Graphics"
author: "Liangquan Zhou"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```


## Objectives

The objectives of this problem set is to gain experience working with the `ggplot2` package for data visualization. To do this I have provided a series of graphics, all created using the `ggplot2` package. Your objective for this assignment will be write the code necessary to exactly recreate the provided graphics.

When completed submit a link to your file on rpubs.com. Be sure to include `echo = TRUE` for each graphic so that I can see the visualization and the code required to create it.


## Vis 1

This graphic is a traditional stacked bar chart. This graphic works on the `mpg` dataset, which is built into the `ggplot2` library. This means that you can access it simply by `ggplot(mpg, ....)`. There is one modification above default in this graphic, I renamed the legend for more clarity.

```{r}
mpg <- ggplot2::mpg
mpg %>% 
  ggplot(aes(x = class, fill = trans)) +
  geom_bar(position = "stack") +
  labs(fill = "Transmission")
```

## Vis 2 
This boxplot is also built using the mpg dataset. Notice the changes in axis labels, and an altered `theme_XXXX`

```{r}
mpg %>% 
  ggplot(aes(x = manufacturer, y = hwy)) +
  geom_boxplot() +
  coord_flip() +
  labs(y = "Highway Fuel Efficiency (miles/gallon)", 
       x = "Vehicle Manufacturer") +
  theme_classic()
```

## Vis 3 
This graphic is built with another dataset `diamonds` a dataset also built into the `ggplot2` package. For this one I used an additional package called `library(ggthemes)` check it out to reproduce this view.

```{r}
library(ggthemes)
diamonds <- ggplot2::diamonds
diamonds %>% 
  ggplot(aes(x = price, fill = cut, color = cut)) + 
  geom_density(alpha = 0.1) +
  labs(x = "Diamond Price (USD)",
       y = "Density",
       title = "Diamond Price Density") +
  theme_economist()
```

## Vis 4

For this plot we are changing vis idioms to a scatter plot framework. Additionally, I am using `ggplot2` package to fit a linear model to the data all within the plot framework. Three are edited labels and theme modifications as well.

```{r}
iris <- datasets::iris
iris %>% 
  ggplot(aes(x = Sepal.Length, y = Petal.Length)) +
  geom_point() +
  geom_smooth(method = "lm") + 
  labs(x = "Iris Sepal Length", 
       y = "Iris Petal Length",
       title = "Relationship between Petal and Sepal Length") +
  theme_minimal()
```

## Vis 5

Finally, in this vis I extend on the last example, by plotting the same data but using an additional channel to communicate species level differences. Again I fit a linear model to the data but this time one for each species, and add additional theme and labeling modicitations.

```{r}
iris %>% 
  ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) + 
  labs(x = "Iris Sepal Length", 
       y = "Iris Petal Length",
       title = "Relationship between Petal and Sepal Length",
       subtitle = "Species level comparison") +
  theme_tufte() +
  theme(legend.position = "bottom")
```
